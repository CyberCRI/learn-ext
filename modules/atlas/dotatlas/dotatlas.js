/**
 * Carrot Search dotAtlas (pre-release, commercial)
 * v0.2.1, master/3057f45, build DOTATLAS-SOFTWARE-60, 2019-07-30
 *
 * Carrot Search confidential.
 * Copyright 2002-2019, Carrot Search s.c, All Rights Reserved.
 */
(function(){
'use strict';function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var ba="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},B="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function D(){D=function(){};B.Symbol||(B.Symbol=ca)}function da(a,b){this.a=a;ba(this,"description",{configurable:!0,writable:!0,value:b})}
da.prototype.toString=function(){return this.a};var ca=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new da("jscomp_symbol_"+(c||"")+"_"+b++,c)}var b=0;return a}();function ea(){D();var a=B.Symbol.iterator;a||(a=B.Symbol.iterator=B.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&ba(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return fa(aa(this))}});ea=function(){}}
function fa(a){ea();a={next:a};a[B.Symbol.iterator]=function(){return this};return a}function K(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:aa(a)}}function ha(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function L(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var ia="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)L(d,e)&&(a[e]=d[e])}return a};
function N(a,b){if(b){var c=B;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ba(c,a,{configurable:!0,writable:!0,value:b})}}N("Object.assign",function(a){return a||ia});
N("WeakMap",function(a){function b(a){this.a=(h+=Math.random()+1).toString();if(a){a=K(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}}function c(){}function d(a){L(a,f)||ba(a,f,{value:new c})}function e(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof c)return a;d(a);return b(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==
d.get(c)}catch(p){return!1}}())return a;var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var h=0;b.prototype.set=function(a,b){d(a);if(!L(a,f))throw Error("WeakMap key fail: "+a);a[f][this.a]=b;return this};b.prototype.get=function(a){return L(a,f)?a[f][this.a]:void 0};b.prototype.has=function(a){return L(a,f)&&L(a[f],this.a)};b.prototype.delete=function(a){return L(a,f)&&L(a[f],this.a)?delete a[f][this.a]:!1};return b});
N("Map",function(a){function b(){var a={};return a.aa=a.next=a.head=a}function c(a,b){var c=a.a;return fa(function(){if(c){for(;c.head!=a.a;)c=c.aa;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})}function d(a,b){var c=b&&typeof b;"object"==c||"function"==c?f.has(b)?c=f.get(b):(c=""+ ++h,f.set(b,c)):c="p_"+b;var d=a.b[c];if(d&&L(a.b,c))for(a=0;a<d.length;a++){var k=d[a];if(b!==b&&k.key!==k.key||b===k.key)return{id:c,list:d,index:a,I:k}}return{id:c,list:d,
index:-1,I:void 0}}function e(a){this.b={};this.a=b();this.size=0;if(a){a=K(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}}if(function(){if(!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a(K([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||
"t"!=e.value[1]||!d.next().done?!1:!0}catch(m){return!1}}())return a;ea();var f=new WeakMap;e.prototype.set=function(a,c){a=0===a?0:a;var b=d(this,a);b.list||(b.list=this.b[b.id]=[]);b.I?b.I.value=c:(b.I={next:this.a,aa:this.a.aa,head:this.a,key:a,value:c},b.list.push(b.I),this.a.aa.next=b.I,this.a.aa=b.I,this.size++);return this};e.prototype.delete=function(a){a=d(this,a);return a.I&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.b[a.id],a.I.aa.next=a.I.next,a.I.next.aa=a.I.aa,a.I.head=
null,this.size--,!0):!1};e.prototype.clear=function(){this.b={};this.a=this.a.aa=b();this.size=0};e.prototype.has=function(a){return!!d(this,a).I};e.prototype.get=function(a){return(a=d(this,a).I)&&a.value};e.prototype.entries=function(){return c(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return c(this,function(a){return a.key})};e.prototype.values=function(){return c(this,function(a){return a.value})};e.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=
d.value,a.call(b,d[1],d[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var h=0;return e});N("Array.from",function(a){return a?a:function(a,c,d){c=null!=c?c:function(a){return a};var b=[],f="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if("function"==typeof f){a=f.call(a);for(var h=0;!(f=a.next()).done;)b.push(c.call(d,f.value,h++))}else for(f=a.length,h=0;h<f;h++)b.push(c.call(d,a[h],h));return b}});
N("Set",function(a){function b(a){this.a=new Map;if(a){a=K(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.a.size}if(function(){if(!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),d=new a(K([b]));if(!d.has(b)||1!=d.size||d.add(b)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var e=d.entries(),f=e.next();if(f.done||f.value[0]!=b||f.value[1]!=b)return!1;f=e.next();return f.done||f.value[0]==b||4!=f.value[0].x||
f.value[1]!=f.value[0]?!1:e.next().done}catch(h){return!1}}())return a;ea();b.prototype.add=function(a){a=0===a?0:a;this.a.set(a,a);this.size=this.a.size;return this};b.prototype.delete=function(a){a=this.a.delete(a);this.size=this.a.size;return a};b.prototype.clear=function(){this.a.clear();this.size=0};b.prototype.has=function(a){return this.a.has(a)};b.prototype.entries=function(){return this.a.entries()};b.prototype.values=function(){return this.a.values()};b.prototype.keys=b.prototype.values;
b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.a.forEach(function(d){return a.call(b,d,d,c)})};return b});
N("Promise",function(a){function b(a){this.b=0;this.s=void 0;this.a=[];var b=this.f();try{a(b.resolve,b.reject)}catch(l){b.reject(l)}}function c(){this.a=null}function d(a){return a instanceof b?a:new b(function(b){b(a)})}if(a)return a;c.prototype.b=function(a){if(null==this.a){this.a=[];var b=this;this.f(function(){b.s()})}this.a.push(a)};var e=B.setTimeout;c.prototype.f=function(a){e(a,0)};c.prototype.s=function(){for(;this.a&&this.a.length;){var a=this.a;this.a=[];for(var b=0;b<a.length;++b){var c=
a[b];a[b]=null;try{c()}catch(g){this.i(g)}}}this.a=null};c.prototype.i=function(a){this.f(function(){throw a;})};b.prototype.f=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;return{resolve:a(this.Qc),reject:a(this.i)}};b.prototype.Qc=function(a){if(a===this)this.i(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof b)this.bd(a);else{a:switch(typeof a){case "object":var c=null!=a;break a;case "function":c=!0;break a;default:c=!1}c?this.Ma(a):
this.O(a)}};b.prototype.Ma=function(a){var b=void 0;try{b=a.then}catch(l){this.i(l);return}"function"==typeof b?this.fd(b,a):this.O(a)};b.prototype.i=function(a){this.W(2,a)};b.prototype.O=function(a){this.W(1,a)};b.prototype.W=function(a,b){if(0!=this.b)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.b);this.b=a;this.s=b;this.ga()};b.prototype.ga=function(){if(null!=this.a){for(var a=0;a<this.a.length;++a)f.b(this.a[a]);this.a=null}};var f=new c;b.prototype.bd=function(a){var b=
this.f();a.Ca(b.resolve,b.reject)};b.prototype.fd=function(a,b){var c=this.f();try{a.call(b,c.resolve,c.reject)}catch(g){c.reject(g)}};b.prototype.then=function(a,c){function d(a,b){return"function"==typeof a?function(b){try{g(a(b))}catch(t){e(t)}}:b}var g,e,f=new b(function(a,b){g=a;e=b});this.Ca(d(a,g),d(c,e));return f};b.prototype.catch=function(a){return this.then(void 0,a)};b.prototype.Ca=function(a,b){function c(){switch(d.b){case 1:a(d.s);break;case 2:b(d.s);break;default:throw Error("Unexpected state: "+
d.b);}}var d=this;null==this.a?f.b(c):this.a.push(c)};b.resolve=d;b.reject=function(a){return new b(function(b,c){c(a)})};b.race=function(a){return new b(function(b,c){for(var g=K(a),e=g.next();!e.done;e=g.next())d(e.value).Ca(b,c)})};b.all=function(a){var c=K(a),e=c.next();return e.done?d([]):new b(function(a,b){function g(b){return function(c){f[b]=c;k--;0==k&&a(f)}}var f=[],k=0;do f.push(void 0),k++,d(e.value).Ca(g(f.length-1),b),e=c.next();while(!e.done)})};return b});
N("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991});N("Array.prototype.find",function(a){return a?a:function(a,c){a:{var b=this;b instanceof String&&(b=String(b));for(var e=b.length,f=0;f<e;f++){var h=b[f];if(a.call(c,h,f,b)){a=h;break a}}a=void 0}return a}});D();var ja=Symbol();D();Symbol();function ka(a,b,c){var d={};la(d,a,b,c);Object.defineProperty(d,ja,{enumerable:!1,value:a});return d}function ma(a){return Object.assign({options:{},events:{},getters:{},methods:{}},a)}
function la(a,b,c,d){function e(a,c){g.options.hasOwnProperty(a)?g.options[a].set.call(b,c):g.events.hasOwnProperty(a)?k(a,c||[]):g.defaultSetter&&g.defaultSetter.call(b,a,c)}function f(a,b){m.has(a)&&(a=m.get(a),Array.isArray(b)?a.push.apply(a,b.filter(function(a){return!!a})):a.push(b),l())}function h(a,b){if(m.has(a)){if(Array.isArray(b)){var c=new Set(b);var d=function(a){return!c.has(a)}}else d=function(a){return a!==b};m.set(a,m.get(a).filter(d));l()}}function k(a,b){m.has(a)&&(Array.isArray(b)?
m.set(a,b.filter(function(a){return!!a})):m.set(a,[b]),l())}function l(){for(var c={},d=K(n),e=d.next();!e.done;c={oa:c.oa},e=d.next()){e=K(e.value);c.oa=e.next().value;e=e.next().value;var f=m.get(c.oa),k=g.events[c.oa];0===e&&0<f.length?k.call(b,function(b){return function(){var c=arguments;m.get(b.oa).forEach(function(b){b&&b.apply(a,c)})}}(c)):0<e&&0===f.length&&k.call(b,void 0);n.set(c.oa,f.length)}}var g=ma(d);Object.freeze(Object.keys(g.options).reduce(function(a,c){a[c]=g.options[c].get.call(b);
return a},{}));var p=Object.assign({},g.options,g.getters),m=Object.keys(g.events).reduce(function(a,b){a.set(b,[]);return a},new Map),n=Object.keys(g.events).reduce(function(a,b){a.set(b,0);return a},new Map);c&&Object.keys(c).forEach(function(a){e(a,c[a])});Object.keys(g.methods).forEach(function(c){a[c]=function(){return g.methods[c].apply(b,arguments)}});a.set=function(b,c){b&&b.constructor===Object?Object.keys(b).forEach(function(a){e(a,b[a])}):e(b,c);return a};a.get=function(a){if(p.hasOwnProperty(a))return p[a].get.apply(b,
Array.from(arguments).slice(1));if(g.defaultGetter)return g.defaultGetter.apply(b,arguments)};a.on=function(c,d){if(d){var e="on"+c.charAt(0).toUpperCase()+c.substring(1);m.has(e)?f(e,d):g.defaultOn&&g.defaultOn.call(b,c,d)}return a};a.off=function(c,d){if(d){var e="on"+c.charAt(0).toUpperCase()+c.substring(1);m.has(e)?h(e,d):g.defaultOff&&g.defaultOff.call(b,c,d)}return a};return a}var na=new Set(["set","get","on","off"]);
function oa(a,b,c,d,e){var f=ma(e);Object.keys(b).filter(function(a){return!na.has(a)&&"function"===typeof b[a]}).filter(function(a){return!f.methods.hasOwnProperty(a)}).forEach(function(c){a[c]=b[c]});return la(a,c,d,Object.assign({},f,{defaultGetter:function(){return b.get.apply(a,arguments)},defaultSetter:function(){return b.set.apply(a,arguments)},defaultOn:function(){return b.on.apply(a,arguments)},defaultOff:function(){return b.off.apply(a,arguments)}}))};try{window.localStorage.setItem("ftap5caavc","ftap5caavc"),window.localStorage.removeItem("ftap5caavc")}catch(a){};function pa(){var a=document,b={};this.addEventListener=function(c,d,e){var f=b[c];f||(f=[],b[c]=f);f.push(d);a.addEventListener(c,d,e)};this.a=function(){Object.keys(b).forEach(function(c){b[c].forEach(function(b){return a.removeEventListener(c,b)})})}};function qa(a,b,c,d){a=c-a;b=d-b;return a*a+b*b};function ra(a){function b(a){return function(b){c(b)&&a.apply(this,arguments)}}function c(b){for(b=b.target;b;){if(b===a)return!0;b=b.parentElement}return!1}function d(a,b,c){c=c||{};e(a,c);b&&b.call(a.target,c);(void 0===c.originalEventDefaultAction&&c.$c||"prevent"===c.originalEventDefaultAction)&&a.preventDefault();return c}function e(b,c){var d=b.clientX,e=b.clientY,g=c||{},f=a.getBoundingClientRect();g.x=d-f.left;g.y=e-f.top;c.altKey=b.altKey;c.metaKey=b.metaKey;c.ctrlKey=b.ctrlKey;c.shiftKey=
b.shiftKey;c.md=3===b.which;return c}var f=new pa,h=void 0,k=void 0,l=void 0,g=void 0,p=void 0,m=void 0,n=void 0,q=void 0,r=void 0;this.click=function(a){return h=a};this.oc=function(a){l=a};this.Nc=function(a){k=a};this.hd=function(a){r=a};this.move=function(a){return g=a};this.Zc=function(a){p=a};this.rc=function(a){m=a};this.pc=function(a){n=a};this.qc=function(a){q=a};this.nb=function(){f.a()};var t,w,y,u,z=!1,v=!1,x=0,A=0,G=0,J=0;f.addEventListener("mousedown",b(function(a){var b=d(a,void 0);
G=b.x;J=b.y;x=b.x;A=b.y;z=!0;d(a,m);w=!1;t=window.setTimeout(function(){100>qa(x,A,b.x,b.y)&&(window.clearTimeout(u),d(a,k),w=!0)},400)}));f.addEventListener("mouseup",function(a){function b(a,b){b=b||{};b.x=a.pageX;b.y=a.pageY;return b}if(z){v&&d(a,q);window.clearTimeout(t);if(!w&&!v&&c(a)){var e=b(a,{});y&&100>qa(e.x,e.y,y.x,y.y)?d(a,l):d(a,h);y=e;u=window.setTimeout(function(){y=null},350)}v=z=!1}});f.addEventListener("mousemove",function(a){var b=e(a,{});c(a)&&d(a,g,{type:"move"});x=b.x;A=b.y;
z&&!v&&100<qa(G,J,x,A)&&(v=!0);v&&d(a,n,b)});f.addEventListener("mouseout",b(function(a){d(a,p,{type:"out"})}));f.addEventListener("wheel",b(function(){return function(a){if("deltaY"in a)var b=a.deltaY;else b=0,"detail"in a&&(b=a.detail),"wheelDelta"in a&&(b=-a.wheelDelta/120),"wheelDeltaY"in a&&(b=-a.wheelDeltaY/120),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(b=0),b*=10;b&&a.deltaMode&&(b=1===a.deltaMode?67*b:800*b);d(a,r,{Ba:-b/200,$c:!0})}}()),{passive:!1});f.addEventListener("contextmenu",b(function(a){a.preventDefault()}))}
;function sa(){function a(e){function f(a,b){for(h=0;h<a.length;h++){k=a[h];var c=window.performance.now();c<l&&k(e,c,l)||b.push(k)}}d=!1;var h,k,l=window.performance.now()+12,g=b,p=c;b=[];c=[];f(g,b);f(p,c);(0<b.length||0<c.length)&&!d&&(requestAnimationFrame(a),d=!0)}var b=[],c=[],d=!1;this.fb=function(c){b.push(c);d||(requestAnimationFrame(a),d=!0)}};function ta(a,b,c){var d=Math.pow(2,.5),e;b.Yc(function(b){1<=Math.abs(b.Ba)?a.kb(b.x,b.y,0<b.Ba?d:1/d):(a.Ra(b.x,b.y,Math.pow(2,b.Ba/2)),window.clearTimeout(e),e=window.setTimeout(function(){a.kc(b.x,b.y,b.Ba)},50))});b.Sc(function(b){var c=2*(b.altKey?1:2);a.kb(b.x,b.y,b.ctrlKey?1/c:c)});document.addEventListener("keydown",function(b){27===b.keyCode&&a.reset()});var f,h,k=!1,l,g,p,m,n=!1,q=1,r;b.Vc(function(a){f=a.x;h=a.y;l=a.x;g=a.y;k=!0});b.Tc(function(b){k&&(p=b.x,m=b.y,n||(n=!0,c.fb(function(){if(b.shiftKey){var c=
p-l,d=m-g;c=Math.max(10,Math.sqrt(c*c+d*d));r?b.ctrlKey?(c=r/c,d=c/q,q=c,a.Ra(p,m,d)):(c/=r,d=c/q,q=c,a.Ra(l,g,d)):r=c}else a.fc(p-f,m-h);f=p;h=m;n=!1;return!0})))});b.Uc(function(b){r=void 0;b.shiftKey?q=1:c.fb(function(){a.fc(b.x-f,b.y-h);return!0})})};var ua="function"===typeof Float32Array;function va(a,b,c){return(((1-3*c+3*b)*a+(3*c-6*b))*a+3*b)*a}
function wa(a,b,c){if(!(0<=a&&1>=a&&0<=c&&1>=c))throw Error("bezier x values must be in [0, 1] range");var d=ua?new Float32Array(11):Array(11);if(a!==b||1!==c)for(var e=0;11>e;++e)d[e]=va(.1*e,a,c);return function(e){if(a!==b||1!==c)if(0===e)e=0;else if(1===e)e=1;else{for(var f=0,k=1;10!==k&&d[k]<=e;++k)f+=.1;--k;k=f+(e-d[k])/(d[k+1]-d[k])*.1;var l=3*(1-3*c+3*a)*k*k+2*(3*c-6*a)*k+3*a;if(.001<=l){for(f=0;4>f;++f){l=3*(1-3*c+3*a)*k*k+2*(3*c-6*a)*k+3*a;if(0===l)break;k-=(va(k,a,c)-e)/l}e=k}else if(0===
l)e=k;else{k=f;f+=.1;var g=0;do{var p=k+(f-k)/2;l=va(p,a,c)-e;0<l?f=p:k=p}while(1E-7<Math.abs(l)&&10>++g);e=p}e=va(e,b,1)}return e}};function xa(a,b){return void 0!==a?a:b};function ya(a,b){function c(a,b){for(var c=0;c<g.length;c++){var d=g[c];a[d]=b[d]}return a}var d=wa(.25,.1,.25),e=a.duration,f=a.step,h=a.complete,k,l=!1,g,p,m,n;this.a=function(a){g=Object.keys(a);m=c({},a);p=c({},a)};this.start=function(a,r){a&&(n=c({},a));a=!0;for(var t=0;t<g.length;t++){var q=g[t];if(m[q]!==n[q]){a=!1;break}}a||(k=window.performance.now(),l||(l=!0,b.fb(function(a){a=d(Math.max(0,Math.min(1,(a-k)/xa(r,e))));for(var b=0;b<g.length;b++){var c=g[b],t=m[c];p[c]=t+a*(n[c]-t)}f(p,a);
if(1>a)return!1;h&&h(p);l=!1;return!0})))}};function Aa(a,b){function c(a,b,c,d){a.j=(a.j-b)*d+b;a.l=(a.l-c)*d+c;a.scale*=d}var d={j:a.$.j,l:a.$.l,scale:a.$.scale},e={j:a.$.j,l:a.$.l,scale:a.$.scale},f=a.ed,h=new ya({duration:450,step:function(a){d.j=a.j;d.l=a.l;d.scale=a.scale;f.setTransform(d.j,d.l,d.scale)}},b);this.kb=function(a,b,g){h.a(d);c(e,a,b,g);h.start(e)};this.kc=function(a,b,g){h.a(d);var f=Math.log(e.scale)/Math.log(2);c(e,a,b,Math.pow(2,.25*(0<g?Math.ceil(f/.25):Math.floor(f/.25)))/e.scale);h.start(e,250)};this.b=function(a,
b,c,f){h.a(d);e.j=a;e.l=b;e.scale=c;h.start(e,f)};this.Ra=function(a,b,g){c(d,a,b,g);e.j=d.j;e.l=d.l;e.scale=d.scale;f.setTransform(d.j,d.l,d.scale)};this.fc=function(a,b){if(0!==a||0!==b)d.j+=a,d.l+=b,e.j+=a,e.l+=b,f.setTransform(d.j,d.l,d.scale)};this.reset=function(b){h.a(d);e.j=a.$.j;e.l=a.$.l;e.scale=a.$.scale;h.start(e,b)};this.resize=function(a,b,c,e,h,n){if(0!==a-c||0!==b-e){e=d.j;var g=d.l;b=d.scale;c/=n.u;a/=h.u;1===b?(h=a/c,e*=h,g*=h):(e=(e/(1-b)/c+n.x-h.x)*a,h=(g/(1-b)/c+n.y-h.y)*a,e=
-e*b+e,g=-h*b+h);f.setTransform(e,g,b)}};this.a=function(){return d};this.f=function(){f.setTransform(d.j,d.l,d.scale)}};function Ba(a,b,c,d){this.x=a;this.y=b;this.u=c;this.B=d;this.a=function(){return Math.sqrt(this.u*this.u+this.B*this.B)};this.Pc=function(){return this.ec(.05*this.a())};this.ec=function(a){return new Ba(this.x-a,this.y-a,this.u+2*a,this.B+2*a)};this.dc=function(a){if(this.u/this.B<a)return a=this.B*a-this.u,new Ba(this.x-a/2,this.y,this.u+a,this.B);a=this.u/a-this.B;return new Ba(this.x,this.y-a/2,this.u,this.B+a)}}
function Ca(){return new function(){var a=Number.MAX_VALUE,b=Number.MAX_VALUE,c=-Number.MAX_VALUE,d=-Number.MAX_VALUE;this.ib=function(e){e=K(e);for(var f=e.next();!f.done;f=e.next())f=f.value,a>f.x?a=f.x:c<f.x&&(c=f.x),b>f.y?b=f.y:d<f.y&&(d=f.y);return this};this.mb=function(){if(a!==Number.MAX_VALUE||b!==Number.MAX_VALUE)return new Ba(a,b,c-a,d-b)}}};function Da(a){this.multiply=function(b){var c=b.elements();b=a[0];var d=a[1],e=a[2],f=a[3],h=a[4],k=a[5],l=a[6],g=a[7],p=a[8],m=c[0],n=c[1],q=c[2],r=c[3],t=c[4],w=c[5],y=c[6],u=c[7];c=c[8];a[0]=m*b+n*f+q*l;a[1]=m*d+n*h+q*g;a[2]=m*e+n*k+q*p;a[3]=r*b+t*f+w*l;a[4]=r*d+t*h+w*g;a[5]=r*e+t*k+w*p;a[6]=y*b+u*f+c*l;a[7]=y*d+u*h+c*g;a[8]=y*e+u*k+c*p;return this};this.transform=function(b,c){return[b*a[0]+c*a[3]+1*a[6],b*a[1]+c*a[4]+1*a[7],b*a[2]+c*a[5]+1*a[8]]};this.translate=function(a,c){return this.multiply(new Da([1,
0,0,0,1,0,a,c,1]))};this.scale=function(a,c){return this.multiply(new Da([a,0,0,0,c,0,0,0,1]))};this.elements=function(){return a}}function Fa(){return new Da([1,0,0,0,1,0,0,0,1])};function Ga(a){function b(a,b){var c=g.createRenderbuffer();this.use=function(a){g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,c);a.call(this);g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,null)};this.release=function(){g.deleteRenderbuffer(c)};this.resize=function(a,b){g.bindRenderbuffer(g.RENDERBUFFER,c);g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_COMPONENT16,a,b);g.bindRenderbuffer(g.RENDERBUFFER,null)};this.resize(a,b)}function c(){var a=
g.createFramebuffer();this.use=function(b){g.bindFramebuffer(g.FRAMEBUFFER,a);b.call(this);g.bindFramebuffer(g.FRAMEBUFFER,null)};this.release=function(){g.deleteFramebuffer(a)}}function d(a,d,e,f,h){function l(){p||(p=new c,p.use(function(){g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,a,0)}));return p}var r=this,m=d,A=e,p,t;this.use=function(b,c){g.activeTexture(g.TEXTURE0+b);g.bindTexture(g.TEXTURE_2D,a);c.call(this)};this.Gc=function(){return a};this.$a=function(){return m};
this.ya=function(){return A};this.release=function(){g.deleteTexture(a);p&&p.release()};this.capture=function(a,c,d,e){c=void 0===c?!1:c;var g=l();if(c){t||(t=new b(m,A));var f=t}else f=void 0;var h=f;k.Oa(d||m,e||A,function(){c?g.use(function(){h.use(a)}):g.use(a)})};this.pa=function(a,b){var c=a||m,d=b||A;k.Oa(c,d,function(){n.use(function(){n.g("aVertexPosition",q);n.m("uInput",r,0);n.o("uResolution",c,d);n.D(["aVertexPosition"]);n.X(q.h())})})};this.resize=function(b,c){m=b;A=c;g.bindTexture(g.TEXTURE_2D,
a);g.texImage2D(g.TEXTURE_2D,0,f,m,A,0,f,h,null);g.bindTexture(g.TEXTURE_2D,null);t&&t.resize(b,c)};this.uc=function(){return l()}}function e(){var a=g.createBuffer(),b,c;this.release=function(){g.deleteBuffer(a)};this.bind=function(d){g.bindBuffer(g.ARRAY_BUFFER,a);d.call(this,b,c);g.bindBuffer(g.ARRAY_BUFFER,null)};this.setData=function(a,d,e){b=d;c=e;this.bind(function(){g.bufferData(g.ARRAY_BUFFER,a,g.STATIC_DRAW)})};this.h=function(){return c}}function f(a,b,c,d,e){function f(a){var b=r[a];if(void 0===
b)throw"Unknown attribute "+a+".";return b}function k(a){var b=t[a];if(void 0===b)throw"Unknown uniform  "+a+".";return b}function h(b,c){c=g.createShader(c);g.shaderSource(c,b);g.compileShader(c);if(!g.getShaderParameter(c,g.COMPILE_STATUS))throw"Shader in program '"+a+"' failed to compile: "+g.getShaderInfoLog(c)+".";return c}var l=h(b,g.VERTEX_SHADER),n=h(c,g.FRAGMENT_SHADER),p=g.createProgram();g.attachShader(p,l);g.attachShader(p,n);g.linkProgram(p);if(!g.getProgramParameter(p,g.LINK_STATUS))throw"Could not link program '"+
a+"'.";var r=d.reduce(function(b,c){var d=g.getAttribLocation(p,c);if(0>d)throw"Failed to find location of attribute "+c+" in program "+a;b[c]=d;return b},{}),t=e.reduce(function(b,c){var d=g.getUniformLocation(p,c);if(0>d)throw"Failed to find location of uniform "+c+" in program "+a;b[c]=d;return b},{});this.D=function(a){a=K(a);for(var b=a.next();!b.done;b=a.next())g.enableVertexAttribArray(f(b.value))};this.use=function(a){g.useProgram(p);a.call(this);g.useProgram(null)};this.g=function(a,b,c,
d,e,k,h){c=void 0===c?g.FLOAT:c;d=void 0===d?!1:d;e=void 0===e?0:e;k=void 0===k?0:k;h=void 0===h?!1:h;b.bind(function(b){var l=f(a);g.vertexAttribPointer(l,b,c,d,e,k);h?m.vertexAttribDivisorANGLE(l,1):m.vertexAttribDivisorANGLE(l,0)})};this.c=function(a,b){g.uniform1f(k(a),b)};this.o=function(a,b,c){g.uniform2f(k(a),b,c)};this.gd=function(a,b,c){g.uniform3f(k("uLight"),a,b,c)};this.gb=function(a,b){var c=1/255;g.uniform4f(k(a),b[0]*c,b[1]*c,b[2]*c,b[3]*c)};this.va=function(a){g.uniformMatrix3fv(k("uMvMatrix"),
!1,a)};this.m=function(a,b,c){b.use(c,function(){g.uniform1i(k(a),c)})};this.Da=function(a,b){m.drawArraysInstancedANGLE(g.TRIANGLE_FAN,0,void 0===b?0:b,a)};this.X=function(a){g.drawArrays(g.TRIANGLE_STRIP,0,a)};this.ob=function(a){g.drawArrays(g.POINTS,0,a)};this.release=function(){g.deleteShader(l);g.deleteShader(n);g.deleteProgram(p)}}var h=this,k=this,l=Object.assign({pb:[]},{pb:Ha}),g=a.getContext("webgl");g||(g=a.getContext("experimental-webgl"));if(!g)throw"DotAtlas requires WebGL support";
l=K(l.pb);for(var p=l.next();!p.done;p=l.next())if(p=p.value,!g.getExtension(p))throw"WebGL extension "+p+" is not supported.";var m=g.getExtension("ANGLE_instanced_arrays");if(!m)throw"WebGL extension ANGLE_instanced_arrays is required.";g.getExtension("EXT_disjoint_timer_query");this.V=g;this.canvas=a;this.createProgram=function(a){return new f(a.name,a.L,a.J,void 0===a.C?[]:a.C,void 0===a.H?[]:a.H)};this.createBuffer=function(){return new e};this.da=function(){var a=this.createBuffer();a.setData(new Float32Array([-1,
1,1,1,-1,-1,1,-1]),2,4);return a};this.createTexture=function(a,b,c,e,f,k){f=void 0===f?g.RGBA:f;k=void 0===k?g.FLOAT:k;return d.a(a,b,c,e,f,k)};this.nc=function(a,b,c,d,e,f){e=void 0===e?g.RGBA:e;f=void 0===f?g.FLOAT:f;return a?(a.resize(b,c),a):h.createTexture(null,b,c,d,e,f)};this.createFramebuffer=function(){return new c};this.Oa=function(a,b,c){var d=g.getParameter(g.VIEWPORT);g.viewport(0,0,a,b);c();g.viewport.apply(g,d instanceof Array?d:ha(K(d)))};this.ca=function(){g.clearColor(0,0,0,0);
g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT)};var n=this.createProgram({name:"fullscreen",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",J:"\n      precision mediump float;\n\n      uniform vec2 uResolution;\n      uniform sampler2D uInput;\n\n      void main() {\n        vec2 uv = vec2(gl_FragCoord.xy / uResolution.xy);\n        gl_FragColor = texture2D(uInput, uv);\n      }\n    ",
C:["aVertexPosition"],H:["uInput","uResolution"]}),q=k.da();d.a=function(a,b,c,e,f,k){f=void 0===f?g.RGBA:f;k=void 0===k?g.FLOAT:k;var h=g.createTexture();g.bindTexture(g.TEXTURE_2D,h);g.texImage2D(g.TEXTURE_2D,0,f,b,c,0,f,k,a);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,e);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,e);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE);g.bindTexture(g.TEXTURE_2D,null);return new d(h,
b,c,f,k)};d.b=function(a,b,c,e,f,k){f=void 0===f?g.RGBA:f;k=void 0===k?g.UNSIGNED_BYTE:k;var h=g.createTexture();g.bindTexture(g.TEXTURE_2D,h);g.texImage2D(g.TEXTURE_2D,0,f,f,k,a);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,e);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,e);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE);g.bindTexture(g.TEXTURE_2D,null);return new d(h,b,c,f,k)}};function O(){var a=[];this.a=function(b){a.push(b);return b};this.f=function(b){a=a.filter(function(a){return a!==b});return b};this.b=function(b){a.forEach(function(a){return b(a)})}}function P(){var a=this;O.call(this);this.N=function(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];a.b(function(a){return a.apply(null,c instanceof Array?c:ha(K(c)))})}}P.prototype=Object.create(O.prototype);function Ia(a,b,c){var d=this,e=a,f=b,h,k,l,g,p=new O;a=new O;var m=new O,n=new O;this.ia=p.a;this.hb=a.a;this.Pa=m.a;this.jb=n.a;this.gc=p.f;this.ad=m.f;this.v=function(){return c};this.U=function(){return e};this.Z=function(){return f};this.ma=function(){return e*c};this.la=function(){return f*c};this.fa=function(){return d.ma()/2};this.ea=function(){return d.la()/2};this.Ga=function(){return h};this.Hc=function(){return k};this.Ic=function(){return l};this.La=function(){return g};this.M=function(a,
b){e=a;f=b;p.b(function(c){return c.M(a,b)})};this.na=function(a){h=a;m.b(function(b){return b.na(a)})};this.setTransform=function(a,b,c){k=a;l=b;g=c;n.b(function(d){d.setTransform(a,b,c)})}};function Ja(a,b){function c(a,c){return function(d){var e=K(b.hc(d.x,d.y)),f=e.next().value;e=e.next().value;if(a&&a.R){var g=!1;if(!1===a.R({x:f,y:e,elementX:d.x,elementY:d.y,delta:d.Ba,ctrlKey:d.ctrlKey,shiftKey:d.shiftKey,altKey:d.altKey,preventDefault:function(){return g=!0}})||g)return}d.pointX=f;d.pointY=e;c.N(d)}}var d=new P,e={R:void 0};this.Yc=d.a;this.i=function(a){return e.R=a};a.hd(c(e,d));d=new P;var f={R:void 0};this.Rc=d.a;this.a=function(a){return f.R=a};a.click(c(f,d));d=new P;var h=
{R:void 0};this.Sc=d.a;this.b=function(a){return h.R=a};a.oc(c(h,d));d=new P;this.Wc=d.a;a.Nc(c({R:void 0},d));d=new P;this.Vc=d.a;a.rc(c({R:void 0},d));d=new P;this.Tc=d.a;a.pc(c({R:void 0},d));d=new P;this.Uc=d.a;a.qc(c({R:void 0},d));d=new P;var k={R:void 0};this.Xc=d.a;this.f=function(a){return k.R=a};a.move(c(k,d));a.Zc(c(k,new P))};function Ka(a,b,c,d,e,f){c=La(e.sa,e.coords,a,b,c,e.cb);if(f){var h=c.reduce(function(c,e){var f=d[e];c.set(e,qa(f.x,f.y,a,b));return c},new Map);c.sort(function(a,b){return h.get(a)-h.get(b)})}return c};function Ma(){var a=this,b=new Set;this.set=function(a){b.add(a)};this.clear=function(a){b.delete(a)};this.a=function(a){return b.delete(a)};this.b=function(b){for(var c=[],e=0;e<arguments.length;++e)c[e]=arguments[e];return c.reduce(function(b,c){return a.a(c)||b},!1)};this.f=function(b,d){a.a(b)&&d()}}D();var Q=Symbol();D();var S=Symbol();D();var Na=Symbol();D();var Oa=Symbol();D();var Pa=Symbol();D();var Qa=Symbol();D();var Ra=Symbol();D();var T=Symbol();D();var X=Symbol();D();var Sa=Symbol();
D();var Ta=Symbol();D();var Ua=Symbol();D();var Va=Symbol();D();var Wa=Symbol();D();var Xa=Symbol();D();var Ya=Symbol();D();var Za=Symbol();function $a(a,b){var c=[new ab(b,Wa,function(a,b,c){return new bb(a,b,c)},function(a){return a.Ec()},function(b){return a.Xc(b)}),new ab(b,Xa,function(a,b,c){return new cb(a,b,c)},function(a){return a.Cc()},function(b){return a.Rc(b)}),new ab(b,Ya,function(a,b,c){return new cb(a,b,c)},function(a){return a.Dc()},function(b){return a.Wc(b)})];this.Qa=function(a){c.forEach(function(b){return b.Qa(a)})};this.eb=function(){c.forEach(function(a){return a.eb()})}}
function ab(a,b,c,d,e){function f(a){a.wa(function(c){c===b&&h(a)});h(a)}function h(b){var e=d(b);e?k.set(b,c(b,e,a)):k.delete(b)}var k=new Map;this.Qa=function(a){a.forEach(f)};this.eb=function(){k.clear()};e(function(a){for(var b=K(k),c=b.next();!c.done;c=b.next())c=K(c.value),c.next(),c.next().value.N(a)})}
function db(a,b,c,d){function e(c,d){f.x=c.pointX;f.y=c.pointY;f.ctrlKey=c.ctrlKey;f.altKey=c.altKey;f.shiftKey=c.shiftKey;f.points=d.map(function(b){return a.K()[b]});b(f)}var f={};this.N=function(b){var f=a.K(),h=a.Za(),g=.5*a.ac()*a.Ka(c)*c.Ga().u/(c.U()*c.v()*c.La());f=Ka(b.pointX,b.pointY,g,f,h,!0);d(b,f,e)}}function cb(a,b,c){this.N=(new db(a,b,c,function(a,b,c){c(a,b)})).N}
function bb(a,b,c){var d=null;this.N=(new db(a,b,c,function(a,b,c){if(null===d)0!==b.length&&(d=b,c(a,b));else if(b.length===d.length)for(var e=0;e<b.length;e++){if(b[e]!==d[e]){d=b;c(a,b);break}}else d=b,c(a,b)})).N};function eb(a){var b=a.V,c=a.createProgram({name:"blur",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",J:"\n      precision mediump float;\n\n      uniform vec2 uOutputSize;\n      uniform sampler2D uInput;\n      uniform vec2 uInputSize;\n      \n      \n  vec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w) * (1.0/6.0);\n  }\n  \n  vec4 textureBicubic(sampler2D sampler, vec2 texSize, vec2 texCoords) {\n    vec2 invTexSize = 1.0 / texSize;\n     \n    texCoords = texCoords * texSize - 0.5;\n     \n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2(-0.5, +1.5).xyxy;\n    \n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4(xcubic.yw, ycubic.yw) / s;\n    \n    offset *= invTexSize.xxyy;\n    \n    vec4 sample0 = texture2D(sampler, offset.xz);\n    vec4 sample1 = texture2D(sampler, offset.yz);\n    vec4 sample2 = texture2D(sampler, offset.xw);\n    vec4 sample3 = texture2D(sampler, offset.yw);\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(mix(sample3, sample2, sx), mix(sample1, sample0, sx) , sy);\n  }\n\n\n      void main() {\n        vec2 uv = vec2(gl_FragCoord.xy / uOutputSize.xy);\n        gl_FragColor = textureBicubic(uInput, uInputSize.xy, uv);\n      }\n    ",
C:["aVertexPosition"],H:["uInput","uInputSize","uOutputSize"]}),d=a.da(),e=a.createFramebuffer();this.resize=function(f,h,k,l,g,p){e.use(function(){b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,l.Gc(),0)});b.disable(b.BLEND);a.Oa(g,p,function(){e.use(function(){b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT);c.use(function(){c.g("aVertexPosition",d);c.m("uInput",f,0);c.o("uInputSize",h,k);c.o("uOutputSize",g,p);c.D(["aVertexPosition"]);c.X(d.h())})})})}};function fb(a,b){function c(c,d){function g(a,b,c,d){b.capture(function(){h.use(function(){h.g("aVertexPosition",u);h.m("uSampler",a,0);h.o("increment",c,d);h.D(["aVertexPosition"]);h.X(u.h())})},!1,m,p)}var k=c.T(),n=c.Fc(),m=l.width()+l.margin(),p=l.height()+l.margin();e.viewport(0,0,m,p);e.enable(e.BLEND);e.blendEquation(e.FUNC_ADD);e.blendFunc(e.ONE,e.ONE);e.clearColor(0,0,0,0);var x=Math.min(k.Tb(),n.h());0===x?r.capture(function(){a.ca()},!1,m,p):(r.capture(function(){a.ca();f.use(function(){var a=
b.Ga();f.c("uMaxRadius",Math.min(a.u,a.B)/k.Ub());f.c("uRadiusPow",k.sb());f.g("aVertexPosition",w,e.BYTE,!0);f.g("aPointData",n,e.FLOAT,!1,0,0,!0);f.m("uProfile",q,0);f.va(d.elements());f.D(["aVertexPosition","aPointData"]);f.Da(x,w.h())})},!1,m,p),e.disable(e.BLEND),g(r,t,1,0),g(t,r,0,1))}var d=this,e=a.V,f=a.createProgram({name:"heightmap",L:"\n      precision mediump float;\n      uniform float uMaxRadius;\n      uniform float uRadiusPow;\n      uniform float uCircumToInscribedRadius;\n\n      attribute vec2 aVertexPosition;\n      attribute vec3 aPointData;\n\n      varying vec2 coordinate;\n      varying vec3 pointData;\n\n      uniform mat3 uMvMatrix;\n\n      void main(void) {\n        float radius = pow(aPointData.z, uRadiusPow) * uMaxRadius;\n        // If we switch to representing elevations by some other shape,\n        // we'd need to pass a different scaling factor.\n        // We need the factor because the coordinates are passed in as\n        // unsigned bytes and normalized to the 0..1 range by the GPU.\n        // Here we need a triangle with inscribed circle of radius 1.0,\n        // that's why we need to apply the extra scaling.\n        vec2 scaled = uCircumToInscribedRadius * aVertexPosition * radius + aPointData.xy;      \n      \n        gl_Position = vec4(uMvMatrix * vec3(scaled, 1.0), 1.0);\n        coordinate = scaled;\n        pointData = aPointData;\n      }\n    ",
J:"\n      precision mediump float;\n      uniform float uMaxRadius;\n      uniform float uRadiusPow;\n      uniform sampler2D uProfile;\n\n      varying vec2 coordinate;\n      varying vec3 pointData;\n\n      void main(void) {\n        float radius = pow(pointData.z, uRadiusPow) * uMaxRadius;\n        float d = length(coordinate - pointData.xy) / radius;\n        float h = radius * texture2D(uProfile, vec2(d, 0.0)).r;\n\n        gl_FragColor = vec4(h, 0.0, 0.0, 0.0);\n      }\n    ",C:["aVertexPosition",
"aPointData"],H:["uMaxRadius","uRadiusPow","uCircumToInscribedRadius","uMvMatrix","uProfile"]}),h=a.createProgram({name:"prefiltering",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",J:"\n      precision mediump float;\n      uniform sampler2D uSampler;                                                 \n      uniform vec2 increment;                                                     \n      uniform vec2 uTextureResolution;\n\n      void main(void) {                                         \n        vec2 vTextureCoord = gl_FragCoord.xy / uTextureResolution;\n        vec4 w = 1.732176555 * texture2D(uSampler, vTextureCoord);              \n        vec2 inc = increment / uTextureResolution;\n        vec2 im = vTextureCoord - inc;                                    \n        vec2 ip = vTextureCoord + inc;                                    \n        w -= 0.464135309 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w += 0.124364681 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w -= 0.033323416 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w += 0.008928982 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w -= 0.002392514 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w += 0.000641072 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w -= 0.000171775 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        gl_FragColor = w;                                                       \n      }\n    ",
C:["aVertexPosition"],H:["uSampler","uTextureResolution","increment"]});a.createProgram({name:"prefiltering",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",J:"\n      precision mediump float;\n      uniform sampler2D uHeightmap;                                                 \n      uniform vec2 uTextureResolution;\n\n      void main(void) {                                         \n        vec2 vTextureCoord = gl_FragCoord.xy / uTextureResolution;\n        \n        // < 0 values are filtering artifacts, they mess with\n        // modulos, so stick to >= 0 heights.\n        float h = max(0.0, texture2D(uHeightmap, vTextureCoord).r);     \n        \n        // Pack the float into 4 bytes. GLSL uses 0..1 normalized\n        // floats for 0..255 bytes, hence the division by 256.0.\n        gl_FragColor = vec4(\n          mod(floor(h / 65536.0), 256.0) / 256.0, \n          mod(h / 256.0, 256.0) / 256.0, \n          mod(h, 256.0) / 256.0, \n          fract(h)\n        );                                                       \n      }\n    ",
C:["aVertexPosition"],H:["uHeightmap","uTextureResolution"]});var k=a.createProgram({name:"toBytes",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",J:"\n      precision mediump float;\n      uniform sampler2D uHeightmap;                                                 \n      uniform vec2 uTextureSize;\n      uniform vec2 uViewportSize;\n      uniform float uElevationOffset;\n      uniform float uMax;\n      \n      \n  vec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w) * (1.0/6.0);\n  }\n  \n  vec4 textureBicubic(sampler2D sampler, vec2 texSize, vec2 texCoords) {\n    vec2 invTexSize = 1.0 / texSize;\n     \n    texCoords = texCoords * texSize - 0.5;\n     \n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2(-0.5, +1.5).xyxy;\n    \n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4(xcubic.yw, ycubic.yw) / s;\n    \n    offset *= invTexSize.xxyy;\n    \n    vec4 sample0 = texture2D(sampler, offset.xz);\n    vec4 sample1 = texture2D(sampler, offset.yz);\n    vec4 sample2 = texture2D(sampler, offset.xw);\n    vec4 sample3 = texture2D(sampler, offset.yw);\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(mix(sample3, sample2, sx), mix(sample1, sample0, sx) , sy);\n  }\n\n\n      void main(void) {                                         \n        // < 0 values are filtering artifacts, they mess with\n        // modulos, so stick to >= 0 heights.\n        float h = max(0.0, textureBicubic(uHeightmap, uTextureSize, \n            gl_FragCoord.xy / uViewportSize).x + uElevationOffset);\n\n        // Pack the float into 4 bytes. GLSL uses 0..1 normalized\n        // floats for 0..255 bytes, hence the division by 256.0.\n        gl_FragColor = vec4(\n          mod(floor(h / 65536.0), 256.0) / 256.0, \n          mod(h / 256.0, 256.0) / 256.0, \n          mod(h, 256.0) / 256.0, \n          fract(h)\n        );\n      }\n    ",
C:["aVertexPosition"],H:["uHeightmap","uTextureSize","uViewportSize","uElevationOffset"]}),l,g,p,m,n,q=function(b){for(var c=wa(.2,0,.15),d=new Float32Array(4*b),f=0;f<d.length;)d[f]=1-c((f>>2)/(b-1)),f+=4;return a.createTexture(d,d.length>>2,1,e.LINEAR)}(e.getParameter(e.MAX_TEXTURE_SIZE)),r,t,w=a.createBuffer(),y=function(a){for(var b=2*Math.PI/3,c=1/Math.cos(b/2),d=127/c,e=1/Math.cos(b/2),f=new Int8Array(6),g=0,k=0;3>k;k++){var h=k*b;f[g++]=d*c*Math.sin(h);f[g++]=d*c*Math.cos(h)}a.setData(f,2,
3);return e}(w);f.use(function(){f.c("uCircumToInscribedRadius",y)});var u=a.da(),z=new Uint8Array(4);this.f=function(b){function c(b,c){c=void 0===c?e.FLOAT:c;var d=l.ua(),f=l.ta();return b?(b.resize(d,f),b):a.createTexture(null,d,f,e.LINEAR,e.RGBA,c)}l=b;r=c(r);t=c(t);h.use(function(){h.o("uTextureResolution",l.ua(),l.ta())});m=!0};this.ga=function(a){p=a;m=!0};this.W=function(a){g=a};this.a=function(a,b){var d=a.ba(),e=a.mc();if(b||d||e||m)m=!1,n=!0,c(a,b||p)};this.s=function(a,b,c){d.b(z,a,b,
1,1,c);return z[3]/256+z[2]+256*z[1]+65536*z[0]};this.b=function(a,b,c,f,g,h,m){d.a(h,m);var p=h.tb(),t=h.T();n&&(p.capture(function(){e.clear(e.COLOR_BUFFER_BIT);e.disable(e.BLEND);k.use(function(){k.c("uElevationOffset",void 0===t.Ia()?0:t.Ia()*t.Ua());k.g("aVertexPosition",u);k.m("uHeightmap",r,0);k.o("uViewportSize",l.ua()*l.Ea()*l.Fa()/2,l.ta()*l.Ea()*l.Fa()/2);k.o("uTextureSize",l.ua(),l.ta());k.D(["aVertexPosition"]);k.X(u.h())});e.enable(e.BLEND)}),n=!1);p.uc().use(function(){e.readPixels(b,
g===p.ya()?c:p.ya()-c,f,g,e.RGBA,e.UNSIGNED_BYTE,a)})};this.O=function(a){var b=a.tb(),c=b.$a(),d=b.ya();b=new Uint8Array(c*d*4);this.b(b,0,0,c,d,a,g);for(c=a=0;c<b.length;)d=b[c+3]/256+b[c+2]+256*b[c+1]+65536*b[c],a<d&&(a=d),c+=4;0===a&&(a=1);return a};this.release=function(){q.release();r.release();t.release();w.release();u.release()};this.i=function(){return r}}
function gb(a,b,c){function d(){var a=new Float32Array(3*k.length),b=0,c=k.slice(0).sort(function(a,b){return(b.elevation||0)-(a.elevation||0)});if(0<c.length){var d=c[0].elevation||0;for(var e=K(c),f=e.next();!f.done;f=e.next())f=f.value,d<f.elevation&&(d=f.elevation)}else d=1;e=K(c);for(f=e.next();!f.done;f=e.next())f=f.value,a[b++]=f.x,a[b++]=f.y,a[b++]=(f.elevation||0)/d;l.setData(a,3,c.length)}var e=this,f=a.V,h=new Ma;c.wa(function(a){h.set(a)});h.set(Q);h.set(Za);var k,l=a.createBuffer(),g,
p,m;this.T=function(){return c};this.S=function(){return b};this.ba=function(){if(h.b(Q,S))return k=c.K(),d(),!0;if(h.a(Za)){for(var b=f.getParameter(f.MAX_TEXTURE_SIZE),e=c.Ta(),l=new Float32Array(4*b),n=0,m=0;n<l.length;){for(var u=(n>>2)/(b-1);e[m].end<u;)m++;u=e[m];l[n++]=u.color[0]/256;l[n++]=u.color[1]/256;l[n++]=u.color[2]/256;l[n++]=u.shading?1:0}g=a.createTexture(l,l.length>>2,1,f.NEAREST);l=f.getParameter(f.MAX_TEXTURE_SIZE);e=c.Ta();b=new Float32Array(4*l);for(m=n=0;n<b.length;){for(u=
(n>>2)/(l-1);e[m].end<u;)m++;b[n++]=0===m?0:e[m-1].end;b[n++]=e[m].end;n++;n++}for(l=0;!e[l].contours;)l++;if(l<e.length)for(e=(Math.floor((e[l-1].end+(l+1<e.length?e[l].end:1))/2*(b.length>>2))<<2)+2;0<=e;e-=4)b[e]=1;p=a.createTexture(b,b.length>>2,1,f.NEAREST)}return!1};this.mc=function(){return h.a(Ra)};this.Fc=function(){return l};this.sc=function(){return g};this.tc=function(){return p};this.tb=function(){return m};var n;this.Aa=function(a){n=a;n.ia(e);e.M()};this.release=function(){l.release();
g.release();p.release()};this.M=function(){m=a.nc(m,n.U(),n.Z(),f.NEAREST,f.RGBA,f.UNSIGNED_BYTE)}};function hb(a,b){var c=a.V,d=a.createProgram({name:"shading",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",J:"\n      #extension GL_OES_standard_derivatives : enable\n      precision mediump float;\n      uniform sampler2D uFbTexture;\n      uniform sampler2D uBandsTexture;\n      uniform sampler2D uBandLevelsTexture;\n      uniform sampler2D uMaskTexture;\n      uniform vec2 uViewportSize;\n      uniform vec2 uViewport;\n      uniform vec2 uTextureSize;\n      uniform float uMax;\n      uniform float uElevationOffset;\n      uniform vec3 uLight;\n      uniform float uLightIntensity;\n      uniform float uPixelNorm;\n      uniform float uContourOpacity;\n      uniform float uContourWidth;\n      uniform float uOpacity;\n      uniform float uSaturation;\n      uniform float uLightness;\n      uniform vec4 uLabelShadowColor;\n      uniform float uLabelShadowSize;\n\n      \n  vec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w) * (1.0/6.0);\n  }\n  \n  vec4 textureBicubic(sampler2D sampler, vec2 texSize, vec2 texCoords) {\n    vec2 invTexSize = 1.0 / texSize;\n     \n    texCoords = texCoords * texSize - 0.5;\n     \n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2(-0.5, +1.5).xyxy;\n    \n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4(xcubic.yw, ycubic.yw) / s;\n    \n    offset *= invTexSize.xxyy;\n    \n    vec4 sample0 = texture2D(sampler, offset.xz);\n    vec4 sample1 = texture2D(sampler, offset.yz);\n    vec4 sample2 = texture2D(sampler, offset.xw);\n    vec4 sample3 = texture2D(sampler, offset.yw);\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(mix(sample3, sample2, sx), mix(sample1, sample0, sx) , sy);\n  }\n\n      \n      float Epsilon = 1e-10;\n \n      vec3 RGBtoHCV(vec3 RGB)\n      {\n        // Based on work by Sam Hocevar and Emil Persson\n        vec4 P = (RGB.g < RGB.b) ? vec4(RGB.bg, -1.0, 2.0/3.0) : vec4(RGB.gb, 0.0, -1.0/3.0);\n        vec4 Q = (RGB.r < P.x) ? vec4(P.xyw, RGB.r) : vec4(RGB.r, P.yzx);\n        float C = Q.x - min(Q.w, Q.y);\n        float H = abs((Q.w - Q.y) / (6.0 * C + Epsilon) + Q.z);\n        return vec3(H, C, Q.x);\n      }\n      \n      vec3 RGBtoHSL(vec3 RGB)\n      {\n        vec3 HCV = RGBtoHCV(RGB);\n        float L = HCV.z - HCV.y * 0.5;\n        float S = HCV.y / (1.0 - abs(L * 2.0 - 1.0) + Epsilon);\n        return vec3(HCV.x, S, L);\n      }\n      \n      vec3 HUEtoRGB(float H)\n      {\n        float R = abs(H * 6.0 - 3.0) - 1.0;\n        float G = 2.0 - abs(H * 6.0 - 2.0);\n        float B = 2.0 - abs(H * 6.0 - 4.0);\n        return clamp(vec3(R, G, B), 0.0, 1.0);\n      }\n      \n      vec3 HSLtoRGB(vec3 HSL)\n      {\n        vec3 RGB = HUEtoRGB(HSL.x);\n        float C = (1.0 - abs(2.0 * HSL.z - 1.0)) * HSL.y;\n        return (RGB - 0.5) * C + HSL.z;\n      }\n      \n      void main(void) {\n        // Unpack 3 half-floats into a float to recover some more precision.\n        // vec3 ph = texture2D(uFbTexture, vTexturePosition).xyz;\n        // float h = (ph.x + (ph.y + ph.z) / 64.0) / (32.0 * uMax);\n\n        // Map height at the currently processed pixel.\n        // float h = texture2D(uFbTexture, gl_FragCoord.xy / uViewportSize).x / uMax;\n        float h = textureBicubic(uFbTexture, uTextureSize, gl_FragCoord.xy / uViewportSize).x / uMax + uElevationOffset;\n  \n        // Height deltas along x and y.\n        float dhx = dFdx(h);\n        float dhy = dFdy(h);\n  \n        // Band colors and the corresponding height levels.\n        vec4 bandColor = texture2D(uBandsTexture, vec2(h, 0.0));\n        vec4 bandLevels = texture2D(uBandLevelsTexture, vec2(h, 0.0));\n  \n        // Distance to the nearest band's boundary height.\n        // We can get a negative value here due to sampling, hence abs().\n        float dh = abs(min(h - bandLevels.r, bandLevels.g - h));\n  \n        // Detect band boundary edges and mark them.\n        float skipContouringFlag = bandLevels.b;\n        float dsx = dh / sqrt(dhx * dhx + dhy * dhy);\n        \n        // Label mask, applies to contours only\n        float mask = min(1.0, texture2D(uMaskTexture, gl_FragCoord.xy / uViewport).a * 8.0);\n\n        float multiplier = mix(max(max(skipContouringFlag, 1.0 - uContourOpacity), mask), 1.0, smoothstep(0.0, uContourWidth, dsx));\n  \n        // Lighting.\n        vec3 normal = vec3(dhx, dhy, uPixelNorm); // surface normal (cross product folded in and simplified to avoid useless computation)\n        float lightCos = (uLightIntensity * dot(normal, uLight) / length(normal) + 1.0) / 2.0;\n  \n        // Compose the final pixel color.\n        // bandColor.a contains a flag: 1.0 to light-shade the band color, 0.0 not to shade\n        float shadingFlag = bandColor.a;\n        float light = mix(0.5, lightCos, shadingFlag);\n        \n        // Lighten or darken depending on light\n        // TODO: use HSL to apply lighting?\n        vec3 color = bandColor.rgb * step(0.5, 1.0 - light) * (light * 2.0) +\n                     (bandColor.rgb + (1.0 - bandColor.rgb) * (light - 0.5) * 2.0) * (1.0 - step(0.5, 1.0 - light));\n                     \n        vec3 colorHsl = RGBtoHSL(color);\n        \n        gl_FragColor = vec4(HSLtoRGB(clamp(colorHsl + vec3(0.0, uSaturation, uLightness), 0.0, 1.0)) * multiplier, uOpacity);                                                       \n      }\n    ",
C:["aVertexPosition"],H:"fbTextureBuffer uBandsTexture uBandLevelsTexture uViewportSize uTextureSize uMax uLight uPixelNorm uContourWidth uContourOpacity uLightIntensity uOpacity uSaturation uLightness uMaskTexture uViewport uElevationOffset uLabelShadowColor uLabelShadowSize".split(" ")}),e,f=a.da();this.a=function(a){e=a};this.b=function(a,k,l,g,p){var h=a.T();a.ba();d.use(function(){c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);
d.c("uContourWidth",h.rb()*b.v());d.c("uElevationOffset",h.Ua());d.c("uLightness",h.Mb());d.c("uSaturation",h.bc());d.c("uContourOpacity",h.qb());d.c("uLightIntensity",h.Lb());d.c("uOpacity",h.Ja());d.gd(Math.cos(h.Wa())*Math.cos(h.Ha()),Math.sin(h.Wa())*Math.cos(h.Ha()),Math.sin(h.Ha()));d.g("aVertexPosition",f);d.m("fbTextureBuffer",k,0);d.m("uBandsTexture",a.sc(),1);d.m("uBandLevelsTexture",a.tc(),2);p?d.m("uMaskTexture",p,3):d.m("uMaskTexture",a.S().Sa(),3);d.c("uMax",l);d.o("uViewportSize",e.ua()*
e.Ea()*e.Fa(),e.ta()*e.Ea()*e.Fa());d.o("uTextureSize",e.ua(),e.ta());d.c("uPixelNorm",2/(g*b.U()*b.v()));d.o("uViewport",b.U()*b.v(),b.Z()*b.v());d.D(["aVertexPosition"]);d.X(f.h())})};this.release=function(){f.release()}};function ib(a,b,c,d,e,f){if(!(e-d<=c)){var h=Math.floor((d+e)/2);jb(a,b,h,d,e,f%2);ib(a,b,c,d,h-1,f+1);ib(a,b,c,h+1,e,f+1)}}
function jb(a,b,c,d,e,f){for(;e>d;){if(600<e-d){var h=e-d+1,k=c-d+1,l=Math.log(h),g=.5*Math.exp(2*l/3);l=.5*Math.sqrt(l*g*(h-g)/h)*(0>k-h/2?-1:1);jb(a,b,c,Math.max(d,Math.floor(c-k*g/h+l)),Math.min(e,Math.floor(c+(h-k)*g/h+l)),f)}h=b[2*c+f];k=d;g=e;kb(a,b,d,c);for(b[2*e+f]>h&&kb(a,b,d,e);k<g;){kb(a,b,k,g);k++;for(g--;b[2*k+f]<h;)k++;for(;b[2*g+f]>h;)g--}b[2*d+f]===h?kb(a,b,d,g):(g++,kb(a,b,g,e));g<=c&&(d=g+1);c<=g&&(e=g-1)}}function kb(a,b,c,d){lb(a,c,d);lb(b,2*c,2*d);lb(b,2*c+1,2*d+1)}
function lb(a,b,c){var d=a[b];a[b]=a[c];a[c]=d};function La(a,b,c,d,e,f){for(var h=[0,a.length-1,0],k=[],l=e*e;h.length;){var g=h.pop(),p=h.pop(),m=h.pop();if(p-m<=f)for(g=m;g<=p;g++){m=b[2*g]-c;var n=b[2*g+1]-d;m*m+n*n<=l&&k.push(a[g])}else{n=Math.floor((m+p)/2);var q=b[2*n],r=b[2*n+1],t=q-c,w=r-d;t*t+w*w<=l&&k.push(a[n]);t=(g+1)%2;if(0===g?c-e<=q:d-e<=r)h.push(m),h.push(n-1),h.push(t);if(0===g?c+e>=q:d+e>=r)h.push(n+1),h.push(p),h.push(t)}}return k};function mb(a){var b=b||nb;var c=c||ob;var d=d||Array;this.cb=64;this.a=a;this.sa=new d(a.length);this.coords=new d(2*a.length);for(d=0;d<a.length;d++)this.sa[d]=d,this.coords[2*d]=b(a[d]),this.coords[2*d+1]=c(a[d]);ib(this.sa,this.coords,64,0,this.sa.length-1,0)}mb.prototype={};function nb(a){return a[0]}function ob(a){return a[1]};function pb(a,b,c,d,e,f,h,k){function l(c,f){c=La(b.sa,b.coords,c,f,p,b.cb);if(c.length>=m){f=Math.min(1,50/c.length);for(var k=0;k<c.length;k++){var h=c[k];if(!n.has(h)){var l=a[h];qa(l.x,l.y,d,e)<g&&((1===f||Math.random()<=f)&&r.push(h),q.push(h),n.add(h))}}}return!1}c=Math.min(c.u,c.B);var g=Math.pow(c*k,2),p=c*f*Math.sqrt(1/a.length);f=La(b.sa,b.coords,d,e,p,b.cb).length;var m=Math.min(1,f)*h,n=new Set,q=[],r=[];for(l(d,e);0<r.length;)h=r.pop(),l(a[h].x,a[h].y);return q.map(function(b){return a[b]})}
;function Y(a){function b(a){return x=a}function c(a){v=a;n.N(Ya)}function d(a){z=a;n.N(Xa)}function e(a){u=a;n.N(Wa)}function f(a){a=Object.assign({radius:.4,density:0,maxClusterRadius:.1},a);var b=a.startX,c=a.startY;if(void 0===b||void 0===c)throw"Start coordinates are required";return Promise.resolve(pb(q,m.Za(),k(),b,c,a.radius,a.density,a.maxClusterRadius))}function h(a){a=Object.assign({radiusDivider:20,sortByDistance:!1},a);var b=a.startX,c=a.startY;if(void 0===b||void 0===c)throw"Start coordinates are required";
var d=k();a=Ka(b,c,Math.min(d.u,d.B)/a.radiusDivider,q,m.Za(),a.sortByDistance);return Promise.resolve(a.map(function(a){return q[a]}))}function k(){void 0===t&&(t=Ca().ib(q).mb());return t}function l(a){return y=a}function g(a){return w=a}function p(a){var b=m.f();m.Ma(a);if(b&&(b=b.get(a))){n.N(b);return}"xy"===a&&n.N(S)}var m=this,n=new P;this.wa=n.a;this.a=n.N;this.f=function(){};this.Y=function(){};this.Ma=function(){};var q,r,t;this.K=function(){return q};this.b=function(a){a?q=a.slice(0):q=
[];r=void 0;n.N(Q)};this.ab=function(){m.b(a.points)};var w=!0;this.bb=function(){return w};var y=1;this.Ja=function(){return y};this.Za=function(){void 0===r&&(r=new mb(q.map(function(a){return[a.x,a.y]})));return r};this.W=function(a){return Object.assign(a,{points:{get:m.K,set:m.b},visible:{get:m.bb,set:g},opacity:{get:m.Ja,set:l},pointHoverRadiusMultiplier:{get:m.ac,set:b}})};this.O=function(a){return Object.assign(a,{update:p,cluster:f,within:h})};var u=void 0;this.Ec=function(){return u};var z=
void 0;this.Cc=function(){return z};var v=void 0;this.Dc=function(){return v};var x=2;this.ac=function(){return x};this.Ka=function(a){return a.v()*Math.min(Math.sqrt(a.La()),4)};this.i=function(a){return Object.assign(a,{onPointHover:e,onPointClick:d,onPointHold:c})};this.s=function(a){return Object.assign(a,{type:{get:m.Y}})}};function qb(a){function b(){e=void 0;c.a(Ra)}var c=this;Y.call(this,a);this.xa=function(){return v};this.Y=function(){return"elevation"};var d=new Map;d.set("elevation",Q);this.f=function(){return d};var e,f=this.b;this.b=function(a){f.call(c,a);e=void 0};var h;this.cd=function(a){h=a};var k=.5;this.sb=function(){return k};var l=20;this.Ub=function(){return l};var g=Number.MAX_SAFE_INTEGER;this.Tb=function(){return g};var p=0;this.Ua=function(){return p};var m=.9;this.rb=function(){return m};var n=
.2;this.qb=function(){return n};var q=0;this.Mb=function(){return q};var r=0;this.bc=function(){return r};var t=2*Math.PI-Math.PI/2-Math.PI/4;this.Wa=function(){return t};var w=Math.PI-Math.PI/8;this.Ha=function(){return w};var y=.15;this.Lb=function(){return y};var u=[{end:3E-4,color:[141,193,234],shading:!1,contours:!1},{end:.005,color:[161,210,247],shading:!1,contours:!1},{end:.02,color:[185,227,255],shading:!1,contours:!0},{end:.05,color:[172,208,165],shading:!0,contours:!0},{end:.1,color:[148,
191,139],shading:!0,contours:!0},{end:.15,color:[168,198,143],shading:!0,contours:!0},{end:.2,color:[189,204,150],shading:!0,contours:!0},{end:.3,color:[209,215,171],shading:!0,contours:!0},{end:.4,color:[239,235,192],shading:!0,contours:!0},{end:.5,color:[222,214,163],shading:!0,contours:!0},{end:.6,color:[211,202,157],shading:!0,contours:!0},{end:.7,color:[202,185,130],shading:!0,contours:!0},{end:.8,color:[192,154,83],shading:!0,contours:!0},{end:.85,color:[224,224,224],shading:!0,contours:!0},
{end:.9,color:[236,236,236],shading:!0,contours:!0},{end:1,color:[255,255,255],shading:!0,contours:!0}];this.Ta=function(){return u};var z=void 0;this.Ia=function(){return e};this.dd=function(a){e=a;z&&z(a)};var v=ka(this,a,{options:this.W({elevationPow:{get:this.sb,set:function(a){b();return k=a}},maxRadiusDivider:{get:this.Ub,set:function(a){b();return l=a}},maxElevationPoints:{get:this.Tb,set:function(a){b();return g=a}},elevationOffset:{get:this.Ua,set:function(a){return p=a}},lightness:{get:this.Mb,
set:function(a){return q=a}},saturation:{get:this.bc,set:function(a){return r=a}},contourOpacity:{get:this.qb,set:function(a){return n=a}},contourWidth:{get:this.rb,set:function(a){return m=a}},lightAzimuth:{get:this.Wa,set:function(a){return t=a}},lightAltitude:{get:this.Ha,set:function(a){return w=a}},lightIntensity:{get:this.Lb,set:function(a){return y=a}},colorBands:{get:this.Ta,set:function(a){u=a;c.a(Za)}}}),getters:this.s({maxElevation:{get:this.Ia},elevationAt:{get:function(a,b){return h&&
h(a,b)}}}),events:this.i({onMaxElevationChanged:function(a){return z=a}}),methods:this.O({})})}qb.prototype=Object.create(Y.prototype);function rb(a,b,c,d){var e=2*c,f,h,k,l;(function(){var g=Math.ceil(c*a/e),p=Math.ceil(c*b/e);f=g+8;h=p+8;k=g/d;l=p/d})();this.Fa=function(){return d};this.Ea=function(){return e};this.ua=function(){return f};this.ta=function(){return h};this.width=function(){return k};this.height=function(){return l};this.margin=function(){return 8}};function sb(a,b,c,d,e){c=c||0;d=d||a.length-1;for(e=e||tb;d>c;){if(600<d-c){var f=d-c+1,h=b-c+1,k=Math.log(f),l=.5*Math.exp(2*k/3);k=.5*Math.sqrt(k*l*(f-l)/f)*(0>h-f/2?-1:1);sb(a,b,Math.max(c,Math.floor(b-h*l/f+k)),Math.min(d,Math.floor(b+(f-h)*l/f+k)),e)}f=a[b];h=c;l=d;ub(a,c,b);for(0<e(a[d],f)&&ub(a,c,d);h<l;){ub(a,h,l);h++;for(l--;0>e(a[h],f);)h++;for(;0<e(a[l],f);)l--}0===e(a[c],f)?ub(a,c,l):(l++,ub(a,l,d));l<=b&&(c=l+1);b<=l&&(d=l-1)}}function ub(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}
function tb(a,b){return a<b?-1:a>b?1:0};function vb(a,b){if(!(this instanceof vb))return new vb(a,b);this.b=Math.max(4,a||9);this.s=Math.max(2,Math.ceil(.4*this.b));b&&(a=["return a"," - b",";"],this.f=new Function("a","b",a.join(b[0])),this.i=new Function("a","b",a.join(b[1])),this.a=new Function("a","return {minX: a"+b[0]+", minY: a"+b[1]+", maxX: a"+b[2]+", maxY: a"+b[3]+"};"));this.clear()}
function wb(a,b,c,d,e){var f=d-c+1,h=a.b;if(f<=h){var k=xb(b.slice(c,d+1));yb(k,a.a);return k}e||(e=Math.ceil(Math.log(f)/Math.log(h)),h=Math.ceil(f/Math.pow(h,e-1)));k=xb([]);k.P=!1;k.height=e;f=Math.ceil(f/h);h=f*Math.ceil(Math.sqrt(h));var l;for(zb(b,c,d,h,a.f);c<=d;c+=h){var g=Math.min(c+h-1,d);zb(b,c,g,f,a.i);for(l=c;l<=g;l+=f){var p=Math.min(l+f-1,g);k.children.push(wb(a,b,l,p,e-1))}}yb(k,a.a);return k}function Ab(a,b,c){a.data=xb([b,c]);a.data.height=b.height+1;a.data.P=!1;yb(a.data,a.a)}
function Bb(a,b,c,d){var e=a.a.bind(a);d=d?b:e(b);e=[];for(var f,h=a.data,k=c,l,g,p,m,n,q,r;;){e.push(h);if(h.P||e.length-1===k)break;q=r=Infinity;l=0;for(g=h.children.length;l<g;l++)p=h.children[l],m=Cb(p),n=(Math.max(p.F,d.F)-Math.min(p.w,d.w))*(Math.max(p.G,d.G)-Math.min(p.A,d.A))-m,n<r?(r=n,q=m<q?m:q,f=p):n===r&&m<q&&(q=m,f=p);h=f||h.children[0]}f=h;f.children.push(b);for(Db(f,d);0<=c;)if(e[c].children.length>a.b){b=a;f=e;h=c;k=f[h];l=k.children.length;n=b.s;q=b;g=k;r=n;var t=l;p=g.P?q.f:Eb;var w=
g.P?q.i:Fb;m=Gb(q,g,r,t,p);q=Gb(q,g,r,t,w);m<q&&g.children.sort(p);g=void 0;p=b;m=k;w=l;q=l=Infinity;for(t=n;t<=w-n;t++){var y=Hb(m,0,t,p.a,void 0);var u=Hb(m,t,w,p.a,void 0);r=Math.max(0,Math.min(y.F,u.F)-Math.max(y.w,u.w))*Math.max(0,Math.min(y.G,u.G)-Math.max(y.A,u.A));u=Cb(y)+Cb(u);r<q?(q=r,g=t,l=u<l?u:l):r===q&&u<l&&(l=u,g=t)}l=g;l=xb(k.children.splice(l,k.children.length-l));l.height=k.height;l.P=k.P;yb(k,b.a);yb(l,b.a);h?f[h-1].children.push(l):Ab(b,k,l);c--}else break;for(a=c;0<=a;a--)Db(e[a],
d)}function Gb(a,b,c,d,e){b.children.sort(e);a=a.a.bind(a);e=Hb(b,0,c,a,void 0);var f=Hb(b,d-c,d,a,void 0),h=Ib(e)+Ib(f),k;for(k=c;k<d-c;k++){var l=b.children[k];Db(e,b.P?a(l):l);h+=Ib(e)}for(k=d-c-1;k>=c;k--)l=b.children[k],Db(f,b.P?a(l):l),h+=Ib(f);return h}
vb.prototype={search:function(a){var b=this.data,c=[],d=this.a.bind(this);if(!Jb(a,b))return c;for(var e=[],f,h,k,l;b;){f=0;for(h=b.children.length;f<h;f++)if(k=b.children[f],l=b.P?d(k):k,Jb(a,l))if(b.P)c.push(k);else if(a.w<=l.w&&a.A<=l.A&&l.F<=a.F&&l.G<=a.G){l=c;for(var g=[];k;)k.P?l.push.apply(l,k.children):g.push.apply(g,k.children),k=g.pop()}else e.push(k);b=e.pop()}return c},load:function(a){if(!a||!a.length)return this;if(a.length<this.s){for(var b=0,c=a.length;b<c;b++){var d=a[b];d&&Bb(this,
d,this.data.height-1,!1)}return this}a=wb(this,a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?Ab(this,this.data,a):(this.data.height<a.height&&(b=this.data,this.data=a,a=b),Bb(this,a,this.data.height-a.height-1,!0)):this.data=a;return this},clear:function(){this.data=xb([]);return this},a:function(a){return a},f:Eb,i:Fb,toJSON:function(){return this.data}};function yb(a,b){Hb(a,0,a.children.length,b,a)}
function Hb(a,b,c,d,e){e||(e=xb(null));e.w=Infinity;e.A=Infinity;e.F=-Infinity;e.G=-Infinity;for(var f;b<c;b++)f=a.children[b],Db(e,a.P?d(f):f);return e}function Db(a,b){a.w=Math.min(a.w,b.w);a.A=Math.min(a.A,b.A);a.F=Math.max(a.F,b.F);a.G=Math.max(a.G,b.G)}function Eb(a,b){return a.w-b.w}function Fb(a,b){return a.A-b.A}function Cb(a){return(a.F-a.w)*(a.G-a.A)}function Ib(a){return a.F-a.w+(a.G-a.A)}function Jb(a,b){return b.w<=a.F&&b.A<=a.G&&b.F>=a.w&&b.G>=a.A}
function xb(a){return{children:a,height:1,P:!0,w:Infinity,A:Infinity,F:-Infinity,G:-Infinity}}function zb(a,b,c,d,e){for(var f=[b,c],h;f.length;)c=f.pop(),b=f.pop(),c-b<=d||(h=b+Math.ceil((c-b)/d/2)*d,sb(a,h,b,c,e),f.push(b,h,h,c))};function Kb(a,b){if(256>a)return new Uint8Array(b);if(65536>a)return new Uint16Array(b);if(a<1<<32)return new Uint32Array(b);throw"Max value of "+a+" too large for typed arrays.";}function Lb(a,b){if(a.fill)a.fill.call(a,b);else for(var c=0;c<a.length;c++)a[c]=b}function Mb(a,b){if(a.reduce)return a.reduce.call(a,b,0);for(var c=0,d=0;d<a.length;d++)c=b(c,a[d],d,a);return c};function Nb(){var a=[.5,0,1,.5,2,1,6,1,8,0];this.a=function(b){for(var c=0;c<a.length&&a[c]<b;)c+=2;if(0===c)return a[1];if(c>=a.length)return a[a.length-1];var d=a[c-1],e=a[c-2];return d+(b-e)/(a[c]-e)*(a[c+1]-d)}};function Ob(a,b){function c(a,b,c){var e=d(c[a]);for(a+=1;a<b;a++)e+=d(" "),e+=d(c[a]);return e}function d(a){var c=b["#"+a];if(!c)throw"Unknown width of '"+a+"'";return c}var e=new Nb;this.a=function(b,d){function f(d){for(var f=d.length,g=0,k=0,h=0,l=0;l<f;l++){var n=c(h,d[l],b);k+=n;h=d[l];n>g&&(g=n)}d=e.a(g/((f-1)*a*1.05+a));return 0===d?0:d*(1-(f*g-k)/(f*g))}if(1===b.length)d(b,[1]);else{if(6<b.length)throw"Algorithm not suitable for labels with more than 6 words";for(var h=1<<b.length-1,g=[b.length],
p=f(g),m=1;m<h;m++){for(var n=m,q=1,r=[],t=0;t<b.length-1;t++)0!==(n&1)&&r.push(q),n>>=1,q++;r.push(q);n=f(r);p<n&&(p=n,g=r)}d(b,g)}};this.b=function(b,e,k){for(var f=e.length,g=(1.05-1)*a,h=-(1.05*a*f-g)/2,m=0,n=0;n<f;n++){for(var q=e[n],r=-(c(m,q,b)/2);m<q;m++){var t=d(b[m]);k(r,h,r+t,h+a,b[m]);r+=t;r+=d(" ")}m=q;h+=a+g}}};function Pb(){function a(){c.font=k+" "+h+" "+f+" "+e+"px "+d}var b=document.createElement("canvas");b.width=0;b.height=0;var c=b.getContext("2d"),d="sans-serif",e=16,f="normal",h="normal",k="normal";this.a=function(a){return Math.ceil(c.measureText(a).width)};this.b=function(b){d=b;a()};this.f=function(b){e=b;a()};this.O=function(b){f=b;a()};this.s=function(b){h=b;a()};this.i=function(b){k=b;a()}};function Qb(a){var b=a.filter(function(a){return 0<=a[0]}).sort(function(a,b){return a[1]-b[1]}),c=Kb(b.length+1,a.length);for(a=0;a<b.length;a++)c[b[a][2]]=a+1;this.lb=function(a){a=c[a];if(0!==a)return b[a-1]};this.lc=function(){return b}}
function Rb(a,b,c,d,e){b=b.map(function(a,b){return[-1,-1,b]});e=Math.floor(e/a);var f=new Int16Array(e);Lb(f,d);for(var h=0,k=0,l=0;h<b.length;){for(var g=b[h],p=c[h]+4,m=void 0,n=0;n<=l;n++)if(f[n]>=p){m=n;break}void 0===m&&l+1<e&&(l++,f[l]>=p&&(m=l));void 0!==m&&(g[0]=d-f[m],g[1]=m*a,f[m]-=p+4,k++);h++}a=Mb(f,function(a,b){return a+b});self.console.debug("Label canvas usage:",(100*(1-a/(e*d))).toFixed(2)+"%");return new Qb(b)};var Sb=new function(){this.a=[0,0,0,255];this.b=[242,217,166,127]};function Tb(a){function b(){function a(a,c){var d=k[a].za;if(!n[d]){a=c.search(k[a]);c=b[d].labelPriority;if(0>=c)for(var e=0;e<a.length;e++){var f=a[e].za;if(f!==d&&b[f].labelPriority>c){n[d]=1;return}}for(c=0;c<a.length;c++)e=a[c].za,e!==d&&(n[e]=1)}}for(var b=f.K(),c=M,d=R.B/Ea,e=g,k=[],h=0;h<F.length;h++)k.push({w:0,F:0,A:0,G:0,za:F[h][3]});h=new Float32Array(b.length);Lb(h,Infinity);for(var l=b.length,n=new Uint8Array(b.length),m=1,p=Math.pow(2,.25);4096>=m&&0<l;){for(var q=d/m,t=.5*g*(1+(.25-
.2*Math.min(1,Math.log(m)*Math.LOG2E/4))),r=0;r<F.length;r++){var z=F[r],G=b[z[3]],v=k[r],A=c[z[2]];v.w=(z[0]-t)*q+G.x;v.A=(z[1]-t)*q+G.y;v.F=(z[0]+t+A)*q+G.x;v.G=(z[1]+t+e)*q+G.y}q=new vb;q.load(k);Lb(n,0);for(t=0;t<k.length;t++)Infinity!==h[k[t].za]&&a(t,q);for(t=0;t<k.length;t++)Infinity===h[k[t].za]&&a(t,q);for(q=0;q<n.length;q++)0===n[q]&&Infinity===h[q]&&(h[q]=m,l--);m*=p}return h}function c(){var a=f.K(),b=0,c=[],d=a.reduce(function(a,d){d=K(d.label.split(/\s+/));for(var e=d.next();!e.done;e=
d.next())e=e.value,a.has(e)||(c.push(e),a.set(e,b++));return a},new Map),e=c.map(function(a){return l.a(a)}),k=e.reduce(function(a,b,d){a["#"+c[d]]=b;return a},{"# ":l.a(" ")}),h=Rb(g,c,e,m,4*m),n=new Ob(g,k),p=[];a.forEach(function(a,b){n.a(a.label.split(/\s+/),function(a,c){a.reduce(function(a,b){return a&&void 0!==h.lb(d.get(b))},!0)&&n.b(a,c,function(a,c,e,f,g){p.push([a,c,d.get(g),b])})})});return{ld:c,kd:e,Oc:p,jd:h}}function d(a,b){return function(c){a(c);b(c)}}function e(a){return function(b){a(b);
h.set(X);h.set(T)}}var f=this;Y.call(this,a);var h=new Ma;this.xa=function(){return E};this.Y=function(){return"label"};var k=new Map;k.set("xy",T);k.set("labelOpacity",Ta);k.set("labelColor",Sa);k.set("labelBoxColor",Ua);k.set("labelBoxOpacity",Va);k.set("labelVisibilityScales",T);this.f=function(){return k};this.Ma=function(a){switch(a){case "xy":case "labelVisibilityScales":h.set(T)}};var l=new Pb,g=16;this.ga=function(){return g};var p=e(d(function(a){g=a;m=Math.floor(2048/g)*g},l.f)),m;p(g);
var n="sans-serif";this.Bb=function(){return n};var q=e(d(function(a){return n=a},l.b)),r="normal";this.Eb=function(){return r};var t=e(d(function(a){return r=a},l.O)),w="normal";this.Db=function(){return w};var y=e(d(function(a){return w=a},l.s)),u="normal";this.Cb=function(){return u};var z=e(d(function(a){return u=a},l.i)),v=Sb.a;this.Ab=function(){return v};var x=1;this.Fb=function(){return x};var A=Sb.b;this.vb=function(){return A};var G=0;this.wb=function(){return G};var J=[0,0,0,0];this.Ib=
function(){return J};var U=0;this.Jb=function(){return U};var C={labelVisible:!1},E=ka(this,a,{options:this.W({labelFontSize:{get:this.ga,set:p},labelFontFamily:{get:this.Bb,set:q},labelFontWeight:{get:this.Eb,set:t},labelFontVariant:{get:this.Db,set:y},labelFontStyle:{get:this.Cb,set:z},labelColor:{get:this.Ab,set:function(a){f.a(Sa);return v=a}},labelOpacity:{get:this.Fb,set:function(a){f.a(Ta);return x=a}},labelBoxColor:{get:this.vb,set:function(a){f.a(Ua);return A=a}},labelBoxOpacity:{get:this.wb,
set:function(a){f.a(Va);return G=a}},labelShadowColor:{get:this.Ib,set:function(a){return J=a}},labelShadowSize:{get:this.Jb,set:function(a){return U=a}}}),getters:this.s({}),events:this.i({}),methods:this.O({state:function(a){var b=za.La();a=V.has(a)?W[V.get(a)]<=b:!1;C.labelVisible=a;return C}})}),F,H,I,M,R,W,V,Ea;this.Lc=function(){return H};this.ja=function(){return F};this.cc=function(){return I};this.Kc=function(){return M};this.Jc=function(){return W};this.ra=function(){return g};this.qa=function(){return m};
this.ka=function(){return m};this.M=function(a,b){return Ea=b};this.na=function(a){return R=a};this.Va=function(){return R.B/Ea};var $b=this.b;this.b=function(a){$b.call(f,a.slice(0).sort(function(a,b){return(b.labelPriority||0)-(a.labelPriority||0)}));V=f.K().reduce(function(a,b,c){a.set(b,c);return a},new Map)};var za;this.Aa=function(a){za=a;a.ia(f);a.Pa(f);f.M(a.U(),a.Z());f.na(a.Ga())};this.nb=function(){za.gc(f);za.ad(f)};this.update=function(){h.a(Q)&&(h.set(X),h.set(T));if(h.a(X)){var a=c();
H=a.ld;F=a.Oc;M=a.kd;I=a.jd;f.a(X)}h.a(T)&&(W=b(),f.a(T))}}Tb.prototype=Object.create(Y.prototype);function Ub(a){function b(b,c,e,f,m,n,q,r){q=void 0===q?1:q;r=void 0===r?1:r;d.disable(d.BLEND);a.Oa(m,n,function(){for(var d={ha:0};d.ha<q;d={ha:d.ha},d.ha++)f.capture(function(d){return function(){a.ca();b.use(function(){b.g("aVertexPosition",h);b.m("uInput",0===d.ha?c:e,0);b.o("uResolution",m,n);b.o("direction",r*(q-d.ha),0);b.D(["aVertexPosition"]);b.X(h.h())})}}(d)),e.capture(function(c){return function(){a.ca();b.use(function(){b.g("aVertexPosition",h);b.m("uInput",f,0);b.o("uResolution",m,
n);b.o("direction",0,r*(q-c.ha));b.D(["aVertexPosition"]);b.X(h.h())})}}(d))})}function c(b){return a.createProgram({name:"blur",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",J:"\n      precision mediump float;\n\n      uniform vec2 uResolution;\n      uniform sampler2D uInput;\n      uniform vec2 direction;\n\n      "+b+"      \n      \n      void main() {\n        vec2 uv = vec2(gl_FragCoord.xy / uResolution.xy);\n        gl_FragColor = blur(uInput, uv, uResolution.xy, direction);\n      }\n    ",
C:["aVertexPosition"],H:["uInput","uResolution","direction"]})}var d=a.V,e=c("\n    vec4 blur(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n      vec4 color = vec4(0.0);\n      vec2 off1 = vec2(1.3333333333333333) * direction;\n      color += texture2D(image, uv) * 0.29411764705882354;\n      color += texture2D(image, uv + (off1 / resolution)) * 0.35294117647058826;\n      color += texture2D(image, uv - (off1 / resolution)) * 0.35294117647058826;\n      return color; \n    }"),f=c("\n    vec4 blur(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n      vec4 color = vec4(0.0);\n      vec2 off1 = vec2(1.411764705882353) * direction;\n      vec2 off2 = vec2(3.2941176470588234) * direction;\n      vec2 off3 = vec2(5.176470588235294) * direction;\n      color += texture2D(image, uv) * 0.1964825501511404;\n      color += texture2D(image, uv + (off1 / resolution)) * 0.2969069646728344;\n      color += texture2D(image, uv - (off1 / resolution)) * 0.2969069646728344;\n      color += texture2D(image, uv + (off2 / resolution)) * 0.09447039785044732;\n      color += texture2D(image, uv - (off2 / resolution)) * 0.09447039785044732;\n      color += texture2D(image, uv + (off3 / resolution)) * 0.010381362401148057;\n      color += texture2D(image, uv - (off3 / resolution)) * 0.010381362401148057;\n      return color; \n    }"),
h=a.da();this.b=function(a,c,d,f,h,n){b(e,a,c,d,f,h,1,void 0===n?1:n)};this.a=function(a,c,d,e,h,n){b(f,a,c,d,e,h,1,void 0===n?1:n)}};function Vb(a){var b=a.createProgram({name:"fullscreen",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",J:"\n      precision mediump float;\n\n      uniform float uStrength;\n      uniform vec2 uResolution;\n      uniform vec2 uBlurredSize;\n      uniform sampler2D uInput;\n      uniform sampler2D uBlurred;\n      \n      \n  vec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w) * (1.0/6.0);\n  }\n  \n  vec4 textureBicubic(sampler2D sampler, vec2 texSize, vec2 texCoords) {\n    vec2 invTexSize = 1.0 / texSize;\n     \n    texCoords = texCoords * texSize - 0.5;\n     \n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2(-0.5, +1.5).xyxy;\n    \n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4(xcubic.yw, ycubic.yw) / s;\n    \n    offset *= invTexSize.xxyy;\n    \n    vec4 sample0 = texture2D(sampler, offset.xz);\n    vec4 sample1 = texture2D(sampler, offset.yz);\n    vec4 sample2 = texture2D(sampler, offset.xw);\n    vec4 sample3 = texture2D(sampler, offset.yw);\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(mix(sample3, sample2, sx), mix(sample1, sample0, sx) , sy);\n  }\n\n\n      void main() {\n        vec2 uv = vec2(gl_FragCoord.xy / uResolution.xy);\n        vec4 b = textureBicubic(uBlurred, uBlurredSize, uv);\n        vec4 i = texture2D(uInput, uv);\n        \n        gl_FragColor = mix(vec4(1.0 - b.rgb, b.a), vec4(1.0 - i.rgb, i.a), \n          1.0 + uStrength * i.a / (0.01 + i.r + i.g + i.b));\n      }\n    ",
C:["aVertexPosition"],H:"uInput uBlurred uStrength uResolution uBlurredSize direction".split(" ")}),c=a.da();this.M=function(){};this.pa=function(a,e,f){b.use(function(){b.g("aVertexPosition",c);b.m("uInput",a,0);b.m("uBlurred",e,1);b.o("uBlurredSize",e.$a(),e.ya());b.o("uResolution",a.$a(),a.ya());b.c("uStrength",f);b.D(["aVertexPosition"]);b.X(c.h())})}};function Wb(a,b){var c=a.V;b.ia(this);var d=a.createProgram({name:"labelBoxes",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n      attribute vec3 aLabelPointData;\n      attribute vec3 aLabelBoxPositionData;\n      attribute float aLabelOpacity;\n      attribute vec4 aLabelBoxColor;\n      attribute float aLabelBoxOpacity;\n  \n      varying vec2 unitBoxCoord;\n      varying float boxWidth;\n      varying float visibilityScale;\n      varying float labelOpacity;\n      varying vec4 labelBoxColor;\n      varying float labelBoxOpacity;\n  \n      uniform mat3 uMvMatrix;\n      uniform float uScale;\n      uniform float uBoxScale;\n      uniform float uFontSize;\n      uniform float uBoxPadding;\n      \n      // The comment is to make IntelliJ parser happy\n      //\n    vec4 getGlPosition(vec2 unitBoxWithPadding, vec3 aLabelBoxPositionData, float uFontSize, mat3 uMvMatrix) {\n      // Scale to match the actual aspect ratio of the word    \n      vec2 boxAtOrigin = unitBoxWithPadding * vec2(aLabelBoxPositionData.z, uFontSize);\n      \n      // Position the word within the label and position in the point space\n      vec2 scaled = (boxAtOrigin + aLabelBoxPositionData.xy) * uBoxScale / uScale + aLabelPointData.xy;      \n      \n      // Transform through view matrix\n      vec3 transformed = uMvMatrix * vec3(scaled, 1.0);\n    \n      // We add the extra uScale for the label fade/in out animation \n      return vec4(\n        transformed.xy, \n        (\n          // scale-based visibility\n          2.0 * (step(uScale + uScale - aLabelPointData.z, 0.0)) +\n          \n          // per-label visibility, hide if label opacity == 0   \n          2.0 * step(aLabelOpacity, 0.0) +\n          \n          // Sort by visibility scale for the depth buffer fallback\n          smoothstep(-1.0, 1.0, log2(aLabelPointData.z) - log2(uScale * 2.0))                     \n        ),    \n        1.0\n      );\n    }\n  \n  \n      void main(void) {\n        // Transform the (0.0, 1.0) square to the origin-relative word box. We'll also apply some padding to the box.\n        // We want the padding to be equal along x and y, and because the only way to apply padding is to scale\n        // the box around origin, to keep the x/y paddings equal, we'll need separate scales on x and y axes. \n        // We also apply two corrective factors to: 1) render descenders partially on the padding (looks better) --\n        // this is done by shifting the scaling center slightly above the origin (the 0.67 instead of 0.5), \n        // 2) making the vertical padding smaller, the 0.7 factor.\n        vec2 unitBoxWithPadding = \n          (aVertexPosition - vec2(0.5, 0.67)) // make the square origin-relative\n            * vec2(1.0 + uBoxPadding * uFontSize / aLabelBoxPositionData.z, 1.0 + uBoxPadding * 0.7) // scale to add padding \n            + vec2(0.5, 0.67); // transform the box back to start at (0, 0) \n            \n        gl_Position = getGlPosition(unitBoxWithPadding, aLabelBoxPositionData, uFontSize, uMvMatrix);\n        \n        \n        unitBoxCoord = aVertexPosition;\n        boxWidth = aLabelBoxPositionData.z;\n        visibilityScale = aLabelPointData.z;\n        labelOpacity = aLabelOpacity;\n        labelBoxOpacity = aLabelBoxOpacity;\n        labelBoxColor = aLabelBoxColor;\n      }\n    ",
J:"\n      precision mediump float;\n      uniform float uScale;\n      uniform float uLabelOpacity;\n      uniform float uFontSize;\n      \n      varying float visibilityScale;\n      varying vec2 unitBoxCoord;\n      varying float boxWidth;\n      varying float labelOpacity;\n      varying vec4 labelBoxColor;\n      varying float labelBoxOpacity;\n      \n      float udRoundBox(vec2 p, vec2 b, float r) {\n        return length(max(abs(p) - b + r, 0.0)) - r;\n      }\n      \n      void main(void) {\n        float alpha = smoothstep(-1.0, 0.0, 4.0 * (log2(uScale) - log2(visibilityScale)));\n      \n        // Distance field based rounded box\n        vec2 boxInScreenCoordinates = vec2(boxWidth, uFontSize);\n        float b = smoothstep(0.0, 1.0, udRoundBox(boxInScreenCoordinates * (unitBoxCoord * 2.0 - 1.0), 1.0 * boxInScreenCoordinates, 7.0));\n        \n        gl_FragColor = vec4(\n          1.0 - labelBoxColor.rgb,\n          labelBoxOpacity * labelOpacity * labelBoxColor.a * (1.0 - b)\n        ) * alpha;\n      }\n    ",
C:"aVertexPosition aLabelPointData aLabelBoxPositionData aLabelOpacity aLabelBoxColor aLabelBoxOpacity".split(" "),H:["uMvMatrix","uScale","uBoxScale","uFontSize","uBoxPadding"]}),e=a.createProgram({name:"labels",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n      attribute vec3 aLabelPointData;\n      attribute vec3 aLabelBoxSpriteData;\n      attribute vec3 aLabelBoxPositionData;\n      attribute float aLabelOpacity;\n      attribute vec4 aLabelColor;\n  \n      varying vec3 labelBox;\n      varying vec2 boxCoord;\n      varying float visibilityScale;\n      varying vec4 labelColor;\n      varying float labelOpacity;\n  \n      uniform mat3 uMvMatrix;\n      uniform float uScale;\n      uniform float uBoxScale;\n      uniform float uFontSize;\n  \n      // The comment is to make IntelliJ parser happy\n      //\n    vec4 getGlPosition(vec2 unitBoxWithPadding, vec3 aLabelBoxPositionData, float uFontSize, mat3 uMvMatrix) {\n      // Scale to match the actual aspect ratio of the word    \n      vec2 boxAtOrigin = unitBoxWithPadding * vec2(aLabelBoxPositionData.z, uFontSize);\n      \n      // Position the word within the label and position in the point space\n      vec2 scaled = (boxAtOrigin + aLabelBoxPositionData.xy) * uBoxScale / uScale + aLabelPointData.xy;      \n      \n      // Transform through view matrix\n      vec3 transformed = uMvMatrix * vec3(scaled, 1.0);\n    \n      // We add the extra uScale for the label fade/in out animation \n      return vec4(\n        transformed.xy, \n        (\n          // scale-based visibility\n          2.0 * (step(uScale + uScale - aLabelPointData.z, 0.0)) +\n          \n          // per-label visibility, hide if label opacity == 0   \n          2.0 * step(aLabelOpacity, 0.0) +\n          \n          // Sort by visibility scale for the depth buffer fallback\n          smoothstep(-1.0, 1.0, log2(aLabelPointData.z) - log2(uScale * 2.0))                     \n        ),    \n        1.0\n      );\n    }\n  \n\n      void main(void) {\n        // Scale to match the actual aspect ratio of the word    \n        vec2 boxAtOrigin = aVertexPosition * vec2(aLabelBoxPositionData.z, uFontSize);\n        \n        gl_Position = getGlPosition(aVertexPosition, aLabelBoxPositionData, uFontSize, uMvMatrix);\n\n        labelBox = aLabelBoxSpriteData;\n        boxCoord = boxAtOrigin;\n        visibilityScale = aLabelPointData.z;\n        labelColor = aLabelColor;\n        labelOpacity = aLabelOpacity;\n      }\n    ",
J:"\n      precision mediump float;\n      uniform sampler2D uLabelSprites;\n      uniform float uScale;\n      uniform vec2 uTextureResolution;\n      \n      varying vec2 boxCoord;\n      varying vec3 labelBox;\n      varying float visibilityScale;\n      varying vec4 labelColor;\n      varying float labelOpacity;\n      \n      void main(void) {\n        vec4 pixel = texture2D(uLabelSprites, (2.0 * (labelBox.xy + boxCoord.xy) + 1.0) / (2.0 * uTextureResolution));\n        \n        // To avoid branching and thread divergence, we build a mask vector where the channel's corresponding\n        // value is 1.0 only if chanel number is 1.0, 2.0, 3.0 or 4.0, respectively.\n        float channel = floor(labelBox.z + 1.0);\n        vec4 mask = vec4(\n          step(1.0, channel) * step(-1.0, -channel),        \n          step(2.0, channel) * step(-2.0, -channel),        \n          step(3.0, channel) * step(-3.0, -channel),       \n          step(4.0, channel) * step(-4.0, -channel)       \n        );\n        \n        // Select the right channel.\n        float p = dot(pixel, mask);\n        \n        gl_FragColor = vec4(\n          labelColor.rgb,\n          \n          // Fade in/out labels set to show at just a little above the current zoome scale\n          labelOpacity * p * labelColor.a * smoothstep(-1.0, 0.0, 4.0 * (log2(uScale) - log2(visibilityScale)))\n        );\n      }\n    ",
C:"aVertexPosition aLabelPointData aLabelBoxSpriteData aLabelBoxPositionData aLabelOpacity aLabelColor".split(" "),H:"uMvMatrix uScale uLabelSprites uBoxScale uTextureResolution uFontSize".split(" ")}),f=a.createProgram({name:"drop-shadow",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",J:"\n      precision mediump float;\n      uniform sampler2D uMaskTexture;\n      uniform vec2 uViewport;\n      uniform vec4 uLabelShadowColor;\n      uniform float uLabelShadowSize;\n\n      void main(void) {\n        // Label mask\n        float mm = texture2D(uMaskTexture, gl_FragCoord.xy / uViewport).a;\n        float mask = min(1.0, mm * 8.0);\n\n        gl_FragColor = vec4(uLabelShadowColor.rgb, uLabelShadowColor.a * min(1.0, mm * uLabelShadowSize));\n      }\n    ",
C:["aVertexPosition"],H:["uMaskTexture","uViewport","uLabelShadowColor","uLabelShadowSize"]}),h=a.da(),k=c.getExtension("EXT_blend_minmax"),l=!!k,g=new Vb(a),p=new Ub(a),m=new eb(a);this.release=function(){h.release()};this.M=function(a,c){g.M(a*b.v(),c*b.v())};this.b=function(d,f,g){var h=d.T();h.update();d.ba();var k=d.Hb(),l=d.Nb(),n=d.S().ub(),m=d.S().Xa();if(0===k.h())return l.capture(function(){a.ca()}),l;var q=d.zb(),r=d.xb(),A=d.Gb(),G=d.yb(),J=d.Kb();n.capture(function(){a.ca();e.use(function(){e.c("uFontSize",
d.ra());e.o("uTextureResolution",d.qa(),d.ka());e.c("uBoxScale",h.Va()/b.v());e.g("aVertexPosition",q,c.BYTE);e.g("aLabelPointData",k,c.FLOAT,!1,0,0,!0);e.g("aLabelBoxSpriteData",G,c.SHORT,!1,0,0,!0);e.g("aLabelBoxPositionData",r,c.FLOAT,!1,0,0,!0);e.g("aLabelOpacity",A,c.UNSIGNED_BYTE,!0,0,0,!0);e.m("uLabelSprites",J,0);e.c("uScale",g);e.va(f);e.D(["aVertexPosition","aLabelPointData","aLabelBoxSpriteData","aLabelBoxPositionData","aLabelOpacity"]);e.Da(k.h(),q.h())})});var U=b.fa(),C=b.ea();l.capture(function(){c.clearColor(0,
0,0,0);c.clear(c.COLOR_BUFFER_BIT);n.pa(U,C)});p.b(l,l,m,U,C,Math.min(1,b.v()/2));return l};this.a=function(n,p,r){var q=n.T();q.update();n.ba();var w=n.Hb();if(0!==w.h()){var y=n.zb(),u=n.xb(),z=n.Gb(),v=n.vc(),x=n.wc(),A=n.yb(),G=n.xc(),J=n.S().ub(),U=n.Kb(),C=n.Nb();C&&f.use(function(){f.m("uMaskTexture",C,0);f.o("uViewport",b.ma(),b.la());f.gb("uLabelShadowColor",q.Ib());f.c("uLabelShadowSize",q.Jb());f.g("aVertexPosition",h);f.D(["aVertexPosition"]);f.X(h.h())});if(n.Mc()){J.capture(function(){a.ca();
d.use(function(){d.c("uFontSize",n.ra());d.c("uBoxPadding",.5);d.c("uBoxScale",q.Va()/b.v());d.g("aVertexPosition",y,c.BYTE);d.g("aLabelPointData",w,c.FLOAT,!1,0,0,!0);d.g("aLabelBoxPositionData",u,c.FLOAT,!1,0,0,!0);d.g("aLabelOpacity",z,c.UNSIGNED_BYTE,!0,0,0,!0);d.g("aLabelBoxColor",v,c.UNSIGNED_BYTE,!0,0,0,!0);d.g("aLabelBoxOpacity",x,c.UNSIGNED_BYTE,!0,0,0,!0);d.c("uScale",r);d.va(p);d.D("aVertexPosition aLabelPointData aLabelBoxPositionData aLabelOpacity aLabelBoxColor aLabelBoxOpacity".split(" "));
l?(c.enable(c.BLEND),c.blendFuncSeparate(c.ONE,c.ONE,c.ONE,c.ONE),c.blendEquation(k.MAX_EXT)):(c.enable(c.DEPTH_TEST),c.disable(c.BLEND));d.Da(w.h(),y.h())})});var E=n.S().Xa();m.resize(J,b.ma(),b.la(),E,b.fa(),b.ea());l||c.disable(c.DEPTH_TEST);c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);g.pa(J,E,6)}e.use(function(){e.c("uFontSize",n.ra());e.o("uTextureResolution",n.qa(),n.ka());e.c("uBoxScale",q.Va()/b.v());e.g("aVertexPosition",
y,c.BYTE);e.g("aLabelPointData",w,c.FLOAT,!1,0,0,!0);e.g("aLabelBoxSpriteData",A,c.SHORT,!1,0,0,!0);e.g("aLabelBoxPositionData",u,c.FLOAT,!1,0,0,!0);e.g("aLabelColor",G,c.UNSIGNED_BYTE,!0,0,0,!0);e.g("aLabelOpacity",z,c.UNSIGNED_BYTE,!0,0,0,!0);e.m("uLabelSprites",U,0);e.c("uScale",r);e.va(p);e.D("aVertexPosition aLabelPointData aLabelBoxSpriteData aLabelBoxPositionData aLabelOpacity aLabelColor".split(" "));c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,
c.ONE,c.ONE_MINUS_SRC_ALPHA);e.Da(w.h(),y.h())})}}}
function Xb(a,b,c){function d(a,b,c,d,e){for(var f=0,g=new Uint8ClampedArray(4*b.length),h=0;h<b.length;h++){var k=a[b[h][3]][d]||e;g[f++]=k[0];g[f++]=k[1];g[f++]=k[2];g[f++]=k[3]}c.setData(g,4,a.length)}function e(a,b,c,d,e){for(var f=new Uint8ClampedArray(b.length),g=!1,h=0;h<b.length;h++){var k=a[b[h][3]][d];k=255*(void 0!==k?k:e);f[h]=k;0<k&&(g=!0)}c.setData(f,1,b.length);return g}function f(){for(var a=c.K(),b=c.ja(),d=c.Jc(),e=new Float32Array(3*b.length),f=0,g=0;g<b.length;g++){var h=b[g],
k=a[h[3]];e[f++]=k.x;e[f++]=k.y;e[f++]=Math.min(1E6,d[h[3]])}m.setData(e,3,b.length)}function h(a){return void 0!==a?Math.ceil(a*x.v()):a}var k=this,l=a.V,g=new Ma;g.set(Q);c.wa(function(a){g.set(a)});var p=a.createBuffer(),m=a.createBuffer(),n=a.createBuffer(),q=a.createBuffer(),r=a.createBuffer(),t=a.createBuffer(),w=a.createBuffer(),y=a.createBuffer(),u,z,v;this.T=function(){return c};this.S=function(){return b};this.zb=function(){return p};this.Hb=function(){return m};this.yb=function(){return n};
this.xb=function(){return q};this.xc=function(){return r};this.Gb=function(){return t};this.vc=function(){return w};this.wc=function(){return y};this.Mc=function(){return u};this.Kb=function(){return z};this.Nb=function(){return v};this.ra=function(){return h(c.ra())};this.qa=function(){return h(c.qa())};this.ka=function(){return h(c.ka())};this.ba=function(){if(g.a(Q)){f();var b=new Int8Array(8),m=0;b[m++]=0;b[m++]=0;b[m++]=1;b[m++]=0;b[m++]=1;b[m++]=1;b[m++]=0;b[m]=1;p.setData(b,2,4);g.set(X);g.set(T);
g.set(Sa);g.set(Ta);g.set(Ua);g.set(Va)}g.a(T)&&f();if(g.a(X)){b=c.ja();m=c.cc();for(var v=new Int16Array(3*b.length),x=k.ka(),C=0,E=0;E<b.length;E++){var F=m.lb(b[E][2]);v[C++]=h(F[0]);v[C++]=h(F[1])%x;v[C++]=Math.floor(h(F[1])/x)}n.setData(v,3,b.length);b=c.Lc();v=c.cc();m=new ArrayBuffer(k.qa()*k.ka()*4);m=new Uint8Array(m);Lb(m,0);v=v.lc();for(x=0;x<v.length&&0>v[x][1];)x++;C=k.ra();E=k.qa();F=k.ka();var H=document.createElement("canvas");H.width=E;H.height=C;H=H.getContext("2d");H.font=c.Cb()+
" "+c.Db()+" "+c.Eb()+" "+C+"px "+c.Bb();H.fillStyle="rgba(0, 0, 0, 1.0)";H.textBaseline="bottom";if(x<v.length)for(var I=v[x],M=h(I[1]),R=0;;){if(void 0===I||h(I[1])!==M){M=Math.floor(M/F);var W=new Uint8Array(H.getImageData(0,0,E,C).data.buffer);H.clearRect(0,0,E,C);for(var V=3;V<W.length;V+=4)m[M+R]=W[V],R+=4;R>=E*F*4&&(R=0);if(void 0!==I)M=h(I[1]);else break}for(;x<v.length&&h(I[1])===M;)H.fillText(b[I[2]],h(I[0])+1,C),x++,I=v[x]}z&&z.release();z=a.createTexture(m,E,F,l.NEAREST,l.RGBA,l.UNSIGNED_BYTE);
b=c.ja();m=c.Kc();v=new Float32Array(3*b.length);for(C=x=0;C<b.length;C++)E=b[C],F=h(m[E[2]]),v[x++]=h(E[0]),v[x++]=h(E[1]),v[x++]=F;q.setData(v,3,b.length)}g.a(Sa)&&d(c.K(),c.ja(),r,"labelColor",c.Ab());g.a(Ta)&&e(c.K(),c.ja(),t,"labelOpacity",c.Fb());g.a(Ua)&&d(c.K(),c.ja(),w,"labelBoxColor",c.vb());g.a(Va)&&(u=e(c.K(),c.ja(),y,"labelBoxOpacity",c.wb()))};var x;this.Aa=function(a){x=a;x.ia(k);k.M(x.U(),x.Z())};this.release=function(){x.gc(k);p.release();m.release();n.release();q.release();r.release();
t.release();w.release();y.release();z.release();v.release()};this.M=function(){var b=v,c=x.fa(),d=x.ea();b?(b.resize(c,d),v=b):v=a.createTexture(null,c,d,l.LINEAR,l.RGBA,l.UNSIGNED_BYTE)}};function Yb(a){var b=this;Y.call(this,a);this.xa=function(){return m};this.Y=function(){return"marker"};var c=new Map;c.set("markerColor",Na);c.set("markerOpacity",Pa);c.set("markerSize",Oa);c.set("markerShape",Qa);this.f=function(){return c};var d=.35;this.Pb=function(){return d};var e=1;this.Rb=function(){return e};var f=.25;this.Sb=function(){return f};var h=10;this.ga=function(){return h};var k=1;this.Vb=function(){return k};var l=Sb.a;this.Ob=function(){return l};var g="circle";this.Qb=function(){return g};
var p=this.Ka;this.Ka=function(a){return p.call(b,a)*b.ga()};var m=ka(this,a,{options:this.W({markerFillOpacity:{get:this.Pb,set:function(a){return d=a}},markerStrokeOpacity:{get:this.Rb,set:function(a){return e=a}},markerStrokeWidth:{get:this.Sb,set:function(a){return f=a}},markerSizeMultiplier:{get:this.ga,set:function(a){return h=a}},minAbsoluteMarkerSize:{get:this.Vb,set:function(a){return k=a}},markerColor:{get:this.Ob,set:function(a){b.a(Na);return l=a}},markerShape:{get:this.Qb,set:function(a){b.a(Qa);
return g=a}}}),getters:this.s({}),events:this.i({}),methods:this.O({})})}Yb.prototype=Object.create(Y.prototype);function Zb(a,b){var c=a.V,d=a.createProgram({name:"dots",L:"\n      attribute vec3 aMarkerPosition;\n      attribute vec4 aMarkerColor;\n      attribute float aMarkerOpacity;\n      attribute float aMarkerType;\n  \n      varying vec4 vMarkerColor;\n      varying float vMarkerOpacity;\n      varying float vMarkerType;\n      varying float vMarkerSize;\n  \n      uniform mat3 uMvMatrix;\n      uniform float uPointScale;\n      uniform float uMinAbsolutePointSize;\n  \n      void main(void) {\n        gl_Position = vec4(\n          (uMvMatrix * vec3(aMarkerPosition.xy, 1.0)) + \n          vec3(0.0, 0.0, 2.0 * step(aMarkerOpacity, 0.0)), // z-filtering for opacity==0 markers\n          1.0);\n          \n        // The +2.0 factor is an extra 2-pixel margin for antialiasing.\n        gl_PointSize = max(uPointScale * aMarkerPosition.z, uMinAbsolutePointSize);\n        vMarkerColor = aMarkerColor;\n        vMarkerOpacity = aMarkerOpacity;\n        vMarkerType = floor(aMarkerType);\n        vMarkerSize = gl_PointSize;\n      }\n    ",
J:"\n      #extension GL_OES_standard_derivatives : enable\n      precision mediump float;\n      uniform float uMarkerOpacity;\n      uniform float uFillOpacity;\n      uniform float uStrokeOpacity;\n      uniform float uStrokeWidth;\n      uniform sampler2D uMaskTexture;\n      uniform vec2 uViewport;\n\n      varying vec4 vMarkerColor;\n      varying float vMarkerOpacity;\n      varying float vMarkerType;\n      varying float vMarkerSize;\n\n      void main(void) {\n        const float      PI = 3.14159265359;\n        const float  TWO_PI = 6.28318530718;\n\n        // Position of the fragment, in the -1.0...1.0 range.\n        vec2 pos = 2.0 * gl_PointCoord - 1.0;\n      \n        // We draw the shapes and strokes using the signed distance field technique.\n        // Variable d represents the distance to the _boundary_ of the shape.\n        // Pixels where d is close to 0 lie on the stroke of the shape.\n        // Pixels where 0.0 < d < 1.0 are inside the shape. \n        // The only tricky bit is to compute d for the specific shape. \n        float d = 0.0;\n        \n        // Accept thread divergence for now. If we see performance problems, \n        // we can can always convert the code to remove conditions.\n        if (vMarkerType == 2.0) {\n          // Square\n          vec2 t = 1.0 - abs(pos);\n          d = min(t.x, t.y);\n        } else if (vMarkerType == 1.0) {\n          // Triangle\n          float angle = atan(pos.x, pos.y) + PI;\n          float r = TWO_PI / 3.0; // the constant is the number of vertices\n          d = 1.02 - sqrt(cos(floor(0.5 + angle / r) * r - angle) * r * length(pos));\n        } else {\n          // Circle\n          d = 1.0 - sqrt(dot(pos, pos));\n        }\n      \n        // Now fill and stroke the shape. Apply some anti-aliasing too.\n        // Add some margin for anti-aliasing.\n        float margin = 2.0 / vMarkerSize;\n        float delta = fwidth(d) * 0.75;\n        \n        float alpha = max(\n                        uStrokeOpacity * \n                          (1.0 - smoothstep(uStrokeWidth - delta, uStrokeWidth + delta, d)) * \n                          smoothstep(margin - delta, margin + delta, d),\n                        uFillOpacity * step(uStrokeWidth - delta * 0.5, d)\n                      );\n        \n        // Apply mask and fill the pixels.\n        float mask = min(1.0, texture2D(uMaskTexture, gl_FragCoord.xy / uViewport).a * 8.0);\n        gl_FragColor = vec4(mix(vMarkerColor.rgb, vec3(1.0, 1.0, 1.0), 0.5 * mask), \n          vMarkerOpacity * vMarkerColor.a * alpha * uMarkerOpacity * (1.0 - 0.5 * mask));\n      }\n    ",
C:["aMarkerPosition","aMarkerColor","aMarkerType","aMarkerOpacity"],H:"uMvMatrix uPointScale uMarkerOpacity uFillOpacity uStrokeOpacity uStrokeWidth uMaskTexture uViewport uMinAbsolutePointSize".split(" ")});this.pa=function(a,f,h,k){a.ba();var e=a.T(),g=a.Ya();0!==g.h()&&d.use(function(){d.g("aMarkerPosition",g);d.g("aMarkerColor",a.zc(),c.UNSIGNED_BYTE,!0);d.g("aMarkerOpacity",a.Bc(),c.UNSIGNED_BYTE,!0);d.g("aMarkerType",a.Ac(),c.UNSIGNED_BYTE,!1);var h=b.v();d.va(f);d.c("uPointScale",e.Ka(b));
d.c("uMinAbsolutePointSize",e.Vb()*h);d.c("uMarkerOpacity",e.Ja());d.c("uFillOpacity",e.Pb());d.c("uStrokeOpacity",e.Rb());d.c("uStrokeWidth",Math.min(1,Math.max(0,e.Sb())));k?d.m("uMaskTexture",k,0):d.m("uMaskTexture",a.S().Sa(),0);d.o("uViewport",b.U()*b.v(),b.Z()*b.v());d.D(["aMarkerPosition","aMarkerColor","aMarkerType","aMarkerOpacity"]);c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);d.ob(g.h())})}}
function ac(a,b,c){function d(){for(var a=new Uint8ClampedArray(k.length),b=0;b<k.length;b++){var c=k[b].markerOpacity;a[b]=255*(void 0===c?1:c)}p.setData(a,1,k.length)}function e(){for(var a=new Uint8ClampedArray(4*k.length),b=0,d=c.Ob(),e=0;e<k.length;e++){var f=k[e].markerColor||d;a[b++]=f[0];a[b++]=f[1];a[b++]=f[2];a[b++]=f[3]}g.setData(a,4,k.length)}function f(){for(var a=new Uint8ClampedArray(k.length),b=c.Qb(),d=0;d<k.length;d++){var e=0;switch(k[d].markerShape||b){case "square":e|=2;break;
case "triangle":e|=1}a[d]=e}m.setData(a,1,k.length)}var h=new Ma;h.set(Q);c.wa(function(a){h.set(a)});var k,l=a.createBuffer(),g=a.createBuffer(),p=a.createBuffer(),m=a.createBuffer();this.T=function(){return c};this.S=function(){return b};this.ba=function(){h.a(Q)&&(k=c.K(),h.set(S),h.set(Na),h.set(Pa),h.set(Oa),h.set(Qa));if(h.b(S,Oa)){for(var a=new Float32Array(3*k.length),b=0,g=K(k),m=g.next();!m.done;m=g.next())m=m.value,a[b++]=m.x,a[b++]=m.y,m=m.markerSize||0,a[b++]=Math.max(0,Math.min(1,m));
l.setData(a,3,k.length)}h.f(Na,e);h.f(Pa,d);h.f(Qa,f)};this.Ya=function(){return l};this.zc=function(){return g};this.Bc=function(){return p};this.Ac=function(){return m};this.release=function(){l.release();g.release();p.release();m.release()}};function bc(a){Y.call(this,a);this.xa=function(){return h};this.Y=function(){return"outline"};var b=8;this.Yb=function(){return b};var c=1;this.Xb=function(){return c};var d=[255,255,255,128];this.Wb=function(){return d};var e=[0,0,0,255];this.Zb=function(){return e};var f=.5;this.$b=function(){return f};var h=ka(this,a,{options:this.W({outlineRadiusOffset:{get:this.Yb,set:function(a){return b=a}},outlineRadiusMultiplier:{get:this.Xb,set:function(a){return c=a}},outlineFillColor:{get:this.Wb,set:function(a){return d=
a}},outlineStrokeColor:{get:this.Zb,set:function(a){return e=a}},outlineStrokeWidth:{get:this.$b,set:function(a){return f=a}}}),getters:this.s({}),events:this.i({}),methods:this.O({})})}bc.prototype=Object.create(Y.prototype);function cc(a,b){var c=a.V,d=a.createProgram({name:"dots",L:"\n      attribute vec3 aMarkerPosition;\n  \n      uniform mat3 uMvMatrix;\n      uniform float uPointScale;\n      uniform float uOutlineRadiusOffset;\n      uniform float uOutlineRadiusMultiplier;\n  \n      void main(void) {\n        gl_Position = vec4(\n          (uMvMatrix * vec3(aMarkerPosition.xy, 1.0)),\n          1.0);\n          \n        gl_PointSize = uPointScale * (aMarkerPosition.z * uOutlineRadiusMultiplier + uOutlineRadiusOffset);\n      }\n    ",
J:"\n      precision mediump float;\n      uniform vec2 uViewport;\n\n      void main(void) {\n        // Position of the fragment, in the -1.0...1.0 range.\n        vec2 pos = 2.0 * gl_PointCoord - 1.0;\n        \n        float v = 1.0 - step(1.0, sqrt(dot(pos, pos)));\n\n        gl_FragColor = vec4(v, v, v, v);\n      }\n    ",C:["aMarkerPosition"],H:["uMvMatrix","uPointScale","uOutlineRadiusMultiplier","uOutlineRadiusOffset"]}),e=a.createProgram({name:"outlineBorder",L:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",
J:"\n      #extension GL_OES_standard_derivatives : enable\n      precision mediump float;\n\n      uniform vec2 uResolution;\n      uniform vec4 uFillColor;\n      uniform vec4 uStrokeColor;\n      uniform float uOutlineStrokeWidth;\n      uniform sampler2D uHeightmap;\n      uniform sampler2D uMaskTexture;\n\n      void main() {\n        vec2 uv = vec2(gl_FragCoord.xy / uResolution.xy);\n        float h = texture2D(uHeightmap, uv).a;\n        \n        // Height deltas along x and y.\n        float dhx = dFdx(h);\n        float dhy = dFdy(h);\n        \n        // Label mask, applies to contours only\n        float mask = min(1.0, texture2D(uMaskTexture, gl_FragCoord.xy / uResolution).a * 8.0);\n        \n        // Distance to the nearest band's boundary height.\n        float dsx = (h - uOutlineStrokeWidth) / sqrt(dhx * dhx + dhy * dhy);\n\n        float cs = max(smoothstep(-1.0, 1.0, dsx), mask);\n        float ss = smoothstep(0.0, 1.0 - uOutlineStrokeWidth, h);\n        gl_FragColor = vec4(mix(uStrokeColor, uFillColor, cs).rgb, ss * mix(uStrokeColor.a, uFillColor.a, cs));\n      }\n    ",
C:["aVertexPosition"],H:"uHeightmap uMaskTexture uResolution uFillColor uStrokeColor uOutlineStrokeWidth uHeightmapSize".split(" ")}),f=new Ub(a),h=a.da();this.pa=function(k,l,g,p){var m=k.T();k.ba();var n=k.Ya();if(0!==n.h()){var q=b.v(),r=k.S().Xa(),t=k.S().yc();r.capture(function(){a.ca();d.use(function(){d.g("aMarkerPosition",n);d.va(l);d.c("uPointScale",q*Math.min(Math.sqrt(g),4)/2);d.c("uOutlineRadiusMultiplier",m.Xb());d.c("uOutlineRadiusOffset",m.Yb());d.D(["aMarkerPosition"]);c.enable(c.BLEND);
c.blendEquation(c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);d.ob(n.h())})});f.a(r,r,t,b.fa(),b.ea(),Math.min(1,q/2));c.enable(c.BLEND);e.use(function(){e.g("aVertexPosition",h);e.m("uHeightmap",r,0);p?e.m("uMaskTexture",p,1):e.m("uMaskTexture",k.S().Sa(),1);e.o("uResolution",b.ma(),b.la());e.gb("uFillColor",m.Wb());e.gb("uStrokeColor",m.Zb());e.c("uOutlineStrokeWidth",m.$b());e.D(["aVertexPosition"]);e.X(h.h())})}}}
function dc(a,b,c){var d=new Ma;d.set(Q);c.wa(function(a){d.set(a)});var e,f=a.createBuffer();this.T=function(){return c};this.S=function(){return b};this.ba=function(){d.a(Q)&&(e=c.K(),d.set(S),d.set(Oa));if(d.b(S,Oa)){for(var a=new Float32Array(3*e.length),b=0,l=K(e),g=l.next();!g.done;g=l.next())g=g.value,a[b++]=g.x,a[b++]=g.y,g=g.markerSize||0,a[b++]=Math.max(0,Math.min(1,g));f.setData(a,3,e.length)}};this.Ya=function(){return f};this.release=function(){f.release()}};var ec=new function(){var a=this;this.f=function(b){return b[ja]||a.b(b)};this.b=function(a){var b=a.type;switch(b){case "marker":return new Yb(a);case "outline":return new bc(a);case "elevation":return new qb(a);case "label":return new Tb(a);case void 0:throw"Each layer must define 'type'.";default:throw"Unknown layer type '"+b+"'";}};this.a=function(a,c,d){switch(a.Y()){case "marker":return new ac(c,d,a);case "outline":return new dc(c,d,a);case "elevation":return new gb(c,d,a);case "label":return new Xb(c,
d,a)}}};function fc(a,b){function c(b,c){return a.createTexture(null,b,c,d.LINEAR,d.RGBA,d.UNSIGNED_BYTE)}var d=a.V,e=a.createTexture(null,1,1,d.LINEAR);this.M=function(){f.resize(b.ma(),b.la());h.resize(b.fa(),b.ea());k.resize(b.fa(),b.ea())};this.ub=function(){return f};this.Xa=function(){return h};this.yc=function(){return k};this.Sa=function(){return e};b.ia(this);b.hb(this);var f=c(b.ma(),b.la());var h=c(b.fa(),b.ea());var k=c(b.fa(),b.ea())};function gc(a,b){function c(){l=new rb(b.U(),b.Z(),b.v(),A);p.f(l);m.a(l)}function d(a,c){var d=v&&0<v.Ja()&&!!x,e=!!z&&u.bb();if(d){var g=v.Ia();void 0===g&&(g=p.O(x),v.dd(g));p.a(x)}f.viewport(0,0,b.ma(),b.la());f.enable(f.BLEND);f.blendEquation(f.FUNC_ADD);f.blendFuncSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA);f.clearColor(1,1,1,1);f.clear(f.COLOR_BUFFER_BIT);var h=e?r.b(z,a,c):void 0;d&&m.b(x,p.i(),g,c,h);y.forEach(function(b){if(b.T().bb()){var d=b instanceof ac?n:
b instanceof dc?q:void 0;d.pa(b,a,c,h)}});e&&r.a(z,a,c)}function e(a,c,d,e){var f=l.margin(),g=1+a*f/(l.width()+A*f);a=1+a*f/(l.height()+A*f);return Fa().translate(-(g-1),-(a-1)).scale(1,-1).translate(g-1,a-1).scale(2/b.U(),2/b.Z()).translate(c/g,d/a).scale(b.U()/2,b.Z()/2).translate(-1,-1).scale(e,e).translate(1,1).translate(-1,-1).scale(2/(t.u*g),2/(t.B*a)).translate(-t.x,-t.y)}var f=a.V;f.disable(f.DEPTH_TEST);b.ia(this);b.Pa(this);b.jb(this);var h=void 0,k=1,l,g=new fc(a,b),p=new fb(a,b),m=new hb(a,
b),n=new Zb(a,b),q=new cc(a,b),r=new Wb(a,b),t,w=[],y=[],u,z,v,x;this.ab=function(){c()};this.M=function(){c()};this.b=function(c){function d(b,c){c&&c.release();return b?ec.a(b,a,g):void 0}w=c;v=w.find(function(a){return a instanceof qb});u=w.find(function(a){return a instanceof Tb});y.forEach(function(a){return a.release()});x=d(v,x);(z=d(u,z))&&z.Aa(b);x&&(x.Aa(b),v.cd(function(a,b){return p.s(a,b,x)}));y=w.filter(function(a){return"outline"===a.Y()||"marker"===a.Y()}).map(function(b){return ec.a(b,
a,g)})};this.na=function(a){t=a;p.W(e(1,0,0,1))};this.setTransform=function(a,b,c){k=c;h=e(0,a,b,c);p.ga(e(1,a,b,c));d(h.elements(),k)};this.a=function(){d(h.elements(),k)};this.getImageData=function(b){this.a();return a.canvas.toDataURL(xa(b&&b.format,"image/png"),xa(b&&b.quality,.8))};var A=2};var Ha=["OES_texture_float","OES_standard_derivatives","OES_texture_float_linear"];
function hc(a){function b(){var b=a.Ga(),c=a.U(),d=a.Z(),e=a.Hc(),m=a.Ic(),n=a.La(),q=Fa().translate(b.x,b.y).scale(b.u,b.B).scale(1/c,1/d);b=Fa().scale(c,d).scale(1/b.u,1/b.B).translate(-b.x,-b.y);f=Fa().multiply(q).scale(1/n,1/n).translate(-e,-m);h=Fa().translate(e,m).scale(n,n).multiply(b)}function c(){var a=e;e=!1;return a}function d(){return e=!0}var e=!0,f,h;a.ia(this);a.Pa(this);a.hb(this);a.jb(this);this.setTransform=this.M=this.na=d;this.hc=function(a,d){c()&&b();return f.transform(a,d)};
this.a=function(a,d){c()&&b();return h.transform(a,d)}}
function ic(a){function b(){var a=f.clientWidth,b=f.clientHeight;if(0===a||0===b)throw"The provided element must have non-zero dimensions.";f.width=a*e.Na;f.height=b*e.Na;return{jc:a,ic:b}}function c(a){function b(b){if(1<a.filter(function(a){return a.type===b}).length)throw"Only one '"+b+"' type layer is allowed.";}b("label");b("elevation");(function(){for(var b=1;b<a.length;b++)if("elevation"===a[b].type)throw"The 'elevation' type layer must be at index 0.";})()}function d(a){a=a.reduce(function(a,
b){return a.ib(b.K())},Ca()).mb();return void 0===a?new Ba(0,0,1,1):0===a.u?a.ec(.5):a.Pc()}var e=Object.assign({},{element:null,Na:window.devicePixelRatio||1,initialTransform:{translateX:0,translateY:0,scale:1}},a),f=function(){var a=e.element;if(!a)throw"Provide a HTML element in which to embed dotAtlas.";var b=document.createElement("div"),c=document.createElement("canvas");b.setAttribute("style","width: 100%; height: 100%; position: relative;");c.setAttribute("style","width: 100%; height: 100%; position: absolute; cursor: default");
b.appendChild(c);a.appendChild(b);a.dataset.dotatlas="embedded";return c}();a=b();var h=a.jc,k=a.ic,l=new Ga(f),g=new Ia(h,k,e.Na);a=new hc(g);var p=new gc(l,g);l=new ra(e.element);l=new Ja(l,a);var m=new $a(l,g),n=new sa,q=new Aa({ed:g,$:{j:e.initialTransform.translateX,l:e.initialTransform.translateY,scale:e.initialTransform.scale}},n);new ta(q,l,n);this.a=l;this.f=a;var r=!1,t,w,y=[],u=[];p.ab();this.O=function(){return y};this.b=function(a){a=a||[];c(a);u.filter(function(a){return"label"===a.Y()}).forEach(function(a){a.nb()});
u=a.map(function(a){return ec.f(a)});u.forEach(function(a){return a.ab()});t=d(u);w=t.dc(h/k);g.na(w);u.filter(function(a){return"label"===a.Y()}).forEach(function(a){a.Aa(g);a.update()});m.eb();m.Qa(u);y=u.map(function(a){return a.xa()});p.b(u);r=!0;window.requestAnimationFrame(function(){r=!1;g.setTransform(0,0,1)})};this.b(y);this.i=function(){r||(r=!0,window.requestAnimationFrame(function(){r=!1;p.a()}))};this.reset=function(a){q.reset(a)};this.s=function(a,b,c,d){var e=w;q.b(h/2-c*(a-e.x)*h/
e.u,k/2-c*(b-e.y)*k/e.B,c,d)};this.setTransform=function(a,b,c){g.setTransform(a,b,c)};this.resize=function(){var a=b(),c=a.jc;a=a.ic;if(0!==c-h||0!==a-k){var d=w,e=t.dc(c/a);w=e;g.na(e);g.M(c,a);q.resize(c,a,h,k,e,d);h=c;k=a}};this.W=function(){return q.a().scale};this.getImageData=function(a){return p.getImageData(a)};this.setTransform=function(a,b,c){p.setTransform(a,b,c)}};function Z(a){var b=new ic({element:a.element,Na:a.pixelRatio||1});la(this,b,a,{options:{layers:{get:b.O,set:b.b},transform:{get:b.setTransform,set:b.setTransform}},getters:{zoom:{get:b.W},imageData:{get:b.getImageData}},methods:{redraw:b.i,resize:b.resize,pointToScreenSpace:b.f.a,screenToPointSpace:b.f.hc,centerPoint:b.s,setTransform:b.setTransform,reset:b.reset},events:{onClick:b.a.a,onHover:b.a.f,onMouseWheel:b.a.i,onDoubleClick:b.a.b}})}
function jc(){var a=this,b=[];this["with"]=function(a){Array.isArray(a)?a.forEach(function(a){return b.push(a)}):b.push(a);return this};this.embed=function(c){var d={element:c.element,pixelRatio:c.pixelRatio};d=Z.embed(0<b.length?d:c);for(var e=0;e<b.length;e++){var f=e<b.length-1?{}:c,h=b[e].create(d,f);h?d=h:d=oa({},d,a,f,{})}return d}}
Z.supported=function(){try{var a=document.createElement("canvas");if(!a)return console.error("dotAtlas requires HTML5 canvas support."),!1;var b=a.getContext("webgl")||a.getContext("experimental-webgl");if(!b)return console.error("dotAtlas requires WebGL support."),!1}catch(c){return!1}return!!b&&Ha.reduce(function(a,d){var c=!!b.getExtension(d);c||console.error("dotAtlas requires the "+d+" WebGL extension support.");return a&&c},!0)};Z.createLayer=function(a){return ec.b(a).xa()};
Z.injectApiProxy=oa;Z["with"]=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];return(new jc)["with"](b)};Z.embed=function(a){return new Z(a)};window.DotAtlas=Z;
}).call(this)
