/**
 * Carrot Search dotAtlas (pre-release, demo)
 * v0.2.1, master/3057f45, build DOTATLAS-SOFTWARE-60, 2019-07-30
 *
 * Carrot Search confidential.
 * Copyright 2002-2019, Carrot Search s.c, All Rights Reserved.
 */
(function(){
'use strict';function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var ba="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},A="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function D(){D=function(){};A.Symbol||(A.Symbol=ca)}function da(a,b){this.a=a;ba(this,"description",{configurable:!0,writable:!0,value:b})}
da.prototype.toString=function(){return this.a};var ca=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new da("jscomp_symbol_"+(c||"")+"_"+b++,c)}var b=0;return a}();function ea(){D();var a=A.Symbol.iterator;a||(a=A.Symbol.iterator=A.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&ba(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return fa(aa(this))}});ea=function(){}}
function fa(a){ea();a={next:a};a[A.Symbol.iterator]=function(){return this};return a}function K(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:aa(a)}}function ha(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function L(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var ia="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)L(d,e)&&(a[e]=d[e])}return a};
function N(a,b){if(b){var c=A;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ba(c,a,{configurable:!0,writable:!0,value:b})}}N("Object.assign",function(a){return a||ia});
N("WeakMap",function(a){function b(a){this.a=(k+=Math.random()+1).toString();if(a){a=K(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}}function c(){}function d(a){L(a,g)||ba(a,g,{value:new c})}function e(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof c)return a;d(a);return b(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==
d.get(c)}catch(p){return!1}}())return a;var g="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var k=0;b.prototype.set=function(a,b){d(a);if(!L(a,g))throw Error("WeakMap key fail: "+a);a[g][this.a]=b;return this};b.prototype.get=function(a){return L(a,g)?a[g][this.a]:void 0};b.prototype.has=function(a){return L(a,g)&&L(a[g],this.a)};b.prototype.delete=function(a){return L(a,g)&&L(a[g],this.a)?delete a[g][this.a]:!1};return b});
N("Map",function(a){function b(){var a={};return a.ba=a.next=a.head=a}function c(a,b){var c=a.a;return fa(function(){if(c){for(;c.head!=a.a;)c=c.ba;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})}function d(a,b){var c=b&&typeof b;"object"==c||"function"==c?g.has(b)?c=g.get(b):(c=""+ ++k,g.set(b,c)):c="p_"+b;var d=a.b[c];if(d&&L(a.b,c))for(a=0;a<d.length;a++){var l=d[a];if(b!==b&&l.key!==l.key||b===l.key)return{id:c,list:d,index:a,L:l}}return{id:c,list:d,
index:-1,L:void 0}}function e(a){this.b={};this.a=b();this.size=0;if(a){a=K(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}}if(function(){if(!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),b=new a(K([[c,"s"]]));if("s"!=b.get(c)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var d=b.entries(),e=d.next();if(e.done||e.value[0]!=c||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||
"t"!=e.value[1]||!d.next().done?!1:!0}catch(h){return!1}}())return a;ea();var g=new WeakMap;e.prototype.set=function(a,b){a=0===a?0:a;var c=d(this,a);c.list||(c.list=this.b[c.id]=[]);c.L?c.L.value=b:(c.L={next:this.a,ba:this.a.ba,head:this.a,key:a,value:b},c.list.push(c.L),this.a.ba.next=c.L,this.a.ba=c.L,this.size++);return this};e.prototype.delete=function(a){a=d(this,a);return a.L&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.b[a.id],a.L.ba.next=a.L.next,a.L.next.ba=a.L.ba,a.L.head=
null,this.size--,!0):!1};e.prototype.clear=function(){this.b={};this.a=this.a.ba=b();this.size=0};e.prototype.has=function(a){return!!d(this,a).L};e.prototype.get=function(a){return(a=d(this,a).L)&&a.value};e.prototype.entries=function(){return c(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return c(this,function(a){return a.key})};e.prototype.values=function(){return c(this,function(a){return a.value})};e.prototype.forEach=function(a,c){for(var b=this.entries(),d;!(d=b.next()).done;)d=
d.value,a.call(c,d[1],d[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var k=0;return e});N("Array.from",function(a){return a?a:function(a,c,d){c=null!=c?c:function(a){return a};var b=[],g="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if("function"==typeof g){a=g.call(a);for(var k=0;!(g=a.next()).done;)b.push(c.call(d,g.value,k++))}else for(g=a.length,k=0;k<g;k++)b.push(c.call(d,a[k],k));return b}});
N("Set",function(a){function b(a){this.a=new Map;if(a){a=K(a);for(var c;!(c=a.next()).done;)this.add(c.value)}this.size=this.a.size}if(function(){if(!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),b=new a(K([c]));if(!b.has(c)||1!=b.size||b.add(c)!=b||1!=b.size||b.add({x:4})!=b||2!=b.size)return!1;var e=b.entries(),g=e.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=e.next();return g.done||g.value[0]==c||4!=g.value[0].x||
g.value[1]!=g.value[0]?!1:e.next().done}catch(k){return!1}}())return a;ea();b.prototype.add=function(a){a=0===a?0:a;this.a.set(a,a);this.size=this.a.size;return this};b.prototype.delete=function(a){a=this.a.delete(a);this.size=this.a.size;return a};b.prototype.clear=function(){this.a.clear();this.size=0};b.prototype.has=function(a){return this.a.has(a)};b.prototype.entries=function(){return this.a.entries()};b.prototype.values=function(){return this.a.values()};b.prototype.keys=b.prototype.values;
b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.a.forEach(function(d){return a.call(b,d,d,c)})};return b});
N("Promise",function(a){function b(a){this.b=0;this.u=void 0;this.a=[];var b=this.g();try{a(b.resolve,b.reject)}catch(m){b.reject(m)}}function c(){this.a=null}function d(a){return a instanceof b?a:new b(function(b){b(a)})}if(a)return a;c.prototype.b=function(a){if(null==this.a){this.a=[];var b=this;this.g(function(){b.u()})}this.a.push(a)};var e=A.setTimeout;c.prototype.g=function(a){e(a,0)};c.prototype.u=function(){for(;this.a&&this.a.length;){var a=this.a;this.a=[];for(var b=0;b<a.length;++b){var c=
a[b];a[b]=null;try{c()}catch(f){this.j(f)}}}this.a=null};c.prototype.j=function(a){this.g(function(){throw a;})};b.prototype.g=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;return{resolve:a(this.Sc),reject:a(this.j)}};b.prototype.Sc=function(a){if(a===this)this.j(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof b)this.dd(a);else{a:switch(typeof a){case "object":var c=null!=a;break a;case "function":c=!0;break a;default:c=!1}c?this.Oa(a):
this.P(a)}};b.prototype.Oa=function(a){var b=void 0;try{b=a.then}catch(m){this.j(m);return}"function"==typeof b?this.hd(b,a):this.P(a)};b.prototype.j=function(a){this.Y(2,a)};b.prototype.P=function(a){this.Y(1,a)};b.prototype.Y=function(a,b){if(0!=this.b)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.b);this.b=a;this.u=b;this.ia()};b.prototype.ia=function(){if(null!=this.a){for(var a=0;a<this.a.length;++a)g.b(this.a[a]);this.a=null}};var g=new c;b.prototype.dd=function(a){var b=
this.g();a.Da(b.resolve,b.reject)};b.prototype.hd=function(a,b){var c=this.g();try{a.call(b,c.resolve,c.reject)}catch(f){c.reject(f)}};b.prototype.then=function(a,c){function d(a,b){return"function"==typeof a?function(b){try{f(a(b))}catch(t){e(t)}}:b}var f,e,g=new b(function(a,b){f=a;e=b});this.Da(d(a,f),d(c,e));return g};b.prototype.catch=function(a){return this.then(void 0,a)};b.prototype.Da=function(a,b){function c(){switch(d.b){case 1:a(d.u);break;case 2:b(d.u);break;default:throw Error("Unexpected state: "+
d.b);}}var d=this;null==this.a?g.b(c):this.a.push(c)};b.resolve=d;b.reject=function(a){return new b(function(b,c){c(a)})};b.race=function(a){return new b(function(b,c){for(var f=K(a),e=f.next();!e.done;e=f.next())d(e.value).Da(b,c)})};b.all=function(a){var c=K(a),e=c.next();return e.done?d([]):new b(function(a,b){function f(b){return function(c){g[b]=c;l--;0==l&&a(g)}}var g=[],l=0;do g.push(void 0),l++,d(e.value).Da(f(g.length-1),b),e=c.next();while(!e.done)})};return b});
N("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991});N("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}});N("Array.prototype.find",function(a){return a?a:function(a,c){a:{var b=this;b instanceof String&&(b=String(b));for(var e=b.length,g=0;g<e;g++){var k=b[g];if(a.call(c,k,g,b)){a=k;break a}}a=void 0}return a}});D();var ja=Symbol();D();Symbol();function ka(a,b,c){var d={};la(d,a,b,c);Object.defineProperty(d,ja,{enumerable:!1,value:a});return d}function ma(a){return Object.assign({options:{},events:{},getters:{},methods:{}},a)}
function la(a,b,c,d){function e(a,c){f.options.hasOwnProperty(a)?f.options[a].set.call(b,c):f.events.hasOwnProperty(a)?l(a,c||[]):f.defaultSetter&&f.defaultSetter.call(b,a,c)}function g(a,b){h.has(a)&&(a=h.get(a),Array.isArray(b)?a.push.apply(a,b.filter(function(a){return!!a})):a.push(b),m())}function k(a,b){if(h.has(a)){if(Array.isArray(b)){var c=new Set(b);var d=function(a){return!c.has(a)}}else d=function(a){return a!==b};h.set(a,h.get(a).filter(d));m()}}function l(a,b){h.has(a)&&(Array.isArray(b)?
h.set(a,b.filter(function(a){return!!a})):h.set(a,[b]),m())}function m(){for(var c={},d=K(n),e=d.next();!e.done;c={qa:c.qa},e=d.next()){e=K(e.value);c.qa=e.next().value;e=e.next().value;var g=h.get(c.qa),l=f.events[c.qa];0===e&&0<g.length?l.call(b,function(b){return function(){var c=arguments;h.get(b.qa).forEach(function(b){b&&b.apply(a,c)})}}(c)):0<e&&0===g.length&&l.call(b,void 0);n.set(c.qa,g.length)}}var f=ma(d);Object.freeze(Object.keys(f.options).reduce(function(a,c){a[c]=f.options[c].get.call(b);
return a},{}));var p=Object.assign({},f.options,f.getters),h=Object.keys(f.events).reduce(function(a,b){a.set(b,[]);return a},new Map),n=Object.keys(f.events).reduce(function(a,b){a.set(b,0);return a},new Map);c&&Object.keys(c).forEach(function(a){e(a,c[a])});Object.keys(f.methods).forEach(function(c){a[c]=function(){return f.methods[c].apply(b,arguments)}});a.set=function(b,c){b&&b.constructor===Object?Object.keys(b).forEach(function(a){e(a,b[a])}):e(b,c);return a};a.get=function(a){if(p.hasOwnProperty(a))return p[a].get.apply(b,
Array.from(arguments).slice(1));if(f.defaultGetter)return f.defaultGetter.apply(b,arguments)};a.on=function(c,d){if(d){var e="on"+c.charAt(0).toUpperCase()+c.substring(1);h.has(e)?g(e,d):f.defaultOn&&f.defaultOn.call(b,c,d)}return a};a.off=function(c,d){if(d){var e="on"+c.charAt(0).toUpperCase()+c.substring(1);h.has(e)?k(e,d):f.defaultOff&&f.defaultOff.call(b,c,d)}return a};return a}var na=new Set(["set","get","on","off"]);
function oa(a,b,c,d,e){var g=ma(e);Object.keys(b).filter(function(a){return!na.has(a)&&"function"===typeof b[a]}).filter(function(a){return!g.methods.hasOwnProperty(a)}).forEach(function(c){a[c]=b[c]});return la(a,c,d,Object.assign({},g,{defaultGetter:function(){return b.get.apply(a,arguments)},defaultSetter:function(){return b.set.apply(a,arguments)},defaultOn:function(){return b.on.apply(a,arguments)},defaultOff:function(){return b.off.apply(a,arguments)}}))};try{window.localStorage.setItem("ftap5caavc","ftap5caavc"),window.localStorage.removeItem("ftap5caavc")}catch(a){};function pa(){var a=document,b={};this.addEventListener=function(c,d,e){var g=b[c];g||(g=[],b[c]=g);g.push(d);a.addEventListener(c,d,e)};this.a=function(){Object.keys(b).forEach(function(c){b[c].forEach(function(b){return a.removeEventListener(c,b)})})}};function qa(a,b,c,d){a=c-a;b=d-b;return a*a+b*b};function ra(a){function b(a){return function(b){c(b)&&a.apply(this,arguments)}}function c(b){for(b=b.target;b;){if(b===a)return!0;b=b.parentElement}return!1}function d(a,b,c){c=c||{};e(a,c);b&&b.call(a.target,c);(void 0===c.originalEventDefaultAction&&c.bd||"prevent"===c.originalEventDefaultAction)&&a.preventDefault();return c}function e(b,c){var d=b.clientX,e=b.clientY,f=c||{},g=a.getBoundingClientRect();f.x=d-g.left;f.y=e-g.top;c.altKey=b.altKey;c.metaKey=b.metaKey;c.ctrlKey=b.ctrlKey;c.shiftKey=
b.shiftKey;c.pd=3===b.which;return c}var g=new pa,k=void 0,l=void 0,m=void 0,f=void 0,p=void 0,h=void 0,n=void 0,q=void 0,r=void 0;this.click=function(a){return k=a};this.qc=function(a){m=a};this.Pc=function(a){l=a};this.ld=function(a){r=a};this.move=function(a){return f=a};this.ad=function(a){p=a};this.tc=function(a){h=a};this.rc=function(a){n=a};this.sc=function(a){q=a};this.qb=function(){g.a()};var t,u,y,v,z=!1,w=!1,x=0,B=0,H=0,J=0;g.addEventListener("mousedown",b(function(a){var b=d(a,void 0);
H=b.x;J=b.y;x=b.x;B=b.y;z=!0;d(a,h);u=!1;t=window.setTimeout(function(){100>qa(x,B,b.x,b.y)&&(window.clearTimeout(v),d(a,l),u=!0)},400)}));g.addEventListener("mouseup",function(a){function b(a,b){b=b||{};b.x=a.pageX;b.y=a.pageY;return b}if(z){w&&d(a,q);window.clearTimeout(t);if(!u&&!w&&c(a)){var e=b(a,{});y&&100>qa(e.x,e.y,y.x,y.y)?d(a,m):d(a,k);y=e;v=window.setTimeout(function(){y=null},350)}w=z=!1}});g.addEventListener("mousemove",function(a){var b=e(a,{});c(a)&&d(a,f,{type:"move"});x=b.x;B=b.y;
z&&!w&&100<qa(H,J,x,B)&&(w=!0);w&&d(a,n,b)});g.addEventListener("mouseout",b(function(a){d(a,p,{type:"out"})}));g.addEventListener("wheel",b(function(){return function(a){if("deltaY"in a)var b=a.deltaY;else b=0,"detail"in a&&(b=a.detail),"wheelDelta"in a&&(b=-a.wheelDelta/120),"wheelDeltaY"in a&&(b=-a.wheelDeltaY/120),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(b=0),b*=10;b&&a.deltaMode&&(b=1===a.deltaMode?67*b:800*b);d(a,r,{Ca:-b/200,bd:!0})}}()),{passive:!1});g.addEventListener("contextmenu",b(function(a){a.preventDefault()}))}
;function sa(){function a(e){function g(a,b){for(k=0;k<a.length;k++){l=a[k];var c=window.performance.now();c<m&&l(e,c,m)||b.push(l)}}d=!1;var k,l,m=window.performance.now()+12,f=b,p=c;b=[];c=[];g(f,b);g(p,c);(0<b.length||0<c.length)&&!d&&(requestAnimationFrame(a),d=!0)}var b=[],c=[],d=!1;this.jb=function(c){b.push(c);d||(requestAnimationFrame(a),d=!0)}};function ta(a,b,c){var d=Math.pow(2,.5),e;b.$c(function(b){1<=Math.abs(b.Ca)?a.nb(b.x,b.y,0<b.Ca?d:1/d):(a.Ua(b.x,b.y,Math.pow(2,b.Ca/2)),window.clearTimeout(e),e=window.setTimeout(function(){a.mc(b.x,b.y,b.Ca)},50))});b.Uc(function(b){var c=2*(b.altKey?1:2);a.nb(b.x,b.y,b.ctrlKey?1/c:c)});document.addEventListener("keydown",function(b){27===b.keyCode&&a.reset()});var g,k,l=!1,m,f,p,h,n=!1,q=1,r;b.Xc(function(a){g=a.x;k=a.y;m=a.x;f=a.y;l=!0});b.Vc(function(b){l&&(p=b.x,h=b.y,n||(n=!0,c.jb(function(){if(b.shiftKey){var c=
p-m,d=h-f;c=Math.max(10,Math.sqrt(c*c+d*d));r?b.ctrlKey?(c=r/c,d=c/q,q=c,a.Ua(p,h,d)):(c/=r,d=c/q,q=c,a.Ua(m,f,d)):r=c}else a.hc(p-g,h-k);g=p;k=h;n=!1;return!0})))});b.Wc(function(b){r=void 0;b.shiftKey?q=1:c.jb(function(){a.hc(b.x-g,b.y-k);return!0})})};var ua="function"===typeof Float32Array;function va(a,b,c){return(((1-3*c+3*b)*a+(3*c-6*b))*a+3*b)*a}
function wa(a,b,c){if(!(0<=a&&1>=a&&0<=c&&1>=c))throw Error("bezier x values must be in [0, 1] range");var d=ua?new Float32Array(11):Array(11);if(a!==b||1!==c)for(var e=0;11>e;++e)d[e]=va(.1*e,a,c);return function(e){if(a!==b||1!==c)if(0===e)e=0;else if(1===e)e=1;else{for(var g=0,l=1;10!==l&&d[l]<=e;++l)g+=.1;--l;l=g+(e-d[l])/(d[l+1]-d[l])*.1;var m=3*(1-3*c+3*a)*l*l+2*(3*c-6*a)*l+3*a;if(.001<=m){for(g=0;4>g;++g){m=3*(1-3*c+3*a)*l*l+2*(3*c-6*a)*l+3*a;if(0===m)break;l-=(va(l,a,c)-e)/m}e=l}else if(0===
m)e=l;else{l=g;g+=.1;var f=0;do{var p=l+(g-l)/2;m=va(p,a,c)-e;0<m?g=p:l=p}while(1E-7<Math.abs(m)&&10>++f);e=p}e=va(e,b,1)}return e}};function xa(a,b){return void 0!==a?a:b};function ya(a,b){function c(a,b){for(var c=0;c<f.length;c++){var d=f[c];a[d]=b[d]}return a}var d=wa(.25,.1,.25),e=a.duration,g=a.step,k=a.complete,l,m=!1,f,p,h,n;this.a=function(a){f=Object.keys(a);h=c({},a);p=c({},a)};this.start=function(a,r){a&&(n=c({},a));a=!0;for(var t=0;t<f.length;t++){var q=f[t];if(h[q]!==n[q]){a=!1;break}}a||(l=window.performance.now(),m||(m=!0,b.jb(function(a){a=d(Math.max(0,Math.min(1,(a-l)/xa(r,e))));for(var b=0;b<f.length;b++){var c=f[b],t=h[c];p[c]=t+a*(n[c]-t)}g(p,a);
if(1>a)return!1;k&&k(p);m=!1;return!0})))}};function Aa(a,b){function c(a,b,c,d){a.l=(a.l-b)*d+b;a.m=(a.m-c)*d+c;a.scale*=d}var d={l:a.aa.l,m:a.aa.m,scale:a.aa.scale},e={l:a.aa.l,m:a.aa.m,scale:a.aa.scale},g=a.gd,k=new ya({duration:450,step:function(a){d.l=a.l;d.m=a.m;d.scale=a.scale;g.setTransform(d.l,d.m,d.scale)}},b);this.nb=function(a,b,f){k.a(d);c(e,a,b,f);k.start(e)};this.mc=function(a,b,f){k.a(d);var g=Math.log(e.scale)/Math.log(2);c(e,a,b,Math.pow(2,.25*(0<f?Math.ceil(g/.25):Math.floor(g/.25)))/e.scale);k.start(e,250)};this.b=function(a,
b,c,g){k.a(d);e.l=a;e.m=b;e.scale=c;k.start(e,g)};this.Ua=function(a,b,f){c(d,a,b,f);e.l=d.l;e.m=d.m;e.scale=d.scale;g.setTransform(d.l,d.m,d.scale)};this.hc=function(a,b){if(0!==a||0!==b)d.l+=a,d.m+=b,e.l+=a,e.m+=b,g.setTransform(d.l,d.m,d.scale)};this.reset=function(b){k.a(d);e.l=a.aa.l;e.m=a.aa.m;e.scale=a.aa.scale;k.start(e,b)};this.resize=function(a,b,c,e,h,k){if(0!==a-c||0!==b-e){e=d.l;var f=d.m;b=d.scale;c/=k.v;a/=h.v;1===b?(h=a/c,e*=h,f*=h):(e=(e/(1-b)/c+k.x-h.x)*a,h=(f/(1-b)/c+k.y-h.y)*a,
e=-e*b+e,f=-h*b+h);g.setTransform(e,f,b)}};this.a=function(){return d};this.g=function(){g.setTransform(d.l,d.m,d.scale)}};function Ba(a,b,c,d){this.x=a;this.y=b;this.v=c;this.D=d;this.a=function(){return Math.sqrt(this.v*this.v+this.D*this.D)};this.Rc=function(){return this.gc(.05*this.a())};this.gc=function(a){return new Ba(this.x-a,this.y-a,this.v+2*a,this.D+2*a)};this.fc=function(a){if(this.v/this.D<a)return a=this.D*a-this.v,new Ba(this.x-a/2,this.y,this.v+a,this.D);a=this.v/a-this.D;return new Ba(this.x,this.y-a/2,this.v,this.D+a)}}
function Ca(){return new function(){var a=Number.MAX_VALUE,b=Number.MAX_VALUE,c=-Number.MAX_VALUE,d=-Number.MAX_VALUE;this.lb=function(e){e=K(e);for(var g=e.next();!g.done;g=e.next())g=g.value,a>g.x?a=g.x:c<g.x&&(c=g.x),b>g.y?b=g.y:d<g.y&&(d=g.y);return this};this.pb=function(){if(a!==Number.MAX_VALUE||b!==Number.MAX_VALUE)return new Ba(a,b,c-a,d-b)}}};function Da(a){this.multiply=function(b){var c=b.elements();b=a[0];var d=a[1],e=a[2],g=a[3],k=a[4],l=a[5],m=a[6],f=a[7],p=a[8],h=c[0],n=c[1],q=c[2],r=c[3],t=c[4],u=c[5],y=c[6],v=c[7];c=c[8];a[0]=h*b+n*g+q*m;a[1]=h*d+n*k+q*f;a[2]=h*e+n*l+q*p;a[3]=r*b+t*g+u*m;a[4]=r*d+t*k+u*f;a[5]=r*e+t*l+u*p;a[6]=y*b+v*g+c*m;a[7]=y*d+v*k+c*f;a[8]=y*e+v*l+c*p;return this};this.transform=function(b,c){return[b*a[0]+c*a[3]+1*a[6],b*a[1]+c*a[4]+1*a[7],b*a[2]+c*a[5]+1*a[8]]};this.translate=function(a,c){return this.multiply(new Da([1,
0,0,0,1,0,a,c,1]))};this.scale=function(a,c){return this.multiply(new Da([a,0,0,0,c,0,0,0,1]))};this.elements=function(){return a}}function O(){return new Da([1,0,0,0,1,0,0,0,1])};function Fa(a){function b(a,b){var c=f.createRenderbuffer();this.use=function(a){f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,c);a.call(this);f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,null)};this.release=function(){f.deleteRenderbuffer(c)};this.resize=function(a,b){f.bindRenderbuffer(f.RENDERBUFFER,c);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,a,b);f.bindRenderbuffer(f.RENDERBUFFER,null)};this.resize(a,b)}function c(){var a=
f.createFramebuffer();this.use=function(b){f.bindFramebuffer(f.FRAMEBUFFER,a);b.call(this);f.bindFramebuffer(f.FRAMEBUFFER,null)};this.release=function(){f.deleteFramebuffer(a)}}function d(a,d,e,g,h){function k(){t||(t=new c,t.use(function(){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,a,0)}));return t}var m=this,r=d,p=e,t,u;this.use=function(b,c){f.activeTexture(f.TEXTURE0+b);f.bindTexture(f.TEXTURE_2D,a);c.call(this)};this.Ic=function(){return a};this.eb=function(){return r};
this.ya=function(){return p};this.release=function(){f.deleteTexture(a);t&&t.release()};this.capture=function(a,c,d,e){c=void 0===c?!1:c;var f=k();if(c){u||(u=new b(r,p));var g=u}else g=void 0;var h=g;l.Qa(d||r,e||p,function(){c?f.use(function(){h.use(a)}):f.use(a)})};this.fa=function(a,b){var c=a||r,d=b||p;l.Qa(c,d,function(){n.use(function(){n.f("aVertexPosition",q);n.i("uInput",m,0);n.o("uResolution",c,d);n.C(["aVertexPosition"]);n.W(q.h())})})};this.resize=function(b,c){r=b;p=c;f.bindTexture(f.TEXTURE_2D,
a);f.texImage2D(f.TEXTURE_2D,0,g,r,p,0,g,h,null);f.bindTexture(f.TEXTURE_2D,null);u&&u.resize(b,c)};this.wc=function(){return k()}}function e(){var a=f.createBuffer(),b,c;this.release=function(){f.deleteBuffer(a)};this.bind=function(d){f.bindBuffer(f.ARRAY_BUFFER,a);d.call(this,b,c);f.bindBuffer(f.ARRAY_BUFFER,null)};this.setData=function(a,d,e){b=d;c=e;this.bind(function(){f.bufferData(f.ARRAY_BUFFER,a,f.STATIC_DRAW)})};this.h=function(){return c}}function g(a,b,c,d,e){function g(a){var b=r[a];if(void 0===
b)throw"Unknown attribute "+a+".";return b}function l(a){var b=t[a];if(void 0===b)throw"Unknown uniform  "+a+".";return b}function k(b,c){c=f.createShader(c);f.shaderSource(c,b);f.compileShader(c);if(!f.getShaderParameter(c,f.COMPILE_STATUS))throw"Shader in program '"+a+"' failed to compile: "+f.getShaderInfoLog(c)+".";return c}var m=k(b,f.VERTEX_SHADER),n=k(c,f.FRAGMENT_SHADER),p=f.createProgram();f.attachShader(p,m);f.attachShader(p,n);f.linkProgram(p);if(!f.getProgramParameter(p,f.LINK_STATUS))throw"Could not link program '"+
a+"'.";var r=d.reduce(function(b,c){var d=f.getAttribLocation(p,c);if(0>d)throw"Failed to find location of attribute "+c+" in program "+a;b[c]=d;return b},{}),t=e.reduce(function(b,c){var d=f.getUniformLocation(p,c);if(0>d)throw"Failed to find location of uniform "+c+" in program "+a;b[c]=d;return b},{});this.C=function(a){a=K(a);for(var b=a.next();!b.done;b=a.next())f.enableVertexAttribArray(g(b.value))};this.use=function(a){f.useProgram(p);a.call(this);f.useProgram(null)};this.f=function(a,b,c,
d,e,l,k){c=void 0===c?f.FLOAT:c;d=void 0===d?!1:d;e=void 0===e?0:e;l=void 0===l?0:l;k=void 0===k?!1:k;b.bind(function(b){var m=g(a);f.vertexAttribPointer(m,b,c,d,e,l);k?h.vertexAttribDivisorANGLE(m,1):h.vertexAttribDivisorANGLE(m,0)})};this.c=function(a,b){f.uniform1f(l(a),b)};this.o=function(a,b,c){f.uniform2f(l(a),b,c)};this.jd=function(a,b,c){f.uniform3f(l("uLight"),a,b,c)};this.kd=function(a){f.uniform4fv(l("uLogoColor"),a)};this.kb=function(a,b){var c=1/255;f.uniform4f(l(a),b[0]*c,b[1]*c,b[2]*
c,b[3]*c)};this.pa=function(a){f.uniformMatrix3fv(l("uMvMatrix"),!1,a)};this.i=function(a,b,c){b.use(c,function(){f.uniform1i(l(a),c)})};this.Ea=function(a,b){h.drawArraysInstancedANGLE(f.TRIANGLE_FAN,0,void 0===b?0:b,a)};this.W=function(a){f.drawArrays(f.TRIANGLE_STRIP,0,a)};this.rb=function(a){f.drawArrays(f.POINTS,0,a)};this.release=function(){f.deleteShader(m);f.deleteShader(n);f.deleteProgram(p)}}var k=this,l=this,m=Object.assign({sb:[]},{sb:Ga}),f=a.getContext("webgl");f||(f=a.getContext("experimental-webgl"));
if(!f)throw"DotAtlas requires WebGL support";m=K(m.sb);for(var p=m.next();!p.done;p=m.next())if(p=p.value,!f.getExtension(p))throw"WebGL extension "+p+" is not supported.";var h=f.getExtension("ANGLE_instanced_arrays");if(!h)throw"WebGL extension ANGLE_instanced_arrays is required.";f.getExtension("EXT_disjoint_timer_query");this.V=f;this.canvas=a;this.createProgram=function(a){return new g(a.name,a.K,a.G,void 0===a.B?[]:a.B,void 0===a.F?[]:a.F)};this.createBuffer=function(){return new e};this.$=
function(){var a=this.createBuffer();a.setData(new Float32Array([-1,1,1,1,-1,-1,1,-1]),2,4);return a};this.createTexture=function(a,b,c,e,g,h){g=void 0===g?f.RGBA:g;h=void 0===h?f.FLOAT:h;return d.a(a,b,c,e,g,h)};this.pc=function(a,b,c,d,e,g){e=void 0===e?f.RGBA:e;g=void 0===g?f.FLOAT:g;return a?(a.resize(b,c),a):k.createTexture(null,b,c,d,e,g)};this.Va=function(a,b,c,e){c=void 0===c?f.RGBA:c;e=void 0===e?f.UNSIGNED_BYTE:e;return d.Va(a,b,c,e)};this.createFramebuffer=function(){return new c};this.Qa=
function(a,b,c){var d=f.getParameter(f.VIEWPORT);f.viewport(0,0,a,b);c();f.viewport.apply(f,d instanceof Array?d:ha(K(d)))};this.ea=function(){f.clearColor(0,0,0,0);f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT)};var n=this.createProgram({name:"fullscreen",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",G:"\n      precision mediump float;\n\n      uniform vec2 uResolution;\n      uniform sampler2D uInput;\n\n      void main() {\n        vec2 uv = vec2(gl_FragCoord.xy / uResolution.xy);\n        gl_FragColor = texture2D(uInput, uv);\n      }\n    ",
B:["aVertexPosition"],F:["uInput","uResolution"]}),q=l.$();d.a=function(a,b,c,e,g,h){g=void 0===g?f.RGBA:g;h=void 0===h?f.FLOAT:h;var l=f.createTexture();f.bindTexture(f.TEXTURE_2D,l);f.texImage2D(f.TEXTURE_2D,0,g,b,c,0,g,h,a);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,e);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.bindTexture(f.TEXTURE_2D,null);return new d(l,
b,c,g,h)};d.Va=function(a,b,c,e){var g=void 0===g?f.RGBA:g;var h=void 0===h?f.UNSIGNED_BYTE:h;var l=f.createTexture();f.bindTexture(f.TEXTURE_2D,l);f.texImage2D(f.TEXTURE_2D,0,g,g,h,a);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,e);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.bindTexture(f.TEXTURE_2D,null);return new d(l,b,c,g,h)}};function P(){var a=[];this.a=function(b){a.push(b);return b};this.g=function(b){a=a.filter(function(a){return a!==b});return b};this.b=function(b){a.forEach(function(a){return b(a)})}}function Q(){var a=this;P.call(this);this.O=function(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];a.b(function(a){return a.apply(null,c instanceof Array?c:ha(K(c)))})}}Q.prototype=Object.create(P.prototype);function Ha(a,b,c){var d=this,e=a,g=b,k=c,l,m,f,p,h=new P,n=new P,q=new P,r=new P;this.da=h.a;this.Ta=n.a;this.Ra=q.a;this.mb=r.a;this.ic=h.g;this.cd=q.g;this.s=function(){return k};this.N=function(){return e};this.U=function(){return g};this.na=function(){return e*k};this.ma=function(){return g*k};this.ha=function(){return d.na()/2};this.ga=function(){return d.ma()/2};this.Ha=function(){return l};this.Jc=function(){return m};this.Kc=function(){return f};this.Na=function(){return p};this.J=function(a,
b){e=a;g=b;h.b(function(c){return c.J(a,b)})};this.Ba=function(a){k=a;n.b(function(b){return b.Ba(a)})};this.oa=function(a){l=a;q.b(function(b){return b.oa(a)})};this.setTransform=function(a,b,c){m=a;f=b;p=c;r.b(function(d){d.setTransform(a,b,c)})}};function Ia(a,b){function c(a,c){return function(d){var e=K(b.jc(d.x,d.y)),g=e.next().value;e=e.next().value;if(a&&a.S){var f=!1;if(!1===a.S({x:g,y:e,elementX:d.x,elementY:d.y,delta:d.Ca,ctrlKey:d.ctrlKey,shiftKey:d.shiftKey,altKey:d.altKey,preventDefault:function(){return f=!0}})||f)return}d.pointX=g;d.pointY=e;c.O(d)}}var d=new Q,e={S:void 0};this.$c=d.a;this.j=function(a){return e.S=a};a.ld(c(e,d));d=new Q;var g={S:void 0};this.Tc=d.a;this.a=function(a){return g.S=a};a.click(c(g,d));d=new Q;var k=
{S:void 0};this.Uc=d.a;this.b=function(a){return k.S=a};a.qc(c(k,d));d=new Q;this.Yc=d.a;a.Pc(c({S:void 0},d));d=new Q;this.Xc=d.a;a.tc(c({S:void 0},d));d=new Q;this.Vc=d.a;a.rc(c({S:void 0},d));d=new Q;this.Wc=d.a;a.sc(c({S:void 0},d));d=new Q;var l={S:void 0};this.Zc=d.a;this.g=function(a){return l.S=a};a.move(c(l,d));a.ad(c(l,new Q))};function Ja(a,b,c,d,e,g){c=Ka(e.ta,e.coords,a,b,c,e.hb);if(g){var k=c.reduce(function(c,e){var g=d[e];c.set(e,qa(g.x,g.y,a,b));return c},new Map);c.sort(function(a,b){return k.get(a)-k.get(b)})}return c};function La(){var a=this,b=new Set;this.set=function(a){b.add(a)};this.clear=function(a){b.delete(a)};this.a=function(a){return b.delete(a)};this.b=function(b){for(var c=[],e=0;e<arguments.length;++e)c[e]=arguments[e];return c.reduce(function(b,c){return a.a(c)||b},!1)};this.g=function(b,d){a.a(b)&&d()}}D();var S=Symbol();D();var T=Symbol();D();var Ma=Symbol();D();var Na=Symbol();D();var Oa=Symbol();D();var Pa=Symbol();D();var Qa=Symbol();D();var W=Symbol();D();var Ra=Symbol();D();var Sa=Symbol();
D();var Ta=Symbol();D();var Ua=Symbol();D();var Va=Symbol();D();var Wa=Symbol();D();var Xa=Symbol();D();var Ya=Symbol();D();var Za=Symbol();function $a(a,b){var c=[new ab(b,Wa,function(a,b,c){return new bb(a,b,c)},function(a){return a.Gc()},function(b){return a.Zc(b)}),new ab(b,Xa,function(a,b,c){return new cb(a,b,c)},function(a){return a.Ec()},function(b){return a.Tc(b)}),new ab(b,Ya,function(a,b,c){return new cb(a,b,c)},function(a){return a.Fc()},function(b){return a.Yc(b)})];this.Sa=function(a){c.forEach(function(b){return b.Sa(a)})};this.ib=function(){c.forEach(function(a){return a.ib()})}}
function ab(a,b,c,d,e){function g(a){a.wa(function(c){c===b&&k(a)});k(a)}function k(b){var e=d(b);e?l.set(b,c(b,e,a)):l.delete(b)}var l=new Map;this.Sa=function(a){a.forEach(g)};this.ib=function(){l.clear()};e(function(a){for(var b=K(l),c=b.next();!c.done;c=b.next())c=K(c.value),c.next(),c.next().value.O(a)})}
function db(a,b,c,d){function e(c,d){g.x=c.pointX;g.y=c.pointY;g.ctrlKey=c.ctrlKey;g.altKey=c.altKey;g.shiftKey=c.shiftKey;g.points=d.map(function(b){return a.M()[b]});b(g)}var g={};this.O=function(b){var g=a.M(),k=a.cb(),f=.5*a.cc()*a.Ma(c)*c.Ha().v/(c.N()*c.s()*c.Na());g=Ja(b.pointX,b.pointY,f,g,k,!0);d(b,g,e)}}function cb(a,b,c){this.O=(new db(a,b,c,function(a,b,c){c(a,b)})).O}
function bb(a,b,c){var d=null;this.O=(new db(a,b,c,function(a,b,c){if(null===d)0!==b.length&&(d=b,c(a,b));else if(b.length===d.length)for(var e=0;e<b.length;e++){if(b[e]!==d[e]){d=b;c(a,b);break}}else d=b,c(a,b)})).O};function eb(a){var b=a.V,c=a.createProgram({name:"blur",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",G:"\n      precision mediump float;\n\n      uniform vec2 uOutputSize;\n      uniform sampler2D uInput;\n      uniform vec2 uInputSize;\n      \n      \n  vec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w) * (1.0/6.0);\n  }\n  \n  vec4 textureBicubic(sampler2D sampler, vec2 texSize, vec2 texCoords) {\n    vec2 invTexSize = 1.0 / texSize;\n     \n    texCoords = texCoords * texSize - 0.5;\n     \n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2(-0.5, +1.5).xyxy;\n    \n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4(xcubic.yw, ycubic.yw) / s;\n    \n    offset *= invTexSize.xxyy;\n    \n    vec4 sample0 = texture2D(sampler, offset.xz);\n    vec4 sample1 = texture2D(sampler, offset.yz);\n    vec4 sample2 = texture2D(sampler, offset.xw);\n    vec4 sample3 = texture2D(sampler, offset.yw);\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(mix(sample3, sample2, sx), mix(sample1, sample0, sx) , sy);\n  }\n\n\n      void main() {\n        vec2 uv = vec2(gl_FragCoord.xy / uOutputSize.xy);\n        gl_FragColor = textureBicubic(uInput, uInputSize.xy, uv);\n      }\n    ",
B:["aVertexPosition"],F:["uInput","uInputSize","uOutputSize"]}),d=a.$(),e=a.createFramebuffer();this.resize=function(g,k,l,m,f,p){e.use(function(){b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,m.Ic(),0)});b.disable(b.BLEND);a.Qa(f,p,function(){e.use(function(){b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT);c.use(function(){c.f("aVertexPosition",d);c.i("uInput",g,0);c.o("uInputSize",k,l);c.o("uOutputSize",f,p);c.C(["aVertexPosition"]);c.W(d.h())})})})}};function fb(a,b){function c(c,d){function f(a,b,c,d){b.capture(function(){k.use(function(){k.f("aVertexPosition",v);k.i("uSampler",a,0);k.o("increment",c,d);k.C(["aVertexPosition"]);k.W(v.h())})},!1,n,p)}var h=c.X(),l=c.Hc(),n=m.width()+m.margin(),p=m.height()+m.margin();e.viewport(0,0,n,p);e.enable(e.BLEND);e.blendEquation(e.FUNC_ADD);e.blendFunc(e.ONE,e.ONE);e.clearColor(0,0,0,0);var x=Math.min(h.Vb(),l.h());0===x?r.capture(function(){a.ea()},!1,n,p):(r.capture(function(){a.ea();g.use(function(){var a=
b.Ha();g.c("uMaxRadius",Math.min(a.v,a.D)/h.Wb());g.c("uRadiusPow",h.vb());g.f("aVertexPosition",u,e.BYTE,!0);g.f("aPointData",l,e.FLOAT,!1,0,0,!0);g.i("uProfile",q,0);g.pa(d.elements());g.C(["aVertexPosition","aPointData"]);g.Ea(x,u.h())})},!1,n,p),e.disable(e.BLEND),f(r,t,1,0),f(t,r,0,1))}var d=this,e=a.V,g=a.createProgram({name:"heightmap",K:"\n      precision mediump float;\n      uniform float uMaxRadius;\n      uniform float uRadiusPow;\n      uniform float uCircumToInscribedRadius;\n\n      attribute vec2 aVertexPosition;\n      attribute vec3 aPointData;\n\n      varying vec2 coordinate;\n      varying vec3 pointData;\n\n      uniform mat3 uMvMatrix;\n\n      void main(void) {\n        float radius = pow(aPointData.z, uRadiusPow) * uMaxRadius;\n        // If we switch to representing elevations by some other shape,\n        // we'd need to pass a different scaling factor.\n        // We need the factor because the coordinates are passed in as\n        // unsigned bytes and normalized to the 0..1 range by the GPU.\n        // Here we need a triangle with inscribed circle of radius 1.0,\n        // that's why we need to apply the extra scaling.\n        vec2 scaled = uCircumToInscribedRadius * aVertexPosition * radius + aPointData.xy;      \n      \n        gl_Position = vec4(uMvMatrix * vec3(scaled, 1.0), 1.0);\n        coordinate = scaled;\n        pointData = aPointData;\n      }\n    ",
G:"\n      precision mediump float;\n      uniform float uMaxRadius;\n      uniform float uRadiusPow;\n      uniform sampler2D uProfile;\n\n      varying vec2 coordinate;\n      varying vec3 pointData;\n\n      void main(void) {\n        float radius = pow(pointData.z, uRadiusPow) * uMaxRadius;\n        float d = length(coordinate - pointData.xy) / radius;\n        float h = radius * texture2D(uProfile, vec2(d, 0.0)).r;\n\n        gl_FragColor = vec4(h, 0.0, 0.0, 0.0);\n      }\n    ",B:["aVertexPosition",
"aPointData"],F:["uMaxRadius","uRadiusPow","uCircumToInscribedRadius","uMvMatrix","uProfile"]}),k=a.createProgram({name:"prefiltering",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",G:"\n      precision mediump float;\n      uniform sampler2D uSampler;                                                 \n      uniform vec2 increment;                                                     \n      uniform vec2 uTextureResolution;\n\n      void main(void) {                                         \n        vec2 vTextureCoord = gl_FragCoord.xy / uTextureResolution;\n        vec4 w = 1.732176555 * texture2D(uSampler, vTextureCoord);              \n        vec2 inc = increment / uTextureResolution;\n        vec2 im = vTextureCoord - inc;                                    \n        vec2 ip = vTextureCoord + inc;                                    \n        w -= 0.464135309 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w += 0.124364681 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w -= 0.033323416 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w += 0.008928982 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w -= 0.002392514 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w += 0.000641072 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        im -= inc; ip += inc;                                       \n        w -= 0.000171775 * (texture2D(uSampler,im)+texture2D(uSampler,ip));     \n        gl_FragColor = w;                                                       \n      }\n    ",
B:["aVertexPosition"],F:["uSampler","uTextureResolution","increment"]});a.createProgram({name:"prefiltering",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",G:"\n      precision mediump float;\n      uniform sampler2D uHeightmap;                                                 \n      uniform vec2 uTextureResolution;\n\n      void main(void) {                                         \n        vec2 vTextureCoord = gl_FragCoord.xy / uTextureResolution;\n        \n        // < 0 values are filtering artifacts, they mess with\n        // modulos, so stick to >= 0 heights.\n        float h = max(0.0, texture2D(uHeightmap, vTextureCoord).r);     \n        \n        // Pack the float into 4 bytes. GLSL uses 0..1 normalized\n        // floats for 0..255 bytes, hence the division by 256.0.\n        gl_FragColor = vec4(\n          mod(floor(h / 65536.0), 256.0) / 256.0, \n          mod(h / 256.0, 256.0) / 256.0, \n          mod(h, 256.0) / 256.0, \n          fract(h)\n        );                                                       \n      }\n    ",
B:["aVertexPosition"],F:["uHeightmap","uTextureResolution"]});var l=a.createProgram({name:"toBytes",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",G:"\n      precision mediump float;\n      uniform sampler2D uHeightmap;                                                 \n      uniform vec2 uTextureSize;\n      uniform vec2 uViewportSize;\n      uniform float uElevationOffset;\n      uniform float uMax;\n      \n      \n  vec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w) * (1.0/6.0);\n  }\n  \n  vec4 textureBicubic(sampler2D sampler, vec2 texSize, vec2 texCoords) {\n    vec2 invTexSize = 1.0 / texSize;\n     \n    texCoords = texCoords * texSize - 0.5;\n     \n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2(-0.5, +1.5).xyxy;\n    \n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4(xcubic.yw, ycubic.yw) / s;\n    \n    offset *= invTexSize.xxyy;\n    \n    vec4 sample0 = texture2D(sampler, offset.xz);\n    vec4 sample1 = texture2D(sampler, offset.yz);\n    vec4 sample2 = texture2D(sampler, offset.xw);\n    vec4 sample3 = texture2D(sampler, offset.yw);\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(mix(sample3, sample2, sx), mix(sample1, sample0, sx) , sy);\n  }\n\n\n      void main(void) {                                         \n        // < 0 values are filtering artifacts, they mess with\n        // modulos, so stick to >= 0 heights.\n        float h = max(0.0, textureBicubic(uHeightmap, uTextureSize, \n            gl_FragCoord.xy / uViewportSize).x + uElevationOffset);\n\n        // Pack the float into 4 bytes. GLSL uses 0..1 normalized\n        // floats for 0..255 bytes, hence the division by 256.0.\n        gl_FragColor = vec4(\n          mod(floor(h / 65536.0), 256.0) / 256.0, \n          mod(h / 256.0, 256.0) / 256.0, \n          mod(h, 256.0) / 256.0, \n          fract(h)\n        );\n      }\n    ",
B:["aVertexPosition"],F:["uHeightmap","uTextureSize","uViewportSize","uElevationOffset"]}),m,f,p,h,n,q=function(b){for(var c=wa(.2,0,.15),d=new Float32Array(4*b),f=0;f<d.length;)d[f]=1-c((f>>2)/(b-1)),f+=4;return a.createTexture(d,d.length>>2,1,e.LINEAR)}(e.getParameter(e.MAX_TEXTURE_SIZE)),r,t,u=a.createBuffer(),y=function(a){for(var b=2*Math.PI/3,c=1/Math.cos(b/2),d=127/c,e=1/Math.cos(b/2),f=new Int8Array(6),g=0,h=0;3>h;h++){var l=h*b;f[g++]=d*c*Math.sin(l);f[g++]=d*c*Math.cos(l)}a.setData(f,2,
3);return e}(u);g.use(function(){g.c("uCircumToInscribedRadius",y)});var v=a.$(),z=new Uint8Array(4);this.g=function(b){function c(b,c){c=void 0===c?e.FLOAT:c;var d=m.va(),f=m.ua();return b?(b.resize(d,f),b):a.createTexture(null,d,f,e.LINEAR,e.RGBA,c)}m=b;r=c(r);t=c(t);k.use(function(){k.o("uTextureResolution",m.va(),m.ua())});h=!0};this.ia=function(a){p=a;h=!0};this.Y=function(a){f=a};this.a=function(a,b){var d=a.ca(),e=a.oc();if(b||d||e||h)h=!1,n=!0,c(a,b||p)};this.u=function(a,b,c){d.b(z,a,b,1,
1,c);return z[3]/256+z[2]+256*z[1]+65536*z[0]};this.b=function(a,b,c,f,g,h,k){d.a(h,k);var p=h.wb(),q=h.X();n&&(p.capture(function(){e.clear(e.COLOR_BUFFER_BIT);e.disable(e.BLEND);l.use(function(){l.c("uElevationOffset",void 0===q.Ka()?0:q.Ka()*q.Xa());l.f("aVertexPosition",v);l.i("uHeightmap",r,0);l.o("uViewportSize",m.va()*m.Fa()*m.Ga()/2,m.ua()*m.Fa()*m.Ga()/2);l.o("uTextureSize",m.va(),m.ua());l.C(["aVertexPosition"]);l.W(v.h())});e.enable(e.BLEND)}),n=!1);p.wc().use(function(){e.readPixels(b,
g===p.ya()?c:p.ya()-c,f,g,e.RGBA,e.UNSIGNED_BYTE,a)})};this.P=function(a){var b=a.wb(),c=b.eb(),d=b.ya();b=new Uint8Array(c*d*4);this.b(b,0,0,c,d,a,f);for(c=a=0;c<b.length;)d=b[c+3]/256+b[c+2]+256*b[c+1]+65536*b[c],a<d&&(a=d),c+=4;0===a&&(a=1);return a};this.release=function(){q.release();r.release();t.release();u.release();v.release()};this.j=function(){return r}}
function gb(a,b,c){function d(){var a=new Float32Array(3*l.length),b=0,c=l.slice(0).sort(function(a,b){return(b.elevation||0)-(a.elevation||0)});if(0<c.length){var d=c[0].elevation||0;for(var e=K(c),f=e.next();!f.done;f=e.next())f=f.value,d<f.elevation&&(d=f.elevation)}else d=1;e=K(c);for(f=e.next();!f.done;f=e.next())f=f.value,a[b++]=f.x,a[b++]=f.y,a[b++]=(f.elevation||0)/d;m.setData(a,3,c.length)}var e=this,g=a.V,k=new La;c.wa(function(a){k.set(a)});k.set(S);k.set(Za);var l,m=a.createBuffer(),f,
p,h;this.X=function(){return c};this.T=function(){return b};this.ca=function(){if(k.b(S,T))return l=c.M(),d(),!0;if(k.a(Za)){for(var b=g.getParameter(g.MAX_TEXTURE_SIZE),e=c.Ia(),h=new Float32Array(4*b),m=0,n=0;m<h.length;){for(var v=(m>>2)/(b-1);e[n].end<v;)n++;v=e[n];h[m++]=v.color[0]/256;h[m++]=v.color[1]/256;h[m++]=v.color[2]/256;h[m++]=v.shading?1:0}f=a.createTexture(h,h.length>>2,1,g.NEAREST);h=g.getParameter(g.MAX_TEXTURE_SIZE);e=c.Ia();b=new Float32Array(4*h);for(n=m=0;m<b.length;){for(v=
(m>>2)/(h-1);e[n].end<v;)n++;b[m++]=0===n?0:e[n-1].end;b[m++]=e[n].end;m++;m++}for(h=0;!e[h].contours;)h++;if(h<e.length)for(e=(Math.floor((e[h-1].end+(h+1<e.length?e[h].end:1))/2*(b.length>>2))<<2)+2;0<=e;e-=4)b[e]=1;p=a.createTexture(b,b.length>>2,1,g.NEAREST)}return!1};this.oc=function(){return k.a(Qa)};this.Hc=function(){return m};this.uc=function(){return f};this.vc=function(){return p};this.wb=function(){return h};var n;this.Aa=function(a){n=a;n.da(e);e.J()};this.release=function(){m.release();
f.release();p.release()};this.J=function(){h=a.pc(h,n.N(),n.U(),g.NEAREST,g.RGBA,g.UNSIGNED_BYTE)}};function hb(a,b){var c=a.V,d=a.createProgram({name:"shading",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",G:"\n      #extension GL_OES_standard_derivatives : enable\n      precision mediump float;\n      uniform sampler2D uFbTexture;\n      uniform sampler2D uBandsTexture;\n      uniform sampler2D uBandLevelsTexture;\n      uniform sampler2D uMaskTexture;\n      uniform vec2 uViewportSize;\n      uniform vec2 uViewport;\n      uniform vec2 uTextureSize;\n      uniform float uMax;\n      uniform float uElevationOffset;\n      uniform vec3 uLight;\n      uniform float uLightIntensity;\n      uniform float uPixelNorm;\n      uniform float uContourOpacity;\n      uniform float uContourWidth;\n      uniform float uOpacity;\n      uniform float uSaturation;\n      uniform float uLightness;\n      uniform vec4 uLabelShadowColor;\n      uniform float uLabelShadowSize;\n\n      \n  vec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w) * (1.0/6.0);\n  }\n  \n  vec4 textureBicubic(sampler2D sampler, vec2 texSize, vec2 texCoords) {\n    vec2 invTexSize = 1.0 / texSize;\n     \n    texCoords = texCoords * texSize - 0.5;\n     \n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2(-0.5, +1.5).xyxy;\n    \n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4(xcubic.yw, ycubic.yw) / s;\n    \n    offset *= invTexSize.xxyy;\n    \n    vec4 sample0 = texture2D(sampler, offset.xz);\n    vec4 sample1 = texture2D(sampler, offset.yz);\n    vec4 sample2 = texture2D(sampler, offset.xw);\n    vec4 sample3 = texture2D(sampler, offset.yw);\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(mix(sample3, sample2, sx), mix(sample1, sample0, sx) , sy);\n  }\n\n      \n      float Epsilon = 1e-10;\n \n      vec3 RGBtoHCV(vec3 RGB)\n      {\n        // Based on work by Sam Hocevar and Emil Persson\n        vec4 P = (RGB.g < RGB.b) ? vec4(RGB.bg, -1.0, 2.0/3.0) : vec4(RGB.gb, 0.0, -1.0/3.0);\n        vec4 Q = (RGB.r < P.x) ? vec4(P.xyw, RGB.r) : vec4(RGB.r, P.yzx);\n        float C = Q.x - min(Q.w, Q.y);\n        float H = abs((Q.w - Q.y) / (6.0 * C + Epsilon) + Q.z);\n        return vec3(H, C, Q.x);\n      }\n      \n      vec3 RGBtoHSL(vec3 RGB)\n      {\n        vec3 HCV = RGBtoHCV(RGB);\n        float L = HCV.z - HCV.y * 0.5;\n        float S = HCV.y / (1.0 - abs(L * 2.0 - 1.0) + Epsilon);\n        return vec3(HCV.x, S, L);\n      }\n      \n      vec3 HUEtoRGB(float H)\n      {\n        float R = abs(H * 6.0 - 3.0) - 1.0;\n        float G = 2.0 - abs(H * 6.0 - 2.0);\n        float B = 2.0 - abs(H * 6.0 - 4.0);\n        return clamp(vec3(R, G, B), 0.0, 1.0);\n      }\n      \n      vec3 HSLtoRGB(vec3 HSL)\n      {\n        vec3 RGB = HUEtoRGB(HSL.x);\n        float C = (1.0 - abs(2.0 * HSL.z - 1.0)) * HSL.y;\n        return (RGB - 0.5) * C + HSL.z;\n      }\n      \n      void main(void) {\n        // Unpack 3 half-floats into a float to recover some more precision.\n        // vec3 ph = texture2D(uFbTexture, vTexturePosition).xyz;\n        // float h = (ph.x + (ph.y + ph.z) / 64.0) / (32.0 * uMax);\n\n        // Map height at the currently processed pixel.\n        // float h = texture2D(uFbTexture, gl_FragCoord.xy / uViewportSize).x / uMax;\n        float h = textureBicubic(uFbTexture, uTextureSize, gl_FragCoord.xy / uViewportSize).x / uMax + uElevationOffset;\n  \n        // Height deltas along x and y.\n        float dhx = dFdx(h);\n        float dhy = dFdy(h);\n  \n        // Band colors and the corresponding height levels.\n        vec4 bandColor = texture2D(uBandsTexture, vec2(h, 0.0));\n        vec4 bandLevels = texture2D(uBandLevelsTexture, vec2(h, 0.0));\n  \n        // Distance to the nearest band's boundary height.\n        // We can get a negative value here due to sampling, hence abs().\n        float dh = abs(min(h - bandLevels.r, bandLevels.g - h));\n  \n        // Detect band boundary edges and mark them.\n        float skipContouringFlag = bandLevels.b;\n        float dsx = dh / sqrt(dhx * dhx + dhy * dhy);\n        \n        // Label mask, applies to contours only\n        float mask = min(1.0, texture2D(uMaskTexture, gl_FragCoord.xy / uViewport).a * 8.0);\n\n        float multiplier = mix(max(max(skipContouringFlag, 1.0 - uContourOpacity), mask), 1.0, smoothstep(0.0, uContourWidth, dsx));\n  \n        // Lighting.\n        vec3 normal = vec3(dhx, dhy, uPixelNorm); // surface normal (cross product folded in and simplified to avoid useless computation)\n        float lightCos = (uLightIntensity * dot(normal, uLight) / length(normal) + 1.0) / 2.0;\n  \n        // Compose the final pixel color.\n        // bandColor.a contains a flag: 1.0 to light-shade the band color, 0.0 not to shade\n        float shadingFlag = bandColor.a;\n        float light = mix(0.5, lightCos, shadingFlag);\n        \n        // Lighten or darken depending on light\n        // TODO: use HSL to apply lighting?\n        vec3 color = bandColor.rgb * step(0.5, 1.0 - light) * (light * 2.0) +\n                     (bandColor.rgb + (1.0 - bandColor.rgb) * (light - 0.5) * 2.0) * (1.0 - step(0.5, 1.0 - light));\n                     \n        vec3 colorHsl = RGBtoHSL(color);\n        \n        gl_FragColor = vec4(HSLtoRGB(clamp(colorHsl + vec3(0.0, uSaturation, uLightness), 0.0, 1.0)) * multiplier, uOpacity);                                                       \n      }\n    ",
B:["aVertexPosition"],F:"fbTextureBuffer uBandsTexture uBandLevelsTexture uViewportSize uTextureSize uMax uLight uPixelNorm uContourWidth uContourOpacity uLightIntensity uOpacity uSaturation uLightness uMaskTexture uViewport uElevationOffset uLabelShadowColor uLabelShadowSize".split(" ")}),e,g=a.$();this.a=function(a){e=a};this.b=function(a,l,m,f,p){var h=a.X();a.ca();d.use(function(){c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);
d.c("uContourWidth",h.ub()*b.s());d.c("uElevationOffset",h.Xa());d.c("uLightness",h.$a());d.c("uSaturation",h.dc());d.c("uContourOpacity",h.tb());d.c("uLightIntensity",h.Ob());d.c("uOpacity",h.La());d.jd(Math.cos(h.Za())*Math.cos(h.Ja()),Math.sin(h.Za())*Math.cos(h.Ja()),Math.sin(h.Ja()));d.f("aVertexPosition",g);d.i("fbTextureBuffer",l,0);d.i("uBandsTexture",a.uc(),1);d.i("uBandLevelsTexture",a.vc(),2);p?d.i("uMaskTexture",p,3):d.i("uMaskTexture",a.T().Wa(),3);d.c("uMax",m);d.o("uViewportSize",e.va()*
e.Fa()*e.Ga(),e.ua()*e.Fa()*e.Ga());d.o("uTextureSize",e.va(),e.ua());d.c("uPixelNorm",2/(f*b.N()*b.s()));d.o("uViewport",b.N()*b.s(),b.U()*b.s());d.C(["aVertexPosition"]);d.W(g.h())})};this.release=function(){g.release()}};function ib(a,b,c,d,e,g){if(!(e-d<=c)){var k=Math.floor((d+e)/2);jb(a,b,k,d,e,g%2);ib(a,b,c,d,k-1,g+1);ib(a,b,c,k+1,e,g+1)}}
function jb(a,b,c,d,e,g){for(;e>d;){if(600<e-d){var k=e-d+1,l=c-d+1,m=Math.log(k),f=.5*Math.exp(2*m/3);m=.5*Math.sqrt(m*f*(k-f)/k)*(0>l-k/2?-1:1);jb(a,b,c,Math.max(d,Math.floor(c-l*f/k+m)),Math.min(e,Math.floor(c+(k-l)*f/k+m)),g)}k=b[2*c+g];l=d;f=e;kb(a,b,d,c);for(b[2*e+g]>k&&kb(a,b,d,e);l<f;){kb(a,b,l,f);l++;for(f--;b[2*l+g]<k;)l++;for(;b[2*f+g]>k;)f--}b[2*d+g]===k?kb(a,b,d,f):(f++,kb(a,b,f,e));f<=c&&(d=f+1);c<=f&&(e=f-1)}}function kb(a,b,c,d){lb(a,c,d);lb(b,2*c,2*d);lb(b,2*c+1,2*d+1)}
function lb(a,b,c){var d=a[b];a[b]=a[c];a[c]=d};function Ka(a,b,c,d,e,g){for(var k=[0,a.length-1,0],l=[],m=e*e;k.length;){var f=k.pop(),p=k.pop(),h=k.pop();if(p-h<=g)for(f=h;f<=p;f++){h=b[2*f]-c;var n=b[2*f+1]-d;h*h+n*n<=m&&l.push(a[f])}else{n=Math.floor((h+p)/2);var q=b[2*n],r=b[2*n+1],t=q-c,u=r-d;t*t+u*u<=m&&l.push(a[n]);t=(f+1)%2;if(0===f?c-e<=q:d-e<=r)k.push(h),k.push(n-1),k.push(t);if(0===f?c+e>=q:d+e>=r)k.push(n+1),k.push(p),k.push(t)}}return l};function mb(a){var b=b||nb;var c=c||ob;var d=d||Array;this.hb=64;this.a=a;this.ta=new d(a.length);this.coords=new d(2*a.length);for(d=0;d<a.length;d++)this.ta[d]=d,this.coords[2*d]=b(a[d]),this.coords[2*d+1]=c(a[d]);ib(this.ta,this.coords,64,0,this.ta.length-1,0)}mb.prototype={};function nb(a){return a[0]}function ob(a){return a[1]};function pb(a,b,c,d,e,g,k,l){function m(c,g){c=Ka(b.ta,b.coords,c,g,p,b.hb);if(c.length>=h){g=Math.min(1,50/c.length);for(var l=0;l<c.length;l++){var k=c[l];if(!n.has(k)){var m=a[k];qa(m.x,m.y,d,e)<f&&((1===g||Math.random()<=g)&&r.push(k),q.push(k),n.add(k))}}}return!1}c=Math.min(c.v,c.D);var f=Math.pow(c*l,2),p=c*g*Math.sqrt(1/a.length);g=Ka(b.ta,b.coords,d,e,p,b.hb).length;var h=Math.min(1,g)*k,n=new Set,q=[],r=[];for(m(d,e);0<r.length;)k=r.pop(),m(a[k].x,a[k].y);return q.map(function(b){return a[b]})}
;function Y(a){function b(a){return x=a}function c(a){w=a;n.O(Ya)}function d(a){z=a;n.O(Xa)}function e(a){v=a;n.O(Wa)}function g(a){a=Object.assign({radius:.4,density:0,maxClusterRadius:.1},a);var b=a.startX,c=a.startY;if(void 0===b||void 0===c)throw"Start coordinates are required";return Promise.resolve(pb(q,h.cb(),l(),b,c,a.radius,a.density,a.maxClusterRadius))}function k(a){a=Object.assign({radiusDivider:20,sortByDistance:!1},a);var b=a.startX,c=a.startY;if(void 0===b||void 0===c)throw"Start coordinates are required";
var d=l();a=Ja(b,c,Math.min(d.v,d.D)/a.radiusDivider,q,h.cb(),a.sortByDistance);return Promise.resolve(a.map(function(a){return q[a]}))}function l(){void 0===t&&(t=Ca().lb(q).pb());return t}function m(a){return y=a}function f(a){return u=a}function p(a){var b=h.g();h.Oa(a);if(b&&(b=b.get(a))){n.O(b);return}"xy"===a&&n.O(T)}var h=this,n=new Q;this.wa=n.a;this.a=n.O;this.g=function(){};this.Z=function(){};this.Oa=function(){};var q,r,t;this.M=function(){return q};this.b=function(a){a?q=a.slice(0):q=
[];r=void 0;n.O(S)};this.fb=function(){h.b(a.points)};var u=!0;this.gb=function(){return u};var y=1;this.La=function(){return y};this.cb=function(){void 0===r&&(r=new mb(q.map(function(a){return[a.x,a.y]})));return r};this.Y=function(a){return Object.assign(a,{points:{get:h.M,set:h.b},visible:{get:h.gb,set:f},opacity:{get:h.La,set:m},pointHoverRadiusMultiplier:{get:h.cc,set:b}})};this.P=function(a){return Object.assign(a,{update:p,cluster:g,within:k})};var v=void 0;this.Gc=function(){return v};var z=
void 0;this.Ec=function(){return z};var w=void 0;this.Fc=function(){return w};var x=2;this.cc=function(){return x};this.Ma=function(a){return a.s()*Math.min(Math.sqrt(a.Na()),4)};this.j=function(a){return Object.assign(a,{onPointHover:e,onPointClick:d,onPointHold:c})};this.u=function(a){return Object.assign(a,{type:{get:h.Z}})}};function qb(a){function b(){e=void 0;c.a(Qa)}var c=this;Y.call(this,a);this.xa=function(){return w};this.Z=function(){return"elevation"};var d=new Map;d.set("elevation",S);this.g=function(){return d};var e,g=this.b;this.b=function(a){g.call(c,a);e=void 0};var k;this.ed=function(a){k=a};var l=.5;this.vb=function(){return l};var m=20;this.Wb=function(){return m};var f=Number.MAX_SAFE_INTEGER;this.Vb=function(){return f};var p=0;this.Xa=function(){return p};var h=.9;this.ub=function(){return h};var n=
.2;this.tb=function(){return n};var q=0;this.$a=function(){return q};var r=0;this.dc=function(){return r};var t=2*Math.PI-Math.PI/2-Math.PI/4;this.Za=function(){return t};var u=Math.PI-Math.PI/8;this.Ja=function(){return u};var y=.15;this.Ob=function(){return y};var v=[{end:3E-4,color:[141,193,234],shading:!1,contours:!1},{end:.005,color:[161,210,247],shading:!1,contours:!1},{end:.02,color:[185,227,255],shading:!1,contours:!0},{end:.05,color:[172,208,165],shading:!0,contours:!0},{end:.1,color:[148,
191,139],shading:!0,contours:!0},{end:.15,color:[168,198,143],shading:!0,contours:!0},{end:.2,color:[189,204,150],shading:!0,contours:!0},{end:.3,color:[209,215,171],shading:!0,contours:!0},{end:.4,color:[239,235,192],shading:!0,contours:!0},{end:.5,color:[222,214,163],shading:!0,contours:!0},{end:.6,color:[211,202,157],shading:!0,contours:!0},{end:.7,color:[202,185,130],shading:!0,contours:!0},{end:.8,color:[192,154,83],shading:!0,contours:!0},{end:.85,color:[224,224,224],shading:!0,contours:!0},
{end:.9,color:[236,236,236],shading:!0,contours:!0},{end:1,color:[255,255,255],shading:!0,contours:!0}];this.Ia=function(){return v};var z=void 0;this.Ka=function(){return e};this.fd=function(a){e=a;z&&z(a)};var w=ka(this,a,{options:this.Y({elevationPow:{get:this.vb,set:function(a){b();return l=a}},maxRadiusDivider:{get:this.Wb,set:function(a){b();return m=a}},maxElevationPoints:{get:this.Vb,set:function(a){b();return f=a}},elevationOffset:{get:this.Xa,set:function(a){return p=a}},lightness:{get:this.$a,
set:function(a){return q=a}},saturation:{get:this.dc,set:function(a){return r=a}},contourOpacity:{get:this.tb,set:function(a){return n=a}},contourWidth:{get:this.ub,set:function(a){return h=a}},lightAzimuth:{get:this.Za,set:function(a){return t=a}},lightAltitude:{get:this.Ja,set:function(a){return u=a}},lightIntensity:{get:this.Ob,set:function(a){return y=a}},colorBands:{get:this.Ia,set:function(a){v=a;c.a(Za)}}}),getters:this.u({maxElevation:{get:this.Ka},elevationAt:{get:function(a,b){return k&&
k(a,b)}}}),events:this.j({onMaxElevationChanged:function(a){return z=a}}),methods:this.P({})})}qb.prototype=Object.create(Y.prototype);function rb(a,b,c,d){var e=2*c,g,k,l,m;(function(){var f=Math.ceil(c*a/e),p=Math.ceil(c*b/e);g=f+8;k=p+8;l=f/d;m=p/d})();this.Ga=function(){return d};this.Fa=function(){return e};this.va=function(){return g};this.ua=function(){return k};this.width=function(){return l};this.height=function(){return m};this.margin=function(){return 8}};function sb(a,b,c,d,e){c=c||0;d=d||a.length-1;for(e=e||tb;d>c;){if(600<d-c){var g=d-c+1,k=b-c+1,l=Math.log(g),m=.5*Math.exp(2*l/3);l=.5*Math.sqrt(l*m*(g-m)/g)*(0>k-g/2?-1:1);sb(a,b,Math.max(c,Math.floor(b-k*m/g+l)),Math.min(d,Math.floor(b+(g-k)*m/g+l)),e)}g=a[b];k=c;m=d;ub(a,c,b);for(0<e(a[d],g)&&ub(a,c,d);k<m;){ub(a,k,m);k++;for(m--;0>e(a[k],g);)k++;for(;0<e(a[m],g);)m--}0===e(a[c],g)?ub(a,c,m):(m++,ub(a,m,d));m<=b&&(c=m+1);b<=m&&(d=m-1)}}function ub(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}
function tb(a,b){return a<b?-1:a>b?1:0};function vb(a,b){if(!(this instanceof vb))return new vb(a,b);this.b=Math.max(4,a||9);this.u=Math.max(2,Math.ceil(.4*this.b));b&&(a=["return a"," - b",";"],this.g=new Function("a","b",a.join(b[0])),this.j=new Function("a","b",a.join(b[1])),this.a=new Function("a","return {minX: a"+b[0]+", minY: a"+b[1]+", maxX: a"+b[2]+", maxY: a"+b[3]+"};"));this.clear()}
function wb(a,b,c,d,e){var g=d-c+1,k=a.b;if(g<=k){var l=xb(b.slice(c,d+1));yb(l,a.a);return l}e||(e=Math.ceil(Math.log(g)/Math.log(k)),k=Math.ceil(g/Math.pow(k,e-1)));l=xb([]);l.R=!1;l.height=e;g=Math.ceil(g/k);k=g*Math.ceil(Math.sqrt(k));var m;for(zb(b,c,d,k,a.g);c<=d;c+=k){var f=Math.min(c+k-1,d);zb(b,c,f,g,a.j);for(m=c;m<=f;m+=g){var p=Math.min(m+g-1,f);l.children.push(wb(a,b,m,p,e-1))}}yb(l,a.a);return l}function Ab(a,b,c){a.data=xb([b,c]);a.data.height=b.height+1;a.data.R=!1;yb(a.data,a.a)}
function Bb(a,b,c,d){var e=a.a.bind(a);d=d?b:e(b);e=[];for(var g,k=a.data,l=c,m,f,p,h,n,q,r;;){e.push(k);if(k.R||e.length-1===l)break;q=r=Infinity;m=0;for(f=k.children.length;m<f;m++)p=k.children[m],h=Cb(p),n=(Math.max(p.H,d.H)-Math.min(p.w,d.w))*(Math.max(p.I,d.I)-Math.min(p.A,d.A))-h,n<r?(r=n,q=h<q?h:q,g=p):n===r&&h<q&&(q=h,g=p);k=g||k.children[0]}g=k;g.children.push(b);for(Db(g,d);0<=c;)if(e[c].children.length>a.b){b=a;g=e;k=c;l=g[k];m=l.children.length;n=b.u;q=b;f=l;r=n;var t=m;p=f.R?q.g:Eb;var u=
f.R?q.j:Fb;h=Gb(q,f,r,t,p);q=Gb(q,f,r,t,u);h<q&&f.children.sort(p);f=void 0;p=b;h=l;u=m;q=m=Infinity;for(t=n;t<=u-n;t++){var y=Hb(h,0,t,p.a,void 0);var v=Hb(h,t,u,p.a,void 0);r=Math.max(0,Math.min(y.H,v.H)-Math.max(y.w,v.w))*Math.max(0,Math.min(y.I,v.I)-Math.max(y.A,v.A));v=Cb(y)+Cb(v);r<q?(q=r,f=t,m=v<m?v:m):r===q&&v<m&&(m=v,f=t)}m=f;m=xb(l.children.splice(m,l.children.length-m));m.height=l.height;m.R=l.R;yb(l,b.a);yb(m,b.a);k?g[k-1].children.push(m):Ab(b,l,m);c--}else break;for(a=c;0<=a;a--)Db(e[a],
d)}function Gb(a,b,c,d,e){b.children.sort(e);a=a.a.bind(a);e=Hb(b,0,c,a,void 0);var g=Hb(b,d-c,d,a,void 0),k=Ib(e)+Ib(g),l;for(l=c;l<d-c;l++){var m=b.children[l];Db(e,b.R?a(m):m);k+=Ib(e)}for(l=d-c-1;l>=c;l--)m=b.children[l],Db(g,b.R?a(m):m),k+=Ib(g);return k}
vb.prototype={search:function(a){var b=this.data,c=[],d=this.a.bind(this);if(!Jb(a,b))return c;for(var e=[],g,k,l,m;b;){g=0;for(k=b.children.length;g<k;g++)if(l=b.children[g],m=b.R?d(l):l,Jb(a,m))if(b.R)c.push(l);else if(a.w<=m.w&&a.A<=m.A&&m.H<=a.H&&m.I<=a.I){m=c;for(var f=[];l;)l.R?m.push.apply(m,l.children):f.push.apply(f,l.children),l=f.pop()}else e.push(l);b=e.pop()}return c},load:function(a){if(!a||!a.length)return this;if(a.length<this.u){for(var b=0,c=a.length;b<c;b++){var d=a[b];d&&Bb(this,
d,this.data.height-1,!1)}return this}a=wb(this,a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?Ab(this,this.data,a):(this.data.height<a.height&&(b=this.data,this.data=a,a=b),Bb(this,a,this.data.height-a.height-1,!0)):this.data=a;return this},clear:function(){this.data=xb([]);return this},a:function(a){return a},g:Eb,j:Fb,toJSON:function(){return this.data}};function yb(a,b){Hb(a,0,a.children.length,b,a)}
function Hb(a,b,c,d,e){e||(e=xb(null));e.w=Infinity;e.A=Infinity;e.H=-Infinity;e.I=-Infinity;for(var g;b<c;b++)g=a.children[b],Db(e,a.R?d(g):g);return e}function Db(a,b){a.w=Math.min(a.w,b.w);a.A=Math.min(a.A,b.A);a.H=Math.max(a.H,b.H);a.I=Math.max(a.I,b.I)}function Eb(a,b){return a.w-b.w}function Fb(a,b){return a.A-b.A}function Cb(a){return(a.H-a.w)*(a.I-a.A)}function Ib(a){return a.H-a.w+(a.I-a.A)}function Jb(a,b){return b.w<=a.H&&b.A<=a.I&&b.H>=a.w&&b.I>=a.A}
function xb(a){return{children:a,height:1,R:!0,w:Infinity,A:Infinity,H:-Infinity,I:-Infinity}}function zb(a,b,c,d,e){for(var g=[b,c],k;g.length;)c=g.pop(),b=g.pop(),c-b<=d||(k=b+Math.ceil((c-b)/d/2)*d,sb(a,k,b,c,e),g.push(b,k,k,c))};function Kb(a,b){if(256>a)return new Uint8Array(b);if(65536>a)return new Uint16Array(b);if(a<1<<32)return new Uint32Array(b);throw"Max value of "+a+" too large for typed arrays.";}function Lb(a,b){if(a.fill)a.fill.call(a,b);else for(var c=0;c<a.length;c++)a[c]=b}function Mb(a,b){if(a.reduce)return a.reduce.call(a,b,0);for(var c=0,d=0;d<a.length;d++)c=b(c,a[d],d,a);return c};function Nb(){var a=[.5,0,1,.5,2,1,6,1,8,0];this.a=function(b){for(var c=0;c<a.length&&a[c]<b;)c+=2;if(0===c)return a[1];if(c>=a.length)return a[a.length-1];var d=a[c-1],e=a[c-2];return d+(b-e)/(a[c]-e)*(a[c+1]-d)}};function Ob(a,b){function c(a,b,c){var e=d(c[a]);for(a+=1;a<b;a++)e+=d(" "),e+=d(c[a]);return e}function d(a){var c=b["#"+a];if(!c)throw"Unknown width of '"+a+"'";return c}var e=new Nb;this.a=function(b,d){function g(d){for(var f=d.length,g=0,h=0,l=0,k=0;k<f;k++){var m=c(l,d[k],b);h+=m;l=d[k];m>g&&(g=m)}d=e.a(g/((f-1)*a*1.05+a));return 0===d?0:d*(1-(f*g-h)/(f*g))}if(1===b.length)d(b,[1]);else{if(6<b.length)throw"Algorithm not suitable for labels with more than 6 words";for(var k=1<<b.length-1,f=[b.length],
p=g(f),h=1;h<k;h++){for(var n=h,q=1,r=[],t=0;t<b.length-1;t++)0!==(n&1)&&r.push(q),n>>=1,q++;r.push(q);n=g(r);p<n&&(p=n,f=r)}d(b,f)}};this.b=function(b,e,l){for(var g=e.length,f=(1.05-1)*a,k=-(1.05*a*g-f)/2,h=0,n=0;n<g;n++){for(var q=e[n],r=-(c(h,q,b)/2);h<q;h++){var t=d(b[h]);l(r,k,r+t,k+a,b[h]);r+=t;r+=d(" ")}h=q;k+=a+f}}};function Pb(){function a(){c.font=l+" "+k+" "+g+" "+e+"px "+d}var b=document.createElement("canvas");b.width=0;b.height=0;var c=b.getContext("2d"),d="sans-serif",e=16,g="normal",k="normal",l="normal";this.a=function(a){return Math.ceil(c.measureText(a).width)};this.b=function(b){d=b;a()};this.g=function(b){e=b;a()};this.P=function(b){g=b;a()};this.u=function(b){k=b;a()};this.j=function(b){l=b;a()}};function Qb(a){var b=a.filter(function(a){return 0<=a[0]}).sort(function(a,b){return a[1]-b[1]}),c=Kb(b.length+1,a.length);for(a=0;a<b.length;a++)c[b[a][2]]=a+1;this.ob=function(a){a=c[a];if(0!==a)return b[a-1]};this.nc=function(){return b}}
function Rb(a,b,c,d,e){b=b.map(function(a,b){return[-1,-1,b]});e=Math.floor(e/a);var g=new Int16Array(e);Lb(g,d);for(var k=0,l=0,m=0;k<b.length;){for(var f=b[k],p=c[k]+4,h=void 0,n=0;n<=m;n++)if(g[n]>=p){h=n;break}void 0===h&&m+1<e&&(m++,g[m]>=p&&(h=m));void 0!==h&&(f[0]=d-g[h],f[1]=h*a,g[h]-=p+4,l++);k++}a=Mb(g,function(a,b){return a+b});self.console.debug("Label canvas usage:",(100*(1-a/(e*d))).toFixed(2)+"%");return new Qb(b)};var Sb=new function(){this.a=[0,0,0,255];this.b=[242,217,166,127]};function Tb(a){function b(){function a(a,c){var d=h[a].za;if(!m[d]){a=c.search(h[a]);c=b[d].labelPriority;if(0>=c)for(var e=0;e<a.length;e++){var f=a[e].za;if(f!==d&&b[f].labelPriority>c){m[d]=1;return}}for(c=0;c<a.length;c++)e=a[c].za,e!==d&&(m[e]=1)}}for(var b=g.M(),c=M,d=R.D/Ea,e=f,h=[],l=0;l<F.length;l++)h.push({w:0,H:0,A:0,I:0,za:F[l][3]});l=new Float32Array(b.length);Lb(l,Infinity);for(var k=b.length,m=new Uint8Array(b.length),n=1,p=Math.pow(2,.25);4096>=n&&0<k;){for(var q=d/n,r=.5*f*(1+(.25-
.2*Math.min(1,Math.log(n)*Math.LOG2E/4))),t=0;t<F.length;t++){var z=F[t],w=b[z[3]],u=h[t],B=c[z[2]];u.w=(z[0]-r)*q+w.x;u.A=(z[1]-r)*q+w.y;u.H=(z[0]+r+B)*q+w.x;u.I=(z[1]+r+e)*q+w.y}q=new vb;q.load(h);Lb(m,0);for(r=0;r<h.length;r++)Infinity!==l[h[r].za]&&a(r,q);for(r=0;r<h.length;r++)Infinity===l[h[r].za]&&a(r,q);for(q=0;q<m.length;q++)0===m[q]&&Infinity===l[q]&&(l[q]=n,k--);n*=p}return l}function c(){var a=g.M(),b=0,c=[],d=a.reduce(function(a,d){d=K(d.label.split(/\s+/));for(var e=d.next();!e.done;e=
d.next())e=e.value,a.has(e)||(c.push(e),a.set(e,b++));return a},new Map),e=c.map(function(a){return m.a(a)}),l=e.reduce(function(a,b,d){a["#"+c[d]]=b;return a},{"# ":m.a(" ")}),k=Rb(f,c,e,h,4*h),n=new Ob(f,l),p=[];a.forEach(function(a,b){n.a(a.label.split(/\s+/),function(a,c){a.reduce(function(a,b){return a&&void 0!==k.ob(d.get(b))},!0)&&n.b(a,c,function(a,c,e,f,g){p.push([a,c,d.get(g),b])})})});return{od:c,nd:e,Qc:p,md:k}}function d(a,b){return function(c){a(c);b(c)}}function e(a){return function(b){a(b);
k.set(Ra);k.set(W)}}var g=this;Y.call(this,a);var k=new La;this.xa=function(){return E};this.Z=function(){return"label"};var l=new Map;l.set("xy",W);l.set("labelOpacity",Ta);l.set("labelColor",Sa);l.set("labelBoxColor",Ua);l.set("labelBoxOpacity",Va);l.set("labelVisibilityScales",W);this.g=function(){return l};this.Oa=function(a){switch(a){case "xy":case "labelVisibilityScales":k.set(W)}};var m=new Pb,f=16;this.ia=function(){return f};var p=e(d(function(a){f=a;h=Math.floor(2048/f)*f},m.g)),h;p(f);
var n="sans-serif";this.Eb=function(){return n};var q=e(d(function(a){return n=a},m.b)),r="normal";this.Hb=function(){return r};var t=e(d(function(a){return r=a},m.P)),u="normal";this.Gb=function(){return u};var y=e(d(function(a){return u=a},m.u)),v="normal";this.Fb=function(){return v};var z=e(d(function(a){return v=a},m.j)),w=Sb.a;this.Db=function(){return w};var x=1;this.Ib=function(){return x};var B=Sb.b;this.yb=function(){return B};var H=0;this.zb=function(){return H};var J=[0,0,0,0];this.Lb=
function(){return J};var U=0;this.Mb=function(){return U};var C={labelVisible:!1},E=ka(this,a,{options:this.Y({labelFontSize:{get:this.ia,set:p},labelFontFamily:{get:this.Eb,set:q},labelFontWeight:{get:this.Hb,set:t},labelFontVariant:{get:this.Gb,set:y},labelFontStyle:{get:this.Fb,set:z},labelColor:{get:this.Db,set:function(a){g.a(Sa);return w=a}},labelOpacity:{get:this.Ib,set:function(a){g.a(Ta);return x=a}},labelBoxColor:{get:this.yb,set:function(a){g.a(Ua);return B=a}},labelBoxOpacity:{get:this.zb,
set:function(a){g.a(Va);return H=a}},labelShadowColor:{get:this.Lb,set:function(a){return J=a}},labelShadowSize:{get:this.Mb,set:function(a){return U=a}}}),getters:this.u({}),events:this.j({}),methods:this.P({state:function(a){var b=za.Na();a=V.has(a)?X[V.get(a)]<=b:!1;C.labelVisible=a;return C}})}),F,G,I,M,R,X,V,Ea;this.Nc=function(){return G};this.ka=function(){return F};this.ec=function(){return I};this.Mc=function(){return M};this.Lc=function(){return X};this.sa=function(){return f};this.ra=function(){return h};
this.la=function(){return h};this.J=function(a,b){return Ea=b};this.oa=function(a){return R=a};this.Ya=function(){return R.D/Ea};var $b=this.b;this.b=function(a){$b.call(g,a.slice(0).sort(function(a,b){return(b.labelPriority||0)-(a.labelPriority||0)}));V=g.M().reduce(function(a,b,c){a.set(b,c);return a},new Map)};var za;this.Aa=function(a){za=a;a.da(g);a.Ra(g);g.J(a.N(),a.U());g.oa(a.Ha())};this.qb=function(){za.ic(g);za.cd(g)};this.update=function(){k.a(S)&&(k.set(Ra),k.set(W));if(k.a(Ra)){var a=
c();G=a.od;F=a.Qc;M=a.nd;I=a.md;g.a(Ra)}k.a(W)&&(X=b(),g.a(W))}}Tb.prototype=Object.create(Y.prototype);function Ub(a){function b(b,c,e,g,h,n,q,r){q=void 0===q?1:q;r=void 0===r?1:r;d.disable(d.BLEND);a.Qa(h,n,function(){for(var d={ja:0};d.ja<q;d={ja:d.ja},d.ja++)g.capture(function(d){return function(){a.ea();b.use(function(){b.f("aVertexPosition",k);b.i("uInput",0===d.ja?c:e,0);b.o("uResolution",h,n);b.o("direction",r*(q-d.ja),0);b.C(["aVertexPosition"]);b.W(k.h())})}}(d)),e.capture(function(c){return function(){a.ea();b.use(function(){b.f("aVertexPosition",k);b.i("uInput",g,0);b.o("uResolution",h,
n);b.o("direction",0,r*(q-c.ja));b.C(["aVertexPosition"]);b.W(k.h())})}}(d))})}function c(b){return a.createProgram({name:"blur",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",G:"\n      precision mediump float;\n\n      uniform vec2 uResolution;\n      uniform sampler2D uInput;\n      uniform vec2 direction;\n\n      "+b+"      \n      \n      void main() {\n        vec2 uv = vec2(gl_FragCoord.xy / uResolution.xy);\n        gl_FragColor = blur(uInput, uv, uResolution.xy, direction);\n      }\n    ",
B:["aVertexPosition"],F:["uInput","uResolution","direction"]})}var d=a.V,e=c("\n    vec4 blur(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n      vec4 color = vec4(0.0);\n      vec2 off1 = vec2(1.3333333333333333) * direction;\n      color += texture2D(image, uv) * 0.29411764705882354;\n      color += texture2D(image, uv + (off1 / resolution)) * 0.35294117647058826;\n      color += texture2D(image, uv - (off1 / resolution)) * 0.35294117647058826;\n      return color; \n    }"),g=c("\n    vec4 blur(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n      vec4 color = vec4(0.0);\n      vec2 off1 = vec2(1.411764705882353) * direction;\n      vec2 off2 = vec2(3.2941176470588234) * direction;\n      vec2 off3 = vec2(5.176470588235294) * direction;\n      color += texture2D(image, uv) * 0.1964825501511404;\n      color += texture2D(image, uv + (off1 / resolution)) * 0.2969069646728344;\n      color += texture2D(image, uv - (off1 / resolution)) * 0.2969069646728344;\n      color += texture2D(image, uv + (off2 / resolution)) * 0.09447039785044732;\n      color += texture2D(image, uv - (off2 / resolution)) * 0.09447039785044732;\n      color += texture2D(image, uv + (off3 / resolution)) * 0.010381362401148057;\n      color += texture2D(image, uv - (off3 / resolution)) * 0.010381362401148057;\n      return color; \n    }"),
k=a.$();this.b=function(a,c,d,g,h,k){b(e,a,c,d,g,h,1,void 0===k?1:k)};this.a=function(a,c,d,e,h,k){b(g,a,c,d,e,h,1,void 0===k?1:k)}};function Vb(a){var b=a.createProgram({name:"fullscreen",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",G:"\n      precision mediump float;\n\n      uniform float uStrength;\n      uniform vec2 uResolution;\n      uniform vec2 uBlurredSize;\n      uniform sampler2D uInput;\n      uniform sampler2D uBlurred;\n      \n      \n  vec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w) * (1.0/6.0);\n  }\n  \n  vec4 textureBicubic(sampler2D sampler, vec2 texSize, vec2 texCoords) {\n    vec2 invTexSize = 1.0 / texSize;\n     \n    texCoords = texCoords * texSize - 0.5;\n     \n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2(-0.5, +1.5).xyxy;\n    \n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4(xcubic.yw, ycubic.yw) / s;\n    \n    offset *= invTexSize.xxyy;\n    \n    vec4 sample0 = texture2D(sampler, offset.xz);\n    vec4 sample1 = texture2D(sampler, offset.yz);\n    vec4 sample2 = texture2D(sampler, offset.xw);\n    vec4 sample3 = texture2D(sampler, offset.yw);\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(mix(sample3, sample2, sx), mix(sample1, sample0, sx) , sy);\n  }\n\n\n      void main() {\n        vec2 uv = vec2(gl_FragCoord.xy / uResolution.xy);\n        vec4 b = textureBicubic(uBlurred, uBlurredSize, uv);\n        vec4 i = texture2D(uInput, uv);\n        \n        gl_FragColor = mix(vec4(1.0 - b.rgb, b.a), vec4(1.0 - i.rgb, i.a), \n          1.0 + uStrength * i.a / (0.01 + i.r + i.g + i.b));\n      }\n    ",
B:["aVertexPosition"],F:"uInput uBlurred uStrength uResolution uBlurredSize direction".split(" ")}),c=a.$();this.J=function(){};this.fa=function(a,e,g){b.use(function(){b.f("aVertexPosition",c);b.i("uInput",a,0);b.i("uBlurred",e,1);b.o("uBlurredSize",e.eb(),e.ya());b.o("uResolution",a.eb(),a.ya());b.c("uStrength",g);b.C(["aVertexPosition"]);b.W(c.h())})}};function Wb(a,b){var c=a.V;b.da(this);var d=a.createProgram({name:"labelBoxes",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n      attribute vec3 aLabelPointData;\n      attribute vec3 aLabelBoxPositionData;\n      attribute float aLabelOpacity;\n      attribute vec4 aLabelBoxColor;\n      attribute float aLabelBoxOpacity;\n  \n      varying vec2 unitBoxCoord;\n      varying float boxWidth;\n      varying float visibilityScale;\n      varying float labelOpacity;\n      varying vec4 labelBoxColor;\n      varying float labelBoxOpacity;\n  \n      uniform mat3 uMvMatrix;\n      uniform float uScale;\n      uniform float uBoxScale;\n      uniform float uFontSize;\n      uniform float uBoxPadding;\n      \n      // The comment is to make IntelliJ parser happy\n      //\n    vec4 getGlPosition(vec2 unitBoxWithPadding, vec3 aLabelBoxPositionData, float uFontSize, mat3 uMvMatrix) {\n      // Scale to match the actual aspect ratio of the word    \n      vec2 boxAtOrigin = unitBoxWithPadding * vec2(aLabelBoxPositionData.z, uFontSize);\n      \n      // Position the word within the label and position in the point space\n      vec2 scaled = (boxAtOrigin + aLabelBoxPositionData.xy) * uBoxScale / uScale + aLabelPointData.xy;      \n      \n      // Transform through view matrix\n      vec3 transformed = uMvMatrix * vec3(scaled, 1.0);\n    \n      // We add the extra uScale for the label fade/in out animation \n      return vec4(\n        transformed.xy, \n        (\n          // scale-based visibility\n          2.0 * (step(uScale + uScale - aLabelPointData.z, 0.0)) +\n          \n          // per-label visibility, hide if label opacity == 0   \n          2.0 * step(aLabelOpacity, 0.0) +\n          \n          // Sort by visibility scale for the depth buffer fallback\n          smoothstep(-1.0, 1.0, log2(aLabelPointData.z) - log2(uScale * 2.0))                     \n        ),    \n        1.0\n      );\n    }\n  \n  \n      void main(void) {\n        // Transform the (0.0, 1.0) square to the origin-relative word box. We'll also apply some padding to the box.\n        // We want the padding to be equal along x and y, and because the only way to apply padding is to scale\n        // the box around origin, to keep the x/y paddings equal, we'll need separate scales on x and y axes. \n        // We also apply two corrective factors to: 1) render descenders partially on the padding (looks better) --\n        // this is done by shifting the scaling center slightly above the origin (the 0.67 instead of 0.5), \n        // 2) making the vertical padding smaller, the 0.7 factor.\n        vec2 unitBoxWithPadding = \n          (aVertexPosition - vec2(0.5, 0.67)) // make the square origin-relative\n            * vec2(1.0 + uBoxPadding * uFontSize / aLabelBoxPositionData.z, 1.0 + uBoxPadding * 0.7) // scale to add padding \n            + vec2(0.5, 0.67); // transform the box back to start at (0, 0) \n            \n        gl_Position = getGlPosition(unitBoxWithPadding, aLabelBoxPositionData, uFontSize, uMvMatrix);\n        \n        \n        unitBoxCoord = aVertexPosition;\n        boxWidth = aLabelBoxPositionData.z;\n        visibilityScale = aLabelPointData.z;\n        labelOpacity = aLabelOpacity;\n        labelBoxOpacity = aLabelBoxOpacity;\n        labelBoxColor = aLabelBoxColor;\n      }\n    ",
G:"\n      precision mediump float;\n      uniform float uScale;\n      uniform float uLabelOpacity;\n      uniform float uFontSize;\n      \n      varying float visibilityScale;\n      varying vec2 unitBoxCoord;\n      varying float boxWidth;\n      varying float labelOpacity;\n      varying vec4 labelBoxColor;\n      varying float labelBoxOpacity;\n      \n      float udRoundBox(vec2 p, vec2 b, float r) {\n        return length(max(abs(p) - b + r, 0.0)) - r;\n      }\n      \n      void main(void) {\n        float alpha = smoothstep(-1.0, 0.0, 4.0 * (log2(uScale) - log2(visibilityScale)));\n      \n        // Distance field based rounded box\n        vec2 boxInScreenCoordinates = vec2(boxWidth, uFontSize);\n        float b = smoothstep(0.0, 1.0, udRoundBox(boxInScreenCoordinates * (unitBoxCoord * 2.0 - 1.0), 1.0 * boxInScreenCoordinates, 7.0));\n        \n        gl_FragColor = vec4(\n          1.0 - labelBoxColor.rgb,\n          labelBoxOpacity * labelOpacity * labelBoxColor.a * (1.0 - b)\n        ) * alpha;\n      }\n    ",
B:"aVertexPosition aLabelPointData aLabelBoxPositionData aLabelOpacity aLabelBoxColor aLabelBoxOpacity".split(" "),F:["uMvMatrix","uScale","uBoxScale","uFontSize","uBoxPadding"]}),e=a.createProgram({name:"labels",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n      attribute vec3 aLabelPointData;\n      attribute vec3 aLabelBoxSpriteData;\n      attribute vec3 aLabelBoxPositionData;\n      attribute float aLabelOpacity;\n      attribute vec4 aLabelColor;\n  \n      varying vec3 labelBox;\n      varying vec2 boxCoord;\n      varying float visibilityScale;\n      varying vec4 labelColor;\n      varying float labelOpacity;\n  \n      uniform mat3 uMvMatrix;\n      uniform float uScale;\n      uniform float uBoxScale;\n      uniform float uFontSize;\n  \n      // The comment is to make IntelliJ parser happy\n      //\n    vec4 getGlPosition(vec2 unitBoxWithPadding, vec3 aLabelBoxPositionData, float uFontSize, mat3 uMvMatrix) {\n      // Scale to match the actual aspect ratio of the word    \n      vec2 boxAtOrigin = unitBoxWithPadding * vec2(aLabelBoxPositionData.z, uFontSize);\n      \n      // Position the word within the label and position in the point space\n      vec2 scaled = (boxAtOrigin + aLabelBoxPositionData.xy) * uBoxScale / uScale + aLabelPointData.xy;      \n      \n      // Transform through view matrix\n      vec3 transformed = uMvMatrix * vec3(scaled, 1.0);\n    \n      // We add the extra uScale for the label fade/in out animation \n      return vec4(\n        transformed.xy, \n        (\n          // scale-based visibility\n          2.0 * (step(uScale + uScale - aLabelPointData.z, 0.0)) +\n          \n          // per-label visibility, hide if label opacity == 0   \n          2.0 * step(aLabelOpacity, 0.0) +\n          \n          // Sort by visibility scale for the depth buffer fallback\n          smoothstep(-1.0, 1.0, log2(aLabelPointData.z) - log2(uScale * 2.0))                     \n        ),    \n        1.0\n      );\n    }\n  \n\n      void main(void) {\n        // Scale to match the actual aspect ratio of the word    \n        vec2 boxAtOrigin = aVertexPosition * vec2(aLabelBoxPositionData.z, uFontSize);\n        \n        gl_Position = getGlPosition(aVertexPosition, aLabelBoxPositionData, uFontSize, uMvMatrix);\n\n        labelBox = aLabelBoxSpriteData;\n        boxCoord = boxAtOrigin;\n        visibilityScale = aLabelPointData.z;\n        labelColor = aLabelColor;\n        labelOpacity = aLabelOpacity;\n      }\n    ",
G:"\n      precision mediump float;\n      uniform sampler2D uLabelSprites;\n      uniform float uScale;\n      uniform vec2 uTextureResolution;\n      \n      varying vec2 boxCoord;\n      varying vec3 labelBox;\n      varying float visibilityScale;\n      varying vec4 labelColor;\n      varying float labelOpacity;\n      \n      void main(void) {\n        vec4 pixel = texture2D(uLabelSprites, (2.0 * (labelBox.xy + boxCoord.xy) + 1.0) / (2.0 * uTextureResolution));\n        \n        // To avoid branching and thread divergence, we build a mask vector where the channel's corresponding\n        // value is 1.0 only if chanel number is 1.0, 2.0, 3.0 or 4.0, respectively.\n        float channel = floor(labelBox.z + 1.0);\n        vec4 mask = vec4(\n          step(1.0, channel) * step(-1.0, -channel),        \n          step(2.0, channel) * step(-2.0, -channel),        \n          step(3.0, channel) * step(-3.0, -channel),       \n          step(4.0, channel) * step(-4.0, -channel)       \n        );\n        \n        // Select the right channel.\n        float p = dot(pixel, mask);\n        \n        gl_FragColor = vec4(\n          labelColor.rgb,\n          \n          // Fade in/out labels set to show at just a little above the current zoome scale\n          labelOpacity * p * labelColor.a * smoothstep(-1.0, 0.0, 4.0 * (log2(uScale) - log2(visibilityScale)))\n        );\n      }\n    ",
B:"aVertexPosition aLabelPointData aLabelBoxSpriteData aLabelBoxPositionData aLabelOpacity aLabelColor".split(" "),F:"uMvMatrix uScale uLabelSprites uBoxScale uTextureResolution uFontSize".split(" ")}),g=a.createProgram({name:"drop-shadow",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",G:"\n      precision mediump float;\n      uniform sampler2D uMaskTexture;\n      uniform vec2 uViewport;\n      uniform vec4 uLabelShadowColor;\n      uniform float uLabelShadowSize;\n\n      void main(void) {\n        // Label mask\n        float mm = texture2D(uMaskTexture, gl_FragCoord.xy / uViewport).a;\n        float mask = min(1.0, mm * 8.0);\n\n        gl_FragColor = vec4(uLabelShadowColor.rgb, uLabelShadowColor.a * min(1.0, mm * uLabelShadowSize));\n      }\n    ",
B:["aVertexPosition"],F:["uMaskTexture","uViewport","uLabelShadowColor","uLabelShadowSize"]}),k=a.$(),l=c.getExtension("EXT_blend_minmax"),m=!!l,f=new Vb(a),p=new Ub(a),h=new eb(a);this.release=function(){k.release()};this.J=function(a,c){f.J(a*b.s(),c*b.s())};this.b=function(d,f,g){var h=d.X();h.update();d.ca();var l=d.Kb(),k=d.Pb(),m=d.T().xb(),n=d.T().ab();if(0===l.h())return k.capture(function(){a.ea()}),k;var q=d.Cb(),r=d.Ab(),B=d.Jb(),H=d.Bb(),J=d.Nb();m.capture(function(){a.ea();e.use(function(){e.c("uFontSize",
d.sa());e.o("uTextureResolution",d.ra(),d.la());e.c("uBoxScale",h.Ya()/b.s());e.f("aVertexPosition",q,c.BYTE);e.f("aLabelPointData",l,c.FLOAT,!1,0,0,!0);e.f("aLabelBoxSpriteData",H,c.SHORT,!1,0,0,!0);e.f("aLabelBoxPositionData",r,c.FLOAT,!1,0,0,!0);e.f("aLabelOpacity",B,c.UNSIGNED_BYTE,!0,0,0,!0);e.i("uLabelSprites",J,0);e.c("uScale",g);e.pa(f);e.C(["aVertexPosition","aLabelPointData","aLabelBoxSpriteData","aLabelBoxPositionData","aLabelOpacity"]);e.Ea(l.h(),q.h())})});var U=b.ha(),C=b.ga();k.capture(function(){c.clearColor(0,
0,0,0);c.clear(c.COLOR_BUFFER_BIT);m.fa(U,C)});p.b(k,k,n,U,C,Math.min(1,b.s()/2));return k};this.a=function(n,p,r){var q=n.X();q.update();n.ca();var u=n.Kb();if(0!==u.h()){var y=n.Cb(),v=n.Ab(),z=n.Jb(),w=n.xc(),x=n.yc(),B=n.Bb(),H=n.zc(),J=n.T().xb(),U=n.Nb(),C=n.Pb();C&&g.use(function(){g.i("uMaskTexture",C,0);g.o("uViewport",b.na(),b.ma());g.kb("uLabelShadowColor",q.Lb());g.c("uLabelShadowSize",q.Mb());g.f("aVertexPosition",k);g.C(["aVertexPosition"]);g.W(k.h())});if(n.Oc()){J.capture(function(){a.ea();
d.use(function(){d.c("uFontSize",n.sa());d.c("uBoxPadding",.5);d.c("uBoxScale",q.Ya()/b.s());d.f("aVertexPosition",y,c.BYTE);d.f("aLabelPointData",u,c.FLOAT,!1,0,0,!0);d.f("aLabelBoxPositionData",v,c.FLOAT,!1,0,0,!0);d.f("aLabelOpacity",z,c.UNSIGNED_BYTE,!0,0,0,!0);d.f("aLabelBoxColor",w,c.UNSIGNED_BYTE,!0,0,0,!0);d.f("aLabelBoxOpacity",x,c.UNSIGNED_BYTE,!0,0,0,!0);d.c("uScale",r);d.pa(p);d.C("aVertexPosition aLabelPointData aLabelBoxPositionData aLabelOpacity aLabelBoxColor aLabelBoxOpacity".split(" "));
m?(c.enable(c.BLEND),c.blendFuncSeparate(c.ONE,c.ONE,c.ONE,c.ONE),c.blendEquation(l.MAX_EXT)):(c.enable(c.DEPTH_TEST),c.disable(c.BLEND));d.Ea(u.h(),y.h())})});var E=n.T().ab();h.resize(J,b.na(),b.ma(),E,b.ha(),b.ga());m||c.disable(c.DEPTH_TEST);c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);f.fa(J,E,6)}e.use(function(){e.c("uFontSize",n.sa());e.o("uTextureResolution",n.ra(),n.la());e.c("uBoxScale",q.Ya()/b.s());e.f("aVertexPosition",
y,c.BYTE);e.f("aLabelPointData",u,c.FLOAT,!1,0,0,!0);e.f("aLabelBoxSpriteData",B,c.SHORT,!1,0,0,!0);e.f("aLabelBoxPositionData",v,c.FLOAT,!1,0,0,!0);e.f("aLabelColor",H,c.UNSIGNED_BYTE,!0,0,0,!0);e.f("aLabelOpacity",z,c.UNSIGNED_BYTE,!0,0,0,!0);e.i("uLabelSprites",U,0);e.c("uScale",r);e.pa(p);e.C("aVertexPosition aLabelPointData aLabelBoxSpriteData aLabelBoxPositionData aLabelOpacity aLabelColor".split(" "));c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,
c.ONE,c.ONE_MINUS_SRC_ALPHA);e.Ea(u.h(),y.h())})}}}
function Xb(a,b,c){function d(a,b,c,d,e){for(var f=0,g=new Uint8ClampedArray(4*b.length),h=0;h<b.length;h++){var k=a[b[h][3]][d]||e;g[f++]=k[0];g[f++]=k[1];g[f++]=k[2];g[f++]=k[3]}c.setData(g,4,a.length)}function e(a,b,c,d,e){for(var f=new Uint8ClampedArray(b.length),g=!1,h=0;h<b.length;h++){var k=a[b[h][3]][d];k=255*(void 0!==k?k:e);f[h]=k;0<k&&(g=!0)}c.setData(f,1,b.length);return g}function g(){for(var a=c.M(),b=c.ka(),d=c.Lc(),e=new Float32Array(3*b.length),f=0,g=0;g<b.length;g++){var k=b[g],
l=a[k[3]];e[f++]=l.x;e[f++]=l.y;e[f++]=Math.min(1E6,d[k[3]])}h.setData(e,3,b.length)}function k(a){return void 0!==a?Math.ceil(a*x.s()):a}var l=this,m=a.V,f=new La;f.set(S);c.wa(function(a){f.set(a)});var p=a.createBuffer(),h=a.createBuffer(),n=a.createBuffer(),q=a.createBuffer(),r=a.createBuffer(),t=a.createBuffer(),u=a.createBuffer(),y=a.createBuffer(),v,z,w;this.X=function(){return c};this.T=function(){return b};this.Cb=function(){return p};this.Kb=function(){return h};this.Bb=function(){return n};
this.Ab=function(){return q};this.zc=function(){return r};this.Jb=function(){return t};this.xc=function(){return u};this.yc=function(){return y};this.Oc=function(){return v};this.Nb=function(){return z};this.Pb=function(){return w};this.sa=function(){return k(c.sa())};this.ra=function(){return k(c.ra())};this.la=function(){return k(c.la())};this.ca=function(){if(f.a(S)){g();var b=new Int8Array(8),h=0;b[h++]=0;b[h++]=0;b[h++]=1;b[h++]=0;b[h++]=1;b[h++]=1;b[h++]=0;b[h]=1;p.setData(b,2,4);f.set(Ra);
f.set(W);f.set(Sa);f.set(Ta);f.set(Ua);f.set(Va)}f.a(W)&&g();if(f.a(Ra)){b=c.ka();h=c.ec();for(var w=new Int16Array(3*b.length),x=l.la(),C=0,E=0;E<b.length;E++){var F=h.ob(b[E][2]);w[C++]=k(F[0]);w[C++]=k(F[1])%x;w[C++]=Math.floor(k(F[1])/x)}n.setData(w,3,b.length);b=c.Nc();w=c.ec();h=new ArrayBuffer(l.ra()*l.la()*4);h=new Uint8Array(h);Lb(h,0);w=w.nc();for(x=0;x<w.length&&0>w[x][1];)x++;C=l.sa();E=l.ra();F=l.la();var G=document.createElement("canvas");G.width=E;G.height=C;G=G.getContext("2d");G.font=
c.Fb()+" "+c.Gb()+" "+c.Hb()+" "+C+"px "+c.Eb();G.fillStyle="rgba(0, 0, 0, 1.0)";G.textBaseline="bottom";if(x<w.length)for(var I=w[x],M=k(I[1]),R=0;;){if(void 0===I||k(I[1])!==M){M=Math.floor(M/F);var X=new Uint8Array(G.getImageData(0,0,E,C).data.buffer);G.clearRect(0,0,E,C);for(var V=3;V<X.length;V+=4)h[M+R]=X[V],R+=4;R>=E*F*4&&(R=0);if(void 0!==I)M=k(I[1]);else break}for(;x<w.length&&k(I[1])===M;)G.fillText(b[I[2]],k(I[0])+1,C),x++,I=w[x]}z&&z.release();z=a.createTexture(h,E,F,m.NEAREST,m.RGBA,
m.UNSIGNED_BYTE);b=c.ka();h=c.Mc();w=new Float32Array(3*b.length);for(C=x=0;C<b.length;C++)E=b[C],F=k(h[E[2]]),w[x++]=k(E[0]),w[x++]=k(E[1]),w[x++]=F;q.setData(w,3,b.length)}f.a(Sa)&&d(c.M(),c.ka(),r,"labelColor",c.Db());f.a(Ta)&&e(c.M(),c.ka(),t,"labelOpacity",c.Ib());f.a(Ua)&&d(c.M(),c.ka(),u,"labelBoxColor",c.yb());f.a(Va)&&(v=e(c.M(),c.ka(),y,"labelBoxOpacity",c.zb()))};var x;this.Aa=function(a){x=a;x.da(l);l.J(x.N(),x.U())};this.release=function(){x.ic(l);p.release();h.release();n.release();
q.release();r.release();t.release();u.release();y.release();z.release();w.release()};this.J=function(){var b=w,c=x.ha(),d=x.ga();b?(b.resize(c,d),w=b):w=a.createTexture(null,c,d,m.LINEAR,m.RGBA,m.UNSIGNED_BYTE)}};function Yb(a){var b=this;Y.call(this,a);this.xa=function(){return h};this.Z=function(){return"marker"};var c=new Map;c.set("markerColor",Ma);c.set("markerOpacity",Oa);c.set("markerSize",Na);c.set("markerShape",Pa);this.g=function(){return c};var d=.35;this.Rb=function(){return d};var e=1;this.Tb=function(){return e};var g=.25;this.Ub=function(){return g};var k=10;this.ia=function(){return k};var l=1;this.Xb=function(){return l};var m=Sb.a;this.Qb=function(){return m};var f="circle";this.Sb=function(){return f};
var p=this.Ma;this.Ma=function(a){return p.call(b,a)*b.ia()};var h=ka(this,a,{options:this.Y({markerFillOpacity:{get:this.Rb,set:function(a){return d=a}},markerStrokeOpacity:{get:this.Tb,set:function(a){return e=a}},markerStrokeWidth:{get:this.Ub,set:function(a){return g=a}},markerSizeMultiplier:{get:this.ia,set:function(a){return k=a}},minAbsoluteMarkerSize:{get:this.Xb,set:function(a){return l=a}},markerColor:{get:this.Qb,set:function(a){b.a(Ma);return m=a}},markerShape:{get:this.Sb,set:function(a){b.a(Pa);
return f=a}}}),getters:this.u({}),events:this.j({}),methods:this.P({})})}Yb.prototype=Object.create(Y.prototype);function Zb(a,b){var c=a.V,d=a.createProgram({name:"dots",K:"\n      attribute vec3 aMarkerPosition;\n      attribute vec4 aMarkerColor;\n      attribute float aMarkerOpacity;\n      attribute float aMarkerType;\n  \n      varying vec4 vMarkerColor;\n      varying float vMarkerOpacity;\n      varying float vMarkerType;\n      varying float vMarkerSize;\n  \n      uniform mat3 uMvMatrix;\n      uniform float uPointScale;\n      uniform float uMinAbsolutePointSize;\n  \n      void main(void) {\n        gl_Position = vec4(\n          (uMvMatrix * vec3(aMarkerPosition.xy, 1.0)) + \n          vec3(0.0, 0.0, 2.0 * step(aMarkerOpacity, 0.0)), // z-filtering for opacity==0 markers\n          1.0);\n          \n        // The +2.0 factor is an extra 2-pixel margin for antialiasing.\n        gl_PointSize = max(uPointScale * aMarkerPosition.z, uMinAbsolutePointSize);\n        vMarkerColor = aMarkerColor;\n        vMarkerOpacity = aMarkerOpacity;\n        vMarkerType = floor(aMarkerType);\n        vMarkerSize = gl_PointSize;\n      }\n    ",
G:"\n      #extension GL_OES_standard_derivatives : enable\n      precision mediump float;\n      uniform float uMarkerOpacity;\n      uniform float uFillOpacity;\n      uniform float uStrokeOpacity;\n      uniform float uStrokeWidth;\n      uniform sampler2D uMaskTexture;\n      uniform vec2 uViewport;\n\n      varying vec4 vMarkerColor;\n      varying float vMarkerOpacity;\n      varying float vMarkerType;\n      varying float vMarkerSize;\n\n      void main(void) {\n        const float      PI = 3.14159265359;\n        const float  TWO_PI = 6.28318530718;\n\n        // Position of the fragment, in the -1.0...1.0 range.\n        vec2 pos = 2.0 * gl_PointCoord - 1.0;\n      \n        // We draw the shapes and strokes using the signed distance field technique.\n        // Variable d represents the distance to the _boundary_ of the shape.\n        // Pixels where d is close to 0 lie on the stroke of the shape.\n        // Pixels where 0.0 < d < 1.0 are inside the shape. \n        // The only tricky bit is to compute d for the specific shape. \n        float d = 0.0;\n        \n        // Accept thread divergence for now. If we see performance problems, \n        // we can can always convert the code to remove conditions.\n        if (vMarkerType == 2.0) {\n          // Square\n          vec2 t = 1.0 - abs(pos);\n          d = min(t.x, t.y);\n        } else if (vMarkerType == 1.0) {\n          // Triangle\n          float angle = atan(pos.x, pos.y) + PI;\n          float r = TWO_PI / 3.0; // the constant is the number of vertices\n          d = 1.02 - sqrt(cos(floor(0.5 + angle / r) * r - angle) * r * length(pos));\n        } else {\n          // Circle\n          d = 1.0 - sqrt(dot(pos, pos));\n        }\n      \n        // Now fill and stroke the shape. Apply some anti-aliasing too.\n        // Add some margin for anti-aliasing.\n        float margin = 2.0 / vMarkerSize;\n        float delta = fwidth(d) * 0.75;\n        \n        float alpha = max(\n                        uStrokeOpacity * \n                          (1.0 - smoothstep(uStrokeWidth - delta, uStrokeWidth + delta, d)) * \n                          smoothstep(margin - delta, margin + delta, d),\n                        uFillOpacity * step(uStrokeWidth - delta * 0.5, d)\n                      );\n        \n        // Apply mask and fill the pixels.\n        float mask = min(1.0, texture2D(uMaskTexture, gl_FragCoord.xy / uViewport).a * 8.0);\n        gl_FragColor = vec4(mix(vMarkerColor.rgb, vec3(1.0, 1.0, 1.0), 0.5 * mask), \n          vMarkerOpacity * vMarkerColor.a * alpha * uMarkerOpacity * (1.0 - 0.5 * mask));\n      }\n    ",
B:["aMarkerPosition","aMarkerColor","aMarkerType","aMarkerOpacity"],F:"uMvMatrix uPointScale uMarkerOpacity uFillOpacity uStrokeOpacity uStrokeWidth uMaskTexture uViewport uMinAbsolutePointSize".split(" ")});this.fa=function(a,g,k,l){a.ca();var e=a.X(),f=a.bb();0!==f.h()&&d.use(function(){d.f("aMarkerPosition",f);d.f("aMarkerColor",a.Bc(),c.UNSIGNED_BYTE,!0);d.f("aMarkerOpacity",a.Dc(),c.UNSIGNED_BYTE,!0);d.f("aMarkerType",a.Cc(),c.UNSIGNED_BYTE,!1);var k=b.s();d.pa(g);d.c("uPointScale",e.Ma(b));
d.c("uMinAbsolutePointSize",e.Xb()*k);d.c("uMarkerOpacity",e.La());d.c("uFillOpacity",e.Rb());d.c("uStrokeOpacity",e.Tb());d.c("uStrokeWidth",Math.min(1,Math.max(0,e.Ub())));l?d.i("uMaskTexture",l,0):d.i("uMaskTexture",a.T().Wa(),0);d.o("uViewport",b.N()*b.s(),b.U()*b.s());d.C(["aMarkerPosition","aMarkerColor","aMarkerType","aMarkerOpacity"]);c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);d.rb(f.h())})}}
function ac(a,b,c){function d(){for(var a=new Uint8ClampedArray(l.length),b=0;b<l.length;b++){var c=l[b].markerOpacity;a[b]=255*(void 0===c?1:c)}p.setData(a,1,l.length)}function e(){for(var a=new Uint8ClampedArray(4*l.length),b=0,d=c.Qb(),e=0;e<l.length;e++){var g=l[e].markerColor||d;a[b++]=g[0];a[b++]=g[1];a[b++]=g[2];a[b++]=g[3]}f.setData(a,4,l.length)}function g(){for(var a=new Uint8ClampedArray(l.length),b=c.Sb(),d=0;d<l.length;d++){var e=0;switch(l[d].markerShape||b){case "square":e|=2;break;
case "triangle":e|=1}a[d]=e}h.setData(a,1,l.length)}var k=new La;k.set(S);c.wa(function(a){k.set(a)});var l,m=a.createBuffer(),f=a.createBuffer(),p=a.createBuffer(),h=a.createBuffer();this.X=function(){return c};this.T=function(){return b};this.ca=function(){k.a(S)&&(l=c.M(),k.set(T),k.set(Ma),k.set(Oa),k.set(Na),k.set(Pa));if(k.b(T,Na)){for(var a=new Float32Array(3*l.length),b=0,f=K(l),h=f.next();!h.done;h=f.next())h=h.value,a[b++]=h.x,a[b++]=h.y,h=h.markerSize||0,a[b++]=Math.max(0,Math.min(1,h));
m.setData(a,3,l.length)}k.g(Ma,e);k.g(Oa,d);k.g(Pa,g)};this.bb=function(){return m};this.Bc=function(){return f};this.Dc=function(){return p};this.Cc=function(){return h};this.release=function(){m.release();f.release();p.release();h.release()}};function bc(a){Y.call(this,a);this.xa=function(){return k};this.Z=function(){return"outline"};var b=8;this.$b=function(){return b};var c=1;this.Zb=function(){return c};var d=[255,255,255,128];this.Yb=function(){return d};var e=[0,0,0,255];this.ac=function(){return e};var g=.5;this.bc=function(){return g};var k=ka(this,a,{options:this.Y({outlineRadiusOffset:{get:this.$b,set:function(a){return b=a}},outlineRadiusMultiplier:{get:this.Zb,set:function(a){return c=a}},outlineFillColor:{get:this.Yb,set:function(a){return d=
a}},outlineStrokeColor:{get:this.ac,set:function(a){return e=a}},outlineStrokeWidth:{get:this.bc,set:function(a){return g=a}}}),getters:this.u({}),events:this.j({}),methods:this.P({})})}bc.prototype=Object.create(Y.prototype);function cc(a,b){var c=a.V,d=a.createProgram({name:"dots",K:"\n      attribute vec3 aMarkerPosition;\n  \n      uniform mat3 uMvMatrix;\n      uniform float uPointScale;\n      uniform float uOutlineRadiusOffset;\n      uniform float uOutlineRadiusMultiplier;\n  \n      void main(void) {\n        gl_Position = vec4(\n          (uMvMatrix * vec3(aMarkerPosition.xy, 1.0)),\n          1.0);\n          \n        gl_PointSize = uPointScale * (aMarkerPosition.z * uOutlineRadiusMultiplier + uOutlineRadiusOffset);\n      }\n    ",
G:"\n      precision mediump float;\n      uniform vec2 uViewport;\n\n      void main(void) {\n        // Position of the fragment, in the -1.0...1.0 range.\n        vec2 pos = 2.0 * gl_PointCoord - 1.0;\n        \n        float v = 1.0 - step(1.0, sqrt(dot(pos, pos)));\n\n        gl_FragColor = vec4(v, v, v, v);\n      }\n    ",B:["aMarkerPosition"],F:["uMvMatrix","uPointScale","uOutlineRadiusMultiplier","uOutlineRadiusOffset"]}),e=a.createProgram({name:"outlineBorder",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n  \n      void main(void) {\n        gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n      }\n    ",
G:"\n      #extension GL_OES_standard_derivatives : enable\n      precision mediump float;\n\n      uniform vec2 uResolution;\n      uniform vec4 uFillColor;\n      uniform vec4 uStrokeColor;\n      uniform float uOutlineStrokeWidth;\n      uniform sampler2D uHeightmap;\n      uniform sampler2D uMaskTexture;\n\n      void main() {\n        vec2 uv = vec2(gl_FragCoord.xy / uResolution.xy);\n        float h = texture2D(uHeightmap, uv).a;\n        \n        // Height deltas along x and y.\n        float dhx = dFdx(h);\n        float dhy = dFdy(h);\n        \n        // Label mask, applies to contours only\n        float mask = min(1.0, texture2D(uMaskTexture, gl_FragCoord.xy / uResolution).a * 8.0);\n        \n        // Distance to the nearest band's boundary height.\n        float dsx = (h - uOutlineStrokeWidth) / sqrt(dhx * dhx + dhy * dhy);\n\n        float cs = max(smoothstep(-1.0, 1.0, dsx), mask);\n        float ss = smoothstep(0.0, 1.0 - uOutlineStrokeWidth, h);\n        gl_FragColor = vec4(mix(uStrokeColor, uFillColor, cs).rgb, ss * mix(uStrokeColor.a, uFillColor.a, cs));\n      }\n    ",
B:["aVertexPosition"],F:"uHeightmap uMaskTexture uResolution uFillColor uStrokeColor uOutlineStrokeWidth uHeightmapSize".split(" ")}),g=new Ub(a),k=a.$();this.fa=function(l,m,f,p){var h=l.X();l.ca();var n=l.bb();if(0!==n.h()){var q=b.s(),r=l.T().ab(),t=l.T().Ac();r.capture(function(){a.ea();d.use(function(){d.f("aMarkerPosition",n);d.pa(m);d.c("uPointScale",q*Math.min(Math.sqrt(f),4)/2);d.c("uOutlineRadiusMultiplier",h.Zb());d.c("uOutlineRadiusOffset",h.$b());d.C(["aMarkerPosition"]);c.enable(c.BLEND);
c.blendEquation(c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);d.rb(n.h())})});g.a(r,r,t,b.ha(),b.ga(),Math.min(1,q/2));c.enable(c.BLEND);e.use(function(){e.f("aVertexPosition",k);e.i("uHeightmap",r,0);p?e.i("uMaskTexture",p,1):e.i("uMaskTexture",l.T().Wa(),1);e.o("uResolution",b.na(),b.ma());e.kb("uFillColor",h.Yb());e.kb("uStrokeColor",h.ac());e.c("uOutlineStrokeWidth",h.bc());e.C(["aVertexPosition"]);e.W(k.h())})}}}
function dc(a,b,c){var d=new La;d.set(S);c.wa(function(a){d.set(a)});var e,g=a.createBuffer();this.X=function(){return c};this.T=function(){return b};this.ca=function(){d.a(S)&&(e=c.M(),d.set(T),d.set(Na));if(d.b(T,Na)){for(var a=new Float32Array(3*e.length),b=0,m=K(e),f=m.next();!f.done;f=m.next())f=f.value,a[b++]=f.x,a[b++]=f.y,f=f.markerSize||0,a[b++]=Math.max(0,Math.min(1,f));g.setData(a,3,e.length)}};this.bb=function(){return g};this.release=function(){g.release()}};var ec=new function(){var a=this;this.g=function(b){return b[ja]||a.b(b)};this.b=function(a){var b=a.type;switch(b){case "marker":return new Yb(a);case "outline":return new bc(a);case "elevation":return new qb(a);case "label":return new Tb(a);case void 0:throw"Each layer must define 'type'.";default:throw"Unknown layer type '"+b+"'";}};this.a=function(a,c,d){switch(a.Z()){case "marker":return new ac(c,d,a);case "outline":return new dc(c,d,a);case "elevation":return new gb(c,d,a);case "label":return new Xb(c,
d,a)}}};function fc(a,b){var c=a.V;b.Ta(this);b.da(this);var d=a.createProgram({name:"dots",K:"\n      precision mediump float;\n      attribute vec2 aVertexPosition;\n\n      uniform mat3 uMvMatrix;\n      \n      varying vec2 position;\n  \n      void main(void) {\n        gl_Position = vec4(uMvMatrix * vec3(aVertexPosition.xy, 1.0), 1.0);\n        position = (aVertexPosition.xy + 1.0) / 2.0;\n      }\n    ",G:"\n      precision mediump float;\n      uniform sampler2D uLogo;\n      uniform vec2 uResolution;\n      uniform vec4 uLogoColor;\n      varying vec2 position;\n\n      void main(void) {\n        vec4 pixel = texture2D(uLogo, position);\n        gl_FragColor = vec4(uLogoColor.rgb / 255.0, uLogoColor.a / 255.0 * pixel.a);\n      }\n    ",
B:["aVertexPosition"],F:["uMvMatrix","uLogo","uResolution","uLogoColor"]}),e,g,k=a.$(),l=[29,53,87,255],m=[255,255,255,255];this.J=function(){g=O().scale(1,-1).translate((b.N()-140-20)/b.N(),(b.U()-22.5-20)/b.U()).scale(1/b.N(),1/b.U()).scale(140,22.5)};this.J();this.Ba=function(){e&&e.release();var d=b.s(),g=document.createElement("canvas");g.width=280*d;g.height=45*d;var h=g.getContext("2d");h.scale(.5*d,.5*d);h.save();h.transform(1,0,0,1,-90.6,-68.4);h.fillStyle="rgba(29, 53, 87, 0.75)";h.beginPath();
h.moveTo(260.8,68.6);h.lineTo(260.8,158.3);h.lineTo(244,158.3);h.lineTo(244,153.5);h.bezierCurveTo(239.6,156.7,235.2,158.3,230.9,158.3);h.bezierCurveTo(221.7,158.3,214.4,155.3,209,149.3);h.bezierCurveTo(203.6,143.3,200.9,136.4,200.9,128.4);h.bezierCurveTo(200.9,120.4,203.6,113.4,209,107.4);h.bezierCurveTo(214.4,101.4,221.7,98.4,230.9,98.4);h.bezierCurveTo(236.9,98.8,241.2,100.4,244,103.3);h.lineTo(244,68.5);h.moveTo(244,133.8);h.lineTo(244,124.1);h.bezierCurveTo(243.2,117.4,239.1,113.4,231.5,112.3);
h.bezierCurveTo(221.9,113,216.5,118,215.3,127.2);h.bezierCurveTo(215.7,138.3,221.1,144.1,231.5,144.5);h.bezierCurveTo(239.1,143.3,243.2,139.7,244,133.8);h.fill();h.beginPath();h.moveTo(298.7,158.9);h.bezierCurveTo(290,158.9,282.7,156,276.9,150.1);h.bezierCurveTo(271,144.3,268.1,137,268.1,128.4);h.bezierCurveTo(268.1,119.7,271,112.4,276.9,106.6);h.bezierCurveTo(282.7,100.7,290,97.8,298.7,97.8);h.bezierCurveTo(307.4,97.8,314.6,100.7,320.4,106.6);h.bezierCurveTo(326.3,112.4,329.2,119.7,329.2,128.4);
h.bezierCurveTo(329.2,137.1,326.3,144.3,320.4,150.2);h.bezierCurveTo(314.6,156,307.4,158.9,298.7,158.9);h.moveTo(298.6,144.4);h.bezierCurveTo(303.1,144.4,306.8,142.9,309.7,139.8);h.bezierCurveTo(312.5,136.8,313.9,133,313.9,128.4);h.bezierCurveTo(313.9,123.9,312.5,120.1,309.7,117);h.bezierCurveTo(306.8,113.9,303.1,112.4,298.5,112.4);h.bezierCurveTo(294,112.4,290.4,113.9,287.5,117);h.bezierCurveTo(284.7,120.1,283.3,123.9,283.3,128.4);h.bezierCurveTo(283.3,133,284.7,136.8,287.5,139.8);h.bezierCurveTo(290.4,
142.9,294,144.4,298.6,144.4);h.fill();h.beginPath();h.moveTo(373.5,155.5);h.bezierCurveTo(370.6,157.4,367.3,158.3,363.6,158.3);h.bezierCurveTo(356.8,158.3,351.5,156.4,347.5,152.6);h.bezierCurveTo(343.5,148.8,341.5,143.9,341.5,137.9);h.lineTo(341.5,112);h.lineTo(332.5,112);h.lineTo(332.5,98.5);h.lineTo(341.5,98.5);h.lineTo(341.5,82.3);h.lineTo(358.3,80.5);h.lineTo(358.3,98.5);h.lineTo(367.3,98.5);h.lineTo(367.3,112);h.lineTo(358.3,112);h.lineTo(358.3,135.6);h.bezierCurveTo(358.3,138.7,359,141,360.3,
142.3);h.bezierCurveTo(361.6,143.6,363.4,144.2,365.5,144.2);h.bezierCurveTo(366.1,144.2,367.6,144,370,143.5);h.fill();h.beginPath();h.moveTo(376.4,158.3);h.lineTo(412.3,68.5);h.lineTo(430.3,68.5);h.lineTo(466.1,158.2);h.lineTo(447,158.3);h.lineTo(441.6,144.5);h.lineTo(400.9,144.5);h.lineTo(395.5,158.3);h.moveTo(421.8,92.4);h.lineTo(408.1,126.6);h.lineTo(435.1,126.6);h.fill();h.beginPath();h.moveTo(503.1,155.5);h.bezierCurveTo(500.2,157.4,496.9,158.3,493.2,158.3);h.bezierCurveTo(486.4,158.3,481.1,
156.4,477.1,152.6);h.bezierCurveTo(473.1,148.8,471.1,143.9,471.1,137.9);h.lineTo(471.1,112);h.lineTo(462.1,112);h.lineTo(462.1,98.5);h.lineTo(471.1,98.5);h.lineTo(471.1,82.3);h.lineTo(487.9,80.5);h.lineTo(487.9,98.5);h.lineTo(496.9,98.5);h.lineTo(496.9,112);h.lineTo(487.9,112);h.lineTo(487.9,135.6);h.bezierCurveTo(487.9,138.7,488.6,141,489.9,142.3);h.bezierCurveTo(491.2,143.6,493,144.2,495.1,144.2);h.bezierCurveTo(495.7,144.2,497.2,144,499.6,143.5);h.fill();h.beginPath();h.moveTo(513.3,158.3);h.lineTo(513.3,
68.5);h.lineTo(530.1,68.5);h.lineTo(530.1,158.3);h.fill();h.beginPath();h.moveTo(544.7,105.6);h.bezierCurveTo(552.3,100.8,561.1,98.4,571.1,98.4);h.bezierCurveTo(578.3,98.4,583.9,100.4,588.1,104.4);h.bezierCurveTo(592.3,108.4,594.4,114.4,594.4,122.4);h.lineTo(594.4,158.3);h.lineTo(577.7,158.3);h.lineTo(577.7,153.5);h.bezierCurveTo(572.8,156.7,568.4,158.3,564.5,158.3);h.bezierCurveTo(556.5,158.3,550.5,156.6,546.5,153.2);h.bezierCurveTo(542.5,149.8,540.5,145.1,540.5,139.1);h.bezierCurveTo(540.5,133.6,
542.4,128.6,546.2,124.2);h.bezierCurveTo(550,119.8,556.1,117.6,564.5,117.6);h.bezierCurveTo(568.4,117.6,572.8,118.8,577.7,121.2);h.lineTo(577.7,119.4);h.bezierCurveTo(577.6,115,574.4,112.6,568.1,112.2);h.bezierCurveTo(560.9,112.2,555.3,113.4,551.3,115.8);h.moveTo(577.7,140.3);h.lineTo(577.7,133.6);h.bezierCurveTo(576.1,130.5,572.3,129,566.3,129);h.bezierCurveTo(559.1,129.8,555.3,132.6,554.9,137.3);h.bezierCurveTo(555.3,142.1,559.1,144.7,566.3,145.1);h.bezierCurveTo(572.3,145.1,576.1,143.5,577.7,140.3);
h.fill();h.beginPath();h.moveTo(626.2,98.1);h.bezierCurveTo(631.8,98.1,636.2,98.8,639.3,100.1);h.bezierCurveTo(642.4,101.5,645.3,103.5,648,106.2);h.lineTo(638.7,116.7);h.bezierCurveTo(636,113.5,632.6,111.8,628.5,111.8);h.bezierCurveTo(624.5,111.8,621.8,112.6,620.4,114.1);h.bezierCurveTo(619.1,115.6,619.1,116.9,620.4,118.2);h.bezierCurveTo(621.8,119.4,624.5,120.4,628.5,121.2);h.bezierCurveTo(634.5,121.7,639.3,123.4,643.1,126.3);h.bezierCurveTo(646.9,129.1,648.8,134,648.8,141.1);h.bezierCurveTo(648.8,
146.7,646.6,151.1,642.1,154.2);h.bezierCurveTo(637.6,157.3,632.4,158.9,626.5,158.9);h.bezierCurveTo(620.8,158.9,616.1,158.1,612.3,156.5);h.bezierCurveTo(608.5,154.9,605.3,152.7,602.6,150);h.lineTo(611.9,139.5);h.bezierCurveTo(614.6,142.7,618.8,144.6,624.5,145.1);h.bezierCurveTo(629.1,145.1,632,144.4,633.4,142.9);h.bezierCurveTo(634.7,141.4,634.9,139.9,634,138.4);h.bezierCurveTo(633,136.9,629.9,135.9,624.5,135.4);h.bezierCurveTo(619.6,134.8,615.2,133.3,611.1,130.9);h.bezierCurveTo(607.1,128.4,605,
123.9,605,117.1);h.bezierCurveTo(605,110.9,607.3,106.2,611.9,103);h.bezierCurveTo(616.6,99.7,621.3,98.1,626.2,98.1);h.fill();h.restore();d=[.2,.5,1,1,.2,.2,1,1,.5];for(var k=0,l=0;3>l;l++)for(var m=0;3>m;m++)h.globalAlpha=d[k++],h.beginPath(),h.fillStyle="rgb(29, 53, 87)",h.arc(14+31*m,14+31*l,14,0,2*Math.PI),h.fill();e=a.Va(g,g.width,g.height,c.LINEAR)};this.Ba();this.fa=function(a){d.use(function(){d.f("aVertexPosition",k);d.C(["aVertexPosition"]);var f=b.s();d.o("uResolution",560*f,90*f);d.pa(g.elements());
d.i("uLogo",e,0);d.kd(a?l:m);c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);d.W(k.h())})}};function gc(a,b){function c(b,c){return a.createTexture(null,b,c,e.LINEAR,e.RGBA,e.UNSIGNED_BYTE)}function d(){k.resize(b.na(),b.ma());l.resize(b.ha(),b.ga());m.resize(b.ha(),b.ga())}var e=a.V,g=a.createTexture(null,1,1,e.LINEAR);this.J=function(){d()};this.Ba=function(){d()};this.xb=function(){return k};this.ab=function(){return l};this.Ac=function(){return m};this.Wa=function(){return g};b.da(this);b.Ta(this);var k=c(b.na(),b.ma());var l=c(b.ha(),b.ga());var m=c(b.ha(),b.ga())};function hc(a,b){function c(){m=new rb(b.N(),b.U(),b.s(),H);p.g(m);h.a(m)}function d(a,c){var d=x&&0<x.La()&&!!B,e=!!w&&z.gb();if(d){var f=x.Ka();void 0===f&&(f=p.P(B),x.fd(f));p.a(B)}g.viewport(0,0,b.na(),b.ma());g.enable(g.BLEND);g.blendEquation(g.FUNC_ADD);g.blendFuncSeparate(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA);g.clearColor(1,1,1,1);g.clear(g.COLOR_BUFFER_BIT);var k=e?r.b(w,a,c):void 0;d&&h.b(B,p.j(),f,c,k);v.forEach(function(b){if(b.X().gb()){var d=b instanceof ac?n:
b instanceof dc?q:void 0;d.fa(b,a,c,k)}});e&&r.a(w,a,c);x?(f=K(x.Ia()[0].color),d=f.next().value,e=f.next().value,f=f.next().value,d=(1+x.$a())*((d<<1)+d+(e<<2)+f)>>3):d=255;t.fa(80<d)}function e(a,c,d,e){var f=m.margin(),g=1+a*f/(m.width()+H*f);a=1+a*f/(m.height()+H*f);return O().translate(-(g-1),-(a-1)).scale(1,-1).translate(g-1,a-1).scale(2/b.N(),2/b.U()).translate(c/g,d/a).scale(b.N()/2,b.U()/2).translate(-1,-1).scale(e,e).translate(1,1).translate(-1,-1).scale(2/(u.v*g),2/(u.D*a)).translate(-u.x,
-u.y)}var g=a.V;g.disable(g.DEPTH_TEST);b.da(this);b.Ra(this);b.mb(this);var k=void 0,l=1,m,f=new gc(a,b),p=new fb(a,b),h=new hb(a,b),n=new Zb(a,b),q=new cc(a,b),r=new Wb(a,b),t=new fc(a,b),u,y=[],v=[],z,w,x,B;this.fb=function(){c()};this.J=function(){c()};this.b=function(c){function d(b,c){c&&c.release();return b?ec.a(b,a,f):void 0}y=c;x=y.find(function(a){return a instanceof qb});z=y.find(function(a){return a instanceof Tb});v.forEach(function(a){return a.release()});B=d(x,B);(w=d(z,w))&&w.Aa(b);
B&&(B.Aa(b),x.ed(function(a,b){return p.u(a,b,B)}));v=y.filter(function(a){return"outline"===a.Z()||"marker"===a.Z()}).map(function(b){return ec.a(b,a,f)})};this.oa=function(a){u=a;p.Y(e(1,0,0,1))};this.setTransform=function(a,b,c){l=c;k=e(0,a,b,c);p.ia(e(1,a,b,c));d(k.elements(),l)};this.a=function(){d(k.elements(),l)};this.getImageData=function(b){this.a();return a.canvas.toDataURL(xa(b&&b.format,"image/png"),xa(b&&b.quality,.8))};var H=2};var Ga=["OES_texture_float","OES_standard_derivatives","OES_texture_float_linear"];
function ic(a){function b(){var b=a.Ha(),c=a.N(),d=a.U(),e=a.Jc(),h=a.Kc(),n=a.Na(),q=O().translate(b.x,b.y).scale(b.v,b.D).scale(1/c,1/d);b=O().scale(c,d).scale(1/b.v,1/b.D).translate(-b.x,-b.y);g=O().multiply(q).scale(1/n,1/n).translate(-e,-h);k=O().translate(e,h).scale(n,n).multiply(b)}function c(){var a=e;e=!1;return a}function d(){return e=!0}var e=!0,g,k;a.da(this);a.Ra(this);a.Ta(this);a.mb(this);this.setTransform=this.J=this.Ba=this.oa=d;this.jc=function(a,d){c()&&b();return g.transform(a,
d)};this.a=function(a,d){c()&&b();return k.transform(a,d)}}
function jc(a){function b(){var a=g.clientWidth,b=g.clientHeight;if(0===a||0===b)throw"The provided element must have non-zero dimensions.";g.width=a*e.Pa;g.height=b*e.Pa;return{lc:a,kc:b}}function c(a){function b(b){if(1<a.filter(function(a){return a.type===b}).length)throw"Only one '"+b+"' type layer is allowed.";}b("label");b("elevation");(function(){for(var b=1;b<a.length;b++)if("elevation"===a[b].type)throw"The 'elevation' type layer must be at index 0.";})()}function d(a){a=a.reduce(function(a,
b){return a.lb(b.M())},Ca()).pb();return void 0===a?new Ba(0,0,1,1):0===a.v?a.gc(.5):a.Rc()}var e=Object.assign({},{element:null,Pa:window.devicePixelRatio||1,initialTransform:{translateX:0,translateY:0,scale:1}},a),g=function(){var a=e.element;if(!a)throw"Provide a HTML element in which to embed dotAtlas.";var b=document.createElement("div"),c=document.createElement("canvas");b.setAttribute("style","width: 100%; height: 100%; position: relative;");c.setAttribute("style","width: 100%; height: 100%; position: absolute; cursor: default");
b.appendChild(c);a.appendChild(b);a.dataset.dotatlas="embedded";return c}();a=b();var k=a.lc,l=a.kc,m=new Fa(g),f=new Ha(k,l,e.Pa);a=new ic(f);var p=new hc(m,f);m=new ra(e.element);m=new Ia(m,a);var h=new $a(m,f),n=new sa,q=new Aa({gd:f,aa:{l:e.initialTransform.translateX,m:e.initialTransform.translateY,scale:e.initialTransform.scale}},n);new ta(q,m,n);this.a=m;this.g=a;var r=!1,t,u,y=[],v=[];p.fb();this.P=function(){return y};this.b=function(a){a=a||[];c(a);v.filter(function(a){return"label"===a.Z()}).forEach(function(a){a.qb()});
v=a.map(function(a){return ec.g(a)});v.forEach(function(a){return a.fb()});t=d(v);u=t.fc(k/l);f.oa(u);v.filter(function(a){return"label"===a.Z()}).forEach(function(a){a.Aa(f);a.update()});h.ib();h.Sa(v);y=v.map(function(a){return a.xa()});p.b(v);r=!0;window.requestAnimationFrame(function(){r=!1;f.setTransform(0,0,1)})};this.b(y);this.j=function(){r||(r=!0,window.requestAnimationFrame(function(){r=!1;p.a()}))};this.reset=function(a){q.reset(a)};this.u=function(a,b,c,d){var e=u;q.b(k/2-c*(a-e.x)*k/
e.v,l/2-c*(b-e.y)*l/e.D,c,d)};this.setTransform=function(a,b,c){f.setTransform(a,b,c)};this.resize=function(){var a=b(),c=a.lc;a=a.kc;if(0!==c-k||0!==a-l){var d=u,e=t.fc(c/a);u=e;f.oa(e);f.J(c,a);q.resize(c,a,k,l,e,d);k=c;l=a}};this.Y=function(){return q.a().scale};this.getImageData=function(a){return p.getImageData(a)};this.setTransform=function(a,b,c){p.setTransform(a,b,c)}};function Z(a){var b=new jc({element:a.element,Pa:a.pixelRatio||1});la(this,b,a,{options:{layers:{get:b.P,set:b.b},transform:{get:b.setTransform,set:b.setTransform}},getters:{zoom:{get:b.Y},imageData:{get:b.getImageData}},methods:{redraw:b.j,resize:b.resize,pointToScreenSpace:b.g.a,screenToPointSpace:b.g.jc,centerPoint:b.u,setTransform:b.setTransform,reset:b.reset},events:{onClick:b.a.a,onHover:b.a.g,onMouseWheel:b.a.j,onDoubleClick:b.a.b}})}
function kc(){var a=this,b=[];this["with"]=function(a){Array.isArray(a)?a.forEach(function(a){return b.push(a)}):b.push(a);return this};this.embed=function(c){var d={element:c.element,pixelRatio:c.pixelRatio};d=Z.embed(0<b.length?d:c);for(var e=0;e<b.length;e++){var g=e<b.length-1?{}:c,k=b[e].create(d,g);k?d=k:d=oa({},d,a,g,{})}return d}}
Z.supported=function(){try{var a=document.createElement("canvas");if(!a)return console.error("dotAtlas requires HTML5 canvas support."),!1;var b=a.getContext("webgl")||a.getContext("experimental-webgl");if(!b)return console.error("dotAtlas requires WebGL support."),!1}catch(c){return!1}return!!b&&Ga.reduce(function(a,d){var c=!!b.getExtension(d);c||console.error("dotAtlas requires the "+d+" WebGL extension support.");return a&&c},!0)};Z.createLayer=function(a){return ec.b(a).xa()};
Z.injectApiProxy=oa;Z["with"]=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];return(new kc)["with"](b)};Z.embed=function(a){return new Z(a)};window.DotAtlas=Z;
}).call(this)
